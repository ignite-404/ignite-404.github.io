"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[181],{74590:function(ee,R,e){var T=e(15009),n=e.n(T),g=e(99289),s=e.n(g),A=e(5574),y=e.n(A),S=e(83062),E=e(14726),U=e(67294),h=e(85893);R.Z=function(f){var j=f.action,Z=f.confirmText,b=f.hide,B=(0,U.useState)(!1),x=y()(B,2),D=x[0],L=x[1],M=Z||"\u786E\u5B9A\u5220\u9664\uFF1F",p=function(){var F=s()(n()().mark(function $(){return n()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(confirm(M)){c.next=2;break}return c.abrupt("return");case 2:return L(!0),c.prev=3,c.next=6,j();case 6:return c.prev=6,L(!1),c.finish(6);case 9:case"end":return c.stop()}},$,null,[[3,,6,9]])}));return function(){return F.apply(this,arguments)}}();return b?null:(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(S.Z,{title:M,children:(0,h.jsx)(E.ZP,{loading:D,danger:!0,type:"link",onClick:function(){p()},children:"\u5220\u9664"})})})}},96256:function(ee,R,e){var T=e(97857),n=e.n(T),g=e(19632),s=e.n(g),A=e(5574),y=e.n(A),S=e(85980),E=e(34041),U=e(57381),h=e(67294),f=e(85893);R.Z=function(j){var Z=j.onSearch,b=j.value,B=j.onChange,x=j.style,D=j.initItem,L=j.placeholder,M=j.props,p=(0,h.useState)(!1),F=y()(p,2),$=F[0],v=F[1],c=(0,h.useState)([]),Y=y()(c,2),u=Y[0],o=Y[1],m=(0,S.Z)(function(t){v(!0),Z(t).then(function(I){o(I||[])}).finally(function(){return v(!1)})},{wait:500});(0,h.useEffect)(function(){},[]);var a=function(){var I=s()(u);return D&&!I.find(function(ne){return ne.value===D.value})&&I.push(D),I};return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(E.Z,n()({style:n()({minWidth:300},x),loading:$,value:b,showSearch:!0,allowClear:!0,filterOption:!1,onSearch:function(I){m.run(I)},onChange:function(I){var ne=u.find(function(ue){return ue.value==I});B&&B(ne)},onClear:function(){B&&B(void 0)},placeholder:L||"\u8F93\u5165\u5173\u952E\u8BCD",notFoundContent:$&&(0,f.jsx)(U.Z,{size:"small"}),options:a()},M))})}},23806:function(ee,R,e){var T=e(1288),n=e(85893);R.Z=function(g){var s=g.model,A=g.fallback;if(s==null||s==null)return null;var y=s==null?void 0:s.CreationTime,S=s==null?void 0:s.LastModificationTime;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{style:{},children:[(0,n.jsx)("div",{children:(0,n.jsx)(T.Z,{prefix:(0,n.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:y,fallback:A})}),(0,n.jsx)("div",{children:(0,n.jsx)(T.Z,{prefix:(0,n.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:S,fallback:A})})]})})}},1288:function(ee,R,e){var T=e(78957),n=e(83062),g=e(46629),s=e(85893);R.Z=function(A){var y,S=A.timeStr,E=A.fallback,U=A.onlyDate,h=A.prefix,f=(y=(0,g.mg)(S))===null||y===void 0?void 0:y.add(g.Mg,"hour");if(!f)return E||null;var j=(0,g.ND)().utc().add(g.Mg,"hour"),Z=f.isSame(j,"year"),b=f.diff(j,"day"),B=Z?f.format(g.AK):f.format(g.vc),x=function(){return(0,s.jsxs)("div",{children:[(0,s.jsxs)(T.Z,{direction:"horizontal",children:[(0,s.jsx)("div",{children:f.fromNow()}),(0,s.jsx)("div",{children:f.format(g.On)})]}),(0,s.jsx)("div",{children:f.format(g.t9)})]})};return(0,s.jsx)(n.Z,{title:x(),children:(0,s.jsxs)(T.Z,{direction:"horizontal",children:[h,(0,s.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:U?f.format(g.vc):f.format(g.dq)})]})})}},48746:function(ee,R,e){var T=e(15009),n=e.n(T),g=e(99289),s=e.n(g),A=e(96256),y=e(35291),S=e(30699),E=e(66419),U=e(85893);R.Z=function(h){var f=h.selectedSku,j=h.onChange,Z=h.style,b=h.props,B=function(){var x=s()(n()().mark(function D(L){var M,p,F;return n()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(0,E.Wq)(L)){v.next=2;break}return v.abrupt("return",[]);case 2:return v.next=4,S.x1.mallAdmin.skuQuerySkuForSelection({Keywords:L,Take:20});case 4:return p=v.sent,F=p==null||(M=p.data)===null||M===void 0||(M=M.Data)===null||M===void 0?void 0:M.map(function(c){return{label:(0,y.CQ)(c)||"--",value:c.Id||"--"}}),v.abrupt("return",F||[]);case 7:case"end":return v.stop()}},D)}));return function(L){return x.apply(this,arguments)}}();return(0,U.jsx)(U.Fragment,{children:(0,U.jsx)(A.Z,{style:Z,props:b,onSearch:function(){var x=s()(n()().mark(function D(L){return n()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,B(L);case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},D)}));return function(D){return x.apply(this,arguments)}}(),placeholder:"\u641C\u7D22\u5546\u54C1...",value:(f==null?void 0:f.Id)||void 0,initItem:f==null?void 0:{label:(0,y.CQ)(f)||"",value:f.Id||""},onChange:function(D){j&&j(D==null?void 0:{Id:D.value,Name:D.label})}})})}},19189:function(ee,R,e){e.r(R),e.d(R,{default:function(){return me}});var T=e(97857),n=e.n(T),g=e(5574),s=e.n(g),A=e(66309),y=e(40411),S=e(14726),E=e(4393),U=e(80799),h=e(67294),f=e(23806),j=e(1288),Z=e(30699),b=e(66419),B=e(15009),x=e.n(B),D=e(99289),L=e.n(D),M=e(45360),p=e(85576),F=e(78957),$=e(57381),v=e(11346),c=e(25278),Y=e(24435),u=e(72269),o=e(84567),m=e(96864),a=e(74590),t=e(19632),I=e.n(t),ne=e(35291),ue=e(66628),ie=e(48746),r=e(85893),de=function(w){var K=w.sku_list,G=w.onChange,H=w.maxCount,q=(0,h.useState)(!1),J=s()(q,2),z=J[0],Q=J[1],re=H||1e5,V=K.length>=re,X=[{title:"No",dataIndex:"index",valueType:"indexBorder"},{title:"\u6392\u5E8F",dataIndex:"sort",width:60,className:"drag-visible"},{title:"\u5546\u54C1",render:function(N,O){return(0,ne.CQ)(O)||"--"}},{title:"\u63CF\u8FF0",render:function(N,O){return O.Description||"--"}},{render:function(N,O){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(S.ZP,{type:"link",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&G(I()(K.filter(function(C){return C.Id!=O.Id})))},children:"\u5220\u9664"})})}}];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{title:"\u641C\u7D22\u5546\u54C1",open:z,onCancel:function(){return Q(!1)},onOk:function(){return Q(!1)},children:(0,r.jsx)(ie.Z,{onChange:function(N){if(N){if(V){var O;(O=b.iI.message)===null||O===void 0||O.error("\u6570\u91CF\u5DF2\u8FBE\u4E0A\u9650\uFF1A".concat(re));return}if(confirm("\u6DFB\u52A0".concat((0,ne.CQ)(N)||"--","\uFF1F"))){if(K.some(function(C){return C.Id==N.Id})){var i;(i=b.iI.message)===null||i===void 0||i.error("\u8BE5\u5546\u54C1\u5DF2\u5B58\u5728");return}G([].concat(I()(K),[N])),Q(!1)}}}})}),(0,r.jsx)(E.Z,{size:"small",title:"\u9009\u62E9\u5546\u54C1",extra:(0,r.jsx)(S.ZP,{disabled:V,type:"link",size:"small",onClick:function(){Q(!0)},children:"\u6DFB\u52A0\u5546\u54C1"}),children:(0,r.jsx)(ue.Z,{rowKey:"Id",columns:X,dataSource:K||[],toolBarRender:!1,pagination:!1,headerTitle:!1,search:!1,dragSortKey:"sort",onDragSortEnd:function(N,O,i){G(I()(i))}})})]})},_e=e(38295),k=e(46629),ce=function(w){var K,G,H,q=w.show,J=w.hide,z=w.data,Q=w.ok,re=(0,h.useState)(!1),V=s()(re,2),X=V[0],W=V[1],N=(0,h.useState)({}),O=s()(N,2),i=O[0],C=O[1],te=(0,_e.o)(),se=function(l){W(!0),Z.x1.mallAdmin.discountSave(n()({},l)).then(function(_){_.data.Error?M.ZP.error(_.data.Error.Message):(M.ZP.success("\u4FDD\u5B58\u6210\u529F"),Q())}).finally(function(){W(!1)})};return(0,h.useEffect)(function(){C(n()({},z||{}))},[z]),(0,h.useEffect)(function(){q&&te.queryStores()},[q]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(p.Z,{width:"60%",title:"\u6298\u6263",open:q,onCancel:function(){return J()},footer:(0,r.jsxs)(F.Z,{children:[(0,r.jsx)(a.Z,{action:L()(x()().mark(function d(){var l;return x()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,Z.x1.mallAdmin.discountDelete({Id:z.Id});case 2:l=P.sent,(0,b._y)(l,function(){J(),Q()});case 4:case"end":return P.stop()}},d)})),hide:(0,b.Wq)(z.Id)}),(0,r.jsx)(S.ZP,{type:"primary",onClick:function(){se(i)},children:"\u4FDD\u5B58"})]}),children:(0,r.jsx)($.Z,{spinning:X,children:(0,r.jsxs)(v.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,r.jsx)(v.Z.Item,{label:"\u540D\u79F0",tooltip:"61\u513F\u7AE5\u8282",children:(0,r.jsx)(c.Z,{maxLength:30,required:!0,value:i.Name||"",onChange:function(l){C(n()(n()({},i),{},{Name:l.target.value}))}})}),(0,r.jsx)(v.Z.Item,{label:"\u63CF\u8FF0",children:(0,r.jsx)(c.Z.TextArea,{maxLength:30,required:!0,value:i.Description||"",onChange:function(l){C(n()(n()({},i),{},{Description:l.target.value}))}})}),(0,r.jsx)(v.Z.Item,{label:"\u6298\u6263",children:(0,r.jsx)(Y.Z,{min:0,max:1,required:!0,value:i.DiscountPercentage||0,onChange:function(l){C(n()(n()({},i),{},{DiscountPercentage:l||0}))}})}),(0,r.jsx)(v.Z.Item,{label:"\u6307\u5B9A\u95E8\u5E97\u53EF\u7528",children:(0,r.jsxs)(F.Z,{direction:"horizontal",children:[(0,r.jsx)(u.Z,{checked:i.LimitedToStore,onChange:function(l){C(n()(n()({},i),{},{LimitedToStore:l}))}}),i.LimitedToStore||(0,r.jsx)("b",{children:"\u5F53\u524D\u6240\u6709\u95E8\u5E97\u53EF\u7528"})]})}),i.LimitedToStore&&(0,r.jsx)(v.Z.Item,{label:"\u9002\u7528\u95E8\u5E97",children:(0,r.jsx)(o.Z.Group,{onChange:function(l){C(n()(n()({},i),{},{Stores:te.stores.filter(function(_){return l.indexOf(_.Id||"")>=0})}))},value:((K=i.Stores)===null||K===void 0?void 0:K.map(function(d){return d.Id||""}))||[],options:te.stores.map(function(d){return{label:d.Name,value:d.Id||""}})})}),(0,r.jsx)(v.Z.Item,{label:"\u7279\u5B9A\u5546\u54C1",children:(0,r.jsx)(u.Z,{checked:i.LimitedToSku,onChange:function(l){C(n()(n()({},i),{},{LimitedToSku:l}))}})}),i.LimitedToSku&&(0,r.jsx)(v.Z.Item,{label:"\u53C2\u4E0E\u5546\u54C1",children:(0,r.jsx)(de,{sku_list:i.Skus||[],onChange:function(l){C(n()(n()({},i),{},{Skus:l||[]}))}})}),(0,r.jsx)(v.Z.Item,{label:"\u65F6\u95F4\u8303\u56F4",children:(0,r.jsx)(m.default.RangePicker,{allowClear:!0,value:[((G=(0,k.mg)(i.StartTime))===null||G===void 0?void 0:G.add(k.Mg,"hour"))||null,((H=(0,k.mg)(i.EndTime))===null||H===void 0?void 0:H.add(k.Mg,"hour"))||null],onChange:function(l){var _,P;C(n()(n()({},i),{},{StartTime:l==null||(_=l.at(0))===null||_===void 0?void 0:_.add(-k.Mg,"hours").format(k.dq),EndTime:l==null||(P=l.at(1))===null||P===void 0?void 0:P.add(-k.Mg,"hours").format(k.dq)}))}})}),(0,r.jsx)(v.Z.Item,{label:"\u72B6\u6001\u53EF\u7528",children:(0,r.jsx)(u.Z,{checked:i.IsActive,onChange:function(l){C(n()(n()({},i),{},{IsActive:l}))}})}),(0,r.jsx)(v.Z.Item,{label:"\u6392\u5E8F",children:(0,r.jsx)(Y.Z,{value:i.Sort||0,onChange:function(l){C(n()(n()({},i),{},{Sort:l||0}))}})})]})})})})},me=function(){var w=(0,h.useState)(!0),K=s()(w,2),G=K[0],H=K[1],q=(0,h.useState)({Items:[],TotalCount:0}),J=s()(q,2),z=J[0],Q=J[1],re=(0,h.useState)({Page:1}),V=s()(re,2),X=V[0],W=V[1],N=(0,h.useState)(void 0),O=s()(N,2),i=O[0],C=O[1],te=function(){H(!0),Z.x1.mallAdmin.discountQueryPaging(n()({},X)).then(function(l){Q(l.data||{})}).finally(function(){H(!1)})},se=[{title:"\u540D\u79F0",render:function(l,_){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("b",{children:_.Name||"--"}),(0,b.Wq)(_.Description)||(0,r.jsx)("p",{children:_.Description})]})}},{title:"\u4F18\u60E0\u529B\u5EA6",render:function(l,_){return _.DiscountPercentage||0}},{title:"\u9002\u7528\u95E8\u5E97",render:function(l,_){var P;return _.LimitedToStore?(0,r.jsx)("span",{children:"".concat((P=_.Stores)===null||P===void 0?void 0:P.map(function(ae){return ae.Name||""}).join(","))}):(0,r.jsx)(A.Z,{color:"green",children:"\u5168\u90E8\u95E8\u5E97"})}},{title:"\u9002\u7528\u5546\u54C1",render:function(l,_){var P;return _.LimitedToSku?_.Skus?(P=_.Skus)===null||P===void 0?void 0:P.map(function(ae,oe){var le;return(0,r.jsx)("div",{style:{marginBottom:5},children:"".concat(oe+1,"-").concat((le=ae.Goods)===null||le===void 0?void 0:le.Name,"-").concat(ae.Name)},oe)}):null:(0,r.jsx)(A.Z,{color:"green",children:"\u5168\u5C40\u6709\u6548"})}},{title:"\u72B6\u6001",render:function(l,_){return _.IsActive?(0,r.jsx)(y.Z,{text:"\u53EF\u7528",status:"success"}):(0,r.jsx)(y.Z,{text:"\u4E0D\u53EF\u7528",status:"error"})}},{title:"\u65F6\u95F4\u8303\u56F4",render:function(l,_){return(0,r.jsxs)(r.Fragment,{children:[_.StartTime&&(0,r.jsxs)("div",{children:["\u5F00\u59CB\u65F6\u95F4\uFF1A",(0,r.jsx)(j.Z,{timeStr:_.StartTime})]}),_.EndTime&&(0,r.jsxs)("div",{children:["\u7ED3\u675F\u65F6\u95F4\uFF1A",(0,r.jsx)(j.Z,{timeStr:_.EndTime})]})]})}},{title:"\u65F6\u95F4",render:function(l,_){return(0,r.jsx)(f.Z,{model:_})}},{title:"\u64CD\u4F5C",width:200,render:function(l,_){return(0,r.jsx)(S.ZP.Group,{children:(0,r.jsx)(S.ZP,{type:"link",onClick:function(){C(_)},children:"\u7F16\u8F91"})})}}];return(0,h.useEffect)(function(){te()},[X]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ce,{show:i!=null,hide:function(){return C(void 0)},data:i||{},ok:function(){C(void 0),te()}}),(0,r.jsx)(E.Z,{title:"\u6298\u6263",extra:(0,r.jsx)(S.ZP,{type:"primary",onClick:function(){C({})},children:"\u65B0\u589E"}),children:(0,r.jsx)(U.Z,{rowKey:function(l){return l.Id||""},loading:G,columns:se,dataSource:z.Items||[],pagination:{showSizeChanger:!1,pageSize:20,current:X.Page,total:z.TotalCount,onChange:function(l){W(n()(n()({},X),{},{Page:l}))}}})})]})}},38295:function(ee,R,e){e.d(R,{o:function(){return Y}});var T=e(15009),n=e.n(T),g=e(99289),s=e.n(g),A=e(19632),y=e.n(A),S=e(47650),E=e(30699),U=e(85134),h=e(66419),f=function(o){var m=c.mallSettings||{},a=[m.StoreNickName,m.StoreEnglishName];o?a=[m.StoreOfficialName,m.StoreOfficialEnglishName].concat(y()(a)):a=[].concat(y()(a),[m.StoreOfficialName,m.StoreOfficialEnglishName]);var t=a.filter(function(I){return!(0,h.Wq)(I)}).at(0);return t||U.v.app.name||U.v.app.englishName},j=function(){var u=s()(n()().mark(function o(){return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E.x1.mall.notificationUnReadCount().then(function(t){c.notificationCount=t.data.Data||0});case 2:case"end":return a.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),Z=function(){var u=s()(n()().mark(function o(){var m;return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.x1.mallAdmin.gradeListGrades();case 2:m=t.sent,c.grades=m.data.Data||[];case 4:case"end":return t.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),b=function(){var u=s()(n()().mark(function o(){var m;return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.x1.mallAdmin.storeQueryStores();case 2:m=t.sent,c.stores=m.data.Data||[];case 4:case"end":return t.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),B=function(){var u=s()(n()().mark(function o(){var m;return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.x1.mall.shoppingCartCount();case 2:m=t.sent,c.shoppingCartCount=m.data.Data||0;case 4:case"end":return t.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),x=function(){var u=s()(n()().mark(function o(){var m;return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.x1.mall.storeGetCurrentStore();case 2:m=t.sent,c.currentStore=m.data.Data||{};case 4:case"end":return t.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),D=function(){var u=s()(n()().mark(function o(){var m;return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.x1.mall.storeMostNearbyStore();case 2:m=t.sent,c.mostNearbyStore=m.data.Data||{};case 4:case"end":return t.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),L=function(){var u=s()(n()().mark(function o(){return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E.x1.platform.userAuth().then(function(t){c.userAuthResult=t.data||{}});case 2:case"end":return a.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),M=function(){var u=s()(n()().mark(function o(){return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E.x1.sys.adminAuth().then(function(t){c.adminAuthResult=t.data||{}});case 2:case"end":return a.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),p=function(){var u=s()(n()().mark(function o(){return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E.x1.sys.manageAdminQueryAdminPermissions().then(function(t){c.adminPermissions=t.data||{}});case 2:case"end":return a.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),F=function(){var u=s()(n()().mark(function o(){return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E.x1.mallManager.storeManagerPermissionGetMyPermission().then(function(t){c.managerPermissions=t.data||{}});case 2:case"end":return a.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),$=function(){var u=s()(n()().mark(function o(){return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E.x1.mallManager.storeManagerAuth().then(function(t){c.storeManagerAuthResult=t.data||{}});case 2:case"end":return a.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),v=function(){var u=s()(n()().mark(function o(){return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E.x1.mall.userStoreUserAuth().then(function(t){c.storeUserAuthResult=t.data||{}});case 2:case"end":return a.stop()}},o)}));return function(){return u.apply(this,arguments)}}(),c=(0,S.sj)({queryUserAuthResult:L,getAppName:f,queryAdminAuthResult:M,queryStoreManagerAuthResult:$,queryStoreUserAuthResult:v,queryAdminPermission:p,queryStoreManagerPermission:F,queryGrades:Z,queryStores:b,queryNotificationCount:j,queryShoppingCartCount:B,queryCurrentStore:x,queryMostNearbyStore:D,messageHistory:[],grades:[],stores:[],notificationCount:0,headerHeight:0,bottomHeight:0,mallSettings:{},shoppingCartCount:0,currentStore:void 0,mostNearbyStore:void 0,userAuthResult:void 0,adminAuthResult:void 0,adminPermissions:void 0,storeUserAuthResult:void 0,storeManagerAuthResult:void 0,managerPermissions:void 0,get user(){var u;return(u=this.userAuthResult)===null||u===void 0?void 0:u.User},get admin(){var u;return(u=this.adminAuthResult)===null||u===void 0?void 0:u.Admin},get storeUser(){var u;return(u=this.storeUserAuthResult)===null||u===void 0?void 0:u.StoreUser},get storeManager(){var u;return(u=this.storeManagerAuthResult)===null||u===void 0?void 0:u.StoreManager}}),Y=function(){return(0,S.ey)(c)}}}]);

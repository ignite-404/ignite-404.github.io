"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[181],{74590:function(te,W,e){var z=e(15009),r=e.n(z),H=e(99289),_=e.n(H),N=e(5574),R=e.n(N),D=e(83062),g=e(14726),O=e(67294),h=e(85893);W.Z=function(S){var Z=S.action,F=S.confirmText,I=S.hide,J=(0,O.useState)(!1),A=R()(J,2),E=A[0],P=A[1],y=F||"\u786E\u5B9A\u5220\u9664\uFF1F",p=function(){var U=_()(r()().mark(function V(){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(confirm(y)){c.next=2;break}return c.abrupt("return");case 2:return P(!0),c.prev=3,c.next=6,Z();case 6:return c.prev=6,P(!1),c.finish(6);case 9:case"end":return c.stop()}},V,null,[[3,,6,9]])}));return function(){return U.apply(this,arguments)}}();return I?null:(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(D.Z,{title:y,children:(0,h.jsx)(g.ZP,{loading:E,danger:!0,type:"link",onClick:function(){p()},children:"\u5220\u9664"})})})}},48746:function(te,W,e){var z=e(15009),r=e.n(z),H=e(99289),_=e.n(H),N=e(96256),R=e(35291),D=e(30967),g=e(42838),O=e(85893);W.Z=function(h){var S=h.selectedSku,Z=h.onChange,F=h.style,I=h.props,J=function(){var A=_()(r()().mark(function E(P){var y,p,U;return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(0,g.Wq)(P)){f.next=2;break}return f.abrupt("return",[]);case 2:return f.next=4,D.x1.mallAdmin.skuQuerySkuForSelection({Keywords:P,Take:20});case 4:return p=f.sent,U=p==null||(y=p.data)===null||y===void 0||(y=y.Data)===null||y===void 0?void 0:y.map(function(c){return{label:(0,R.CQ)(c)||"--",value:c.Id||"--"}}),f.abrupt("return",U||[]);case 7:case"end":return f.stop()}},E)}));return function(P){return A.apply(this,arguments)}}();return(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(N.Z,{style:F,props:I,onSearch:function(){var A=_()(r()().mark(function E(P){return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,J(P);case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},E)}));return function(E){return A.apply(this,arguments)}}(),placeholder:"\u641C\u7D22\u5546\u54C1...",value:(S==null?void 0:S.Id)||void 0,initItem:S==null?void 0:{label:(0,R.CQ)(S)||"",value:S.Id||""},onChange:function(E){Z&&Z(E==null?void 0:{Id:E.value,Name:E.label})}})})}},19189:function(te,W,e){e.r(W),e.d(W,{default:function(){return _e}});var z=e(97857),r=e.n(z),H=e(5574),_=e.n(H),N=e(66309),R=e(40411),D=e(14726),g=e(4393),O=e(80799),h=e(67294),S=e(23806),Z=e(1288),F=e(30967),I=e(42838),J=e(15009),A=e.n(J),E=e(99289),P=e.n(E),y=e(45360),p=e(85576),U=e(78957),V=e(57381),f=e(11346),c=e(25278),ne=e(24435),a=e(72269),l=e(84567),m=e(96864),t=e(74590),u=e(19632),ee=e.n(u),se=e(35291),ie=e(66628),oe=e(48746),n=e(85893),de=function(b){var M=b.sku_list,L=b.onChange,w=b.maxCount,X=(0,h.useState)(!1),G=_()(X,2),B=G[0],K=G[1],Y=w||1e5,Q=M.length>=Y,k=[{title:"No",dataIndex:"index",valueType:"indexBorder"},{title:"\u6392\u5E8F",dataIndex:"sort",width:60,className:"drag-visible"},{title:"\u5546\u54C1",render:function(T,C){return(0,se.CQ)(C)||"--"}},{title:"\u63CF\u8FF0",render:function(T,C){return C.Description||"--"}},{render:function(T,C){return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(D.ZP,{type:"link",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&L(ee()(M.filter(function(v){return v.Id!=C.Id})))},children:"\u5220\u9664"})})}}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z,{title:"\u641C\u7D22\u5546\u54C1",open:B,onCancel:function(){return K(!1)},onOk:function(){return K(!1)},children:(0,n.jsx)(oe.Z,{onChange:function(T){if(T){if(Q){var C;(C=I.iI.message)===null||C===void 0||C.error("\u6570\u91CF\u5DF2\u8FBE\u4E0A\u9650\uFF1A".concat(Y));return}if(confirm("\u6DFB\u52A0".concat((0,se.CQ)(T)||"--","\uFF1F"))){if(M.some(function(v){return v.Id==T.Id})){var i;(i=I.iI.message)===null||i===void 0||i.error("\u8BE5\u5546\u54C1\u5DF2\u5B58\u5728");return}L([].concat(ee()(M),[T])),K(!1)}}}})}),(0,n.jsx)(g.Z,{size:"small",title:"\u9009\u62E9\u5546\u54C1",extra:(0,n.jsx)(D.ZP,{disabled:Q,type:"link",size:"small",onClick:function(){K(!0)},children:"\u6DFB\u52A0\u5546\u54C1"}),children:(0,n.jsx)(ie.Z,{rowKey:"Id",columns:k,dataSource:M||[],toolBarRender:!1,pagination:!1,headerTitle:!1,search:!1,dragSortKey:"sort",onDragSortEnd:function(T,C,i){L(ee()(i))}})})]})},ce=e(38295),$=e(46629),me=function(b){var M,L,w,X=b.show,G=b.hide,B=b.data,K=b.ok,Y=(0,h.useState)(!1),Q=_()(Y,2),k=Q[0],x=Q[1],T=(0,h.useState)({}),C=_()(T,2),i=C[0],v=C[1],q=(0,ce.o)(),ue=function(s){x(!0),F.x1.mallAdmin.discountSave(r()({},s)).then(function(d){d.data.Error?y.ZP.error(d.data.Error.Message):(y.ZP.success("\u4FDD\u5B58\u6210\u529F"),K())}).finally(function(){x(!1)})};return(0,h.useEffect)(function(){v(r()({},B||{}))},[B]),(0,h.useEffect)(function(){X&&q.queryStores()},[X]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(p.Z,{width:"60%",title:"\u6298\u6263",open:X,onCancel:function(){return G()},footer:(0,n.jsxs)(U.Z,{children:[(0,n.jsx)(t.Z,{action:P()(A()().mark(function o(){var s;return A()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,F.x1.mallAdmin.discountDelete({Id:B.Id});case 2:s=j.sent,(0,I._y)(s,function(){G(),K()});case 4:case"end":return j.stop()}},o)})),hide:(0,I.Wq)(B.Id)}),(0,n.jsx)(D.ZP,{type:"primary",onClick:function(){ue(i)},children:"\u4FDD\u5B58"})]}),children:(0,n.jsx)(V.Z,{spinning:k,children:(0,n.jsxs)(f.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,n.jsx)(f.Z.Item,{label:"\u540D\u79F0",tooltip:"61\u513F\u7AE5\u8282",children:(0,n.jsx)(c.Z,{maxLength:30,required:!0,value:i.Name||"",onChange:function(s){v(r()(r()({},i),{},{Name:s.target.value}))}})}),(0,n.jsx)(f.Z.Item,{label:"\u63CF\u8FF0",children:(0,n.jsx)(c.Z.TextArea,{maxLength:30,required:!0,value:i.Description||"",onChange:function(s){v(r()(r()({},i),{},{Description:s.target.value}))}})}),(0,n.jsx)(f.Z.Item,{label:"\u6298\u6263",children:(0,n.jsx)(ne.Z,{min:0,max:1,required:!0,value:i.DiscountPercentage||0,onChange:function(s){v(r()(r()({},i),{},{DiscountPercentage:s||0}))}})}),(0,n.jsx)(f.Z.Item,{label:"\u6307\u5B9A\u95E8\u5E97\u53EF\u7528",children:(0,n.jsxs)(U.Z,{direction:"horizontal",children:[(0,n.jsx)(a.Z,{checked:i.LimitedToStore,onChange:function(s){v(r()(r()({},i),{},{LimitedToStore:s}))}}),i.LimitedToStore||(0,n.jsx)("b",{children:"\u5F53\u524D\u6240\u6709\u95E8\u5E97\u53EF\u7528"})]})}),i.LimitedToStore&&(0,n.jsx)(f.Z.Item,{label:"\u9002\u7528\u95E8\u5E97",children:(0,n.jsx)(l.Z.Group,{onChange:function(s){v(r()(r()({},i),{},{Stores:q.stores.filter(function(d){return s.indexOf(d.Id||"")>=0})}))},value:((M=i.Stores)===null||M===void 0?void 0:M.map(function(o){return o.Id||""}))||[],options:q.stores.map(function(o){return{label:o.Name,value:o.Id||""}})})}),(0,n.jsx)(f.Z.Item,{label:"\u7279\u5B9A\u5546\u54C1",children:(0,n.jsx)(a.Z,{checked:i.LimitedToSku,onChange:function(s){v(r()(r()({},i),{},{LimitedToSku:s}))}})}),i.LimitedToSku&&(0,n.jsx)(f.Z.Item,{label:"\u53C2\u4E0E\u5546\u54C1",children:(0,n.jsx)(de,{sku_list:i.Skus||[],onChange:function(s){v(r()(r()({},i),{},{Skus:s||[]}))}})}),(0,n.jsx)(f.Z.Item,{label:"\u65F6\u95F4\u8303\u56F4",children:(0,n.jsx)(m.default.RangePicker,{allowClear:!0,value:[((L=(0,$.mg)(i.StartTime))===null||L===void 0?void 0:L.add($.Mg,"hour"))||null,((w=(0,$.mg)(i.EndTime))===null||w===void 0?void 0:w.add($.Mg,"hour"))||null],onChange:function(s){var d,j;v(r()(r()({},i),{},{StartTime:s==null||(d=s.at(0))===null||d===void 0?void 0:d.add(-$.Mg,"hours").format($.dq),EndTime:s==null||(j=s.at(1))===null||j===void 0?void 0:j.add(-$.Mg,"hours").format($.dq)}))}})}),(0,n.jsx)(f.Z.Item,{label:"\u72B6\u6001\u53EF\u7528",children:(0,n.jsx)(a.Z,{checked:i.IsActive,onChange:function(s){v(r()(r()({},i),{},{IsActive:s}))}})}),(0,n.jsx)(f.Z.Item,{label:"\u6392\u5E8F",children:(0,n.jsx)(ne.Z,{value:i.Sort||0,onChange:function(s){v(r()(r()({},i),{},{Sort:s||0}))}})})]})})})})},_e=function(){var b=(0,h.useState)(!0),M=_()(b,2),L=M[0],w=M[1],X=(0,h.useState)({Items:[],TotalCount:0}),G=_()(X,2),B=G[0],K=G[1],Y=(0,h.useState)({Page:1}),Q=_()(Y,2),k=Q[0],x=Q[1],T=(0,h.useState)(void 0),C=_()(T,2),i=C[0],v=C[1],q=function(){w(!0),F.x1.mallAdmin.discountQueryPaging(r()({},k)).then(function(s){K(s.data||{})}).finally(function(){w(!1)})},ue=[{title:"\u540D\u79F0",render:function(s,d){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("b",{children:d.Name||"--"}),(0,I.Wq)(d.Description)||(0,n.jsx)("p",{children:d.Description})]})}},{title:"\u4F18\u60E0\u529B\u5EA6",render:function(s,d){return d.DiscountPercentage||0}},{title:"\u9002\u7528\u95E8\u5E97",render:function(s,d){var j;return d.LimitedToStore?(0,n.jsx)("span",{children:"".concat((j=d.Stores)===null||j===void 0?void 0:j.map(function(re){return re.Name||""}).join(","))}):(0,n.jsx)(N.Z,{color:"green",children:"\u5168\u90E8\u95E8\u5E97"})}},{title:"\u9002\u7528\u5546\u54C1",render:function(s,d){var j;return d.LimitedToSku?d.Skus?(j=d.Skus)===null||j===void 0?void 0:j.map(function(re,le){var ae;return(0,n.jsx)("div",{style:{marginBottom:5},children:"".concat(le+1,"-").concat((ae=re.Goods)===null||ae===void 0?void 0:ae.Name,"-").concat(re.Name)},le)}):null:(0,n.jsx)(N.Z,{color:"green",children:"\u5168\u5C40\u6709\u6548"})}},{title:"\u72B6\u6001",render:function(s,d){return d.IsActive?(0,n.jsx)(R.Z,{text:"\u53EF\u7528",status:"success"}):(0,n.jsx)(R.Z,{text:"\u4E0D\u53EF\u7528",status:"error"})}},{title:"\u65F6\u95F4\u8303\u56F4",render:function(s,d){return(0,n.jsxs)(n.Fragment,{children:[d.StartTime&&(0,n.jsxs)("div",{children:["\u5F00\u59CB\u65F6\u95F4\uFF1A",(0,n.jsx)(Z.Z,{timeStr:d.StartTime})]}),d.EndTime&&(0,n.jsxs)("div",{children:["\u7ED3\u675F\u65F6\u95F4\uFF1A",(0,n.jsx)(Z.Z,{timeStr:d.EndTime})]})]})}},{title:"\u65F6\u95F4",render:function(s,d){return(0,n.jsx)(S.Z,{model:d})}},{title:"\u64CD\u4F5C",width:200,render:function(s,d){return(0,n.jsx)(D.ZP.Group,{children:(0,n.jsx)(D.ZP,{type:"link",onClick:function(){v(d)},children:"\u7F16\u8F91"})})}}];return(0,h.useEffect)(function(){q()},[k]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(me,{show:i!=null,hide:function(){return v(void 0)},data:i||{},ok:function(){v(void 0),q()}}),(0,n.jsx)(g.Z,{title:"\u6298\u6263",extra:(0,n.jsx)(D.ZP,{type:"primary",onClick:function(){v({})},children:"\u65B0\u589E"}),children:(0,n.jsx)(O.Z,{rowKey:function(s){return s.Id||""},loading:L,columns:ue,dataSource:B.Items||[],pagination:{showSizeChanger:!1,pageSize:20,current:k.Page,total:B.TotalCount,onChange:function(s){x(r()(r()({},k),{},{Page:s}))}}})})]})}},38295:function(te,W,e){e.d(W,{o:function(){return ne}});var z=e(15009),r=e.n(z),H=e(99289),_=e.n(H),N=e(19632),R=e.n(N),D=e(47650),g=e(30967),O=e(85134),h=e(42838),S=function(l){var m=c.mallSettings||{},t=[m.StoreNickName,m.StoreEnglishName];l?t=[m.StoreOfficialName,m.StoreOfficialEnglishName].concat(R()(t)):t=[].concat(R()(t),[m.StoreOfficialName,m.StoreOfficialEnglishName]);var u=t.filter(function(ee){return!(0,h.Wq)(ee)}).at(0);return u||O.v.app.name||O.v.app.englishName},Z=function(){var a=_()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.mall.notificationUnReadCount().then(function(u){c.notificationCount=u.data.Data||0});case 2:case"end":return t.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),F=function(){var a=_()(r()().mark(function l(){var m;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,g.x1.mallAdmin.gradeListGrades();case 2:m=u.sent,c.grades=m.data.Data||[];case 4:case"end":return u.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),I=function(){var a=_()(r()().mark(function l(){var m;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,g.x1.mallAdmin.storeQueryStores();case 2:m=u.sent,c.stores=m.data.Data||[];case 4:case"end":return u.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),J=function(){var a=_()(r()().mark(function l(){var m;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,g.x1.mall.shoppingCartCount();case 2:m=u.sent,c.shoppingCartCount=m.data.Data||0;case 4:case"end":return u.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),A=function(){var a=_()(r()().mark(function l(){var m;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,g.x1.mall.storeGetCurrentStore();case 2:m=u.sent,c.currentStore=m.data.Data||{};case 4:case"end":return u.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),E=function(){var a=_()(r()().mark(function l(){var m;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,g.x1.mall.storeMostNearbyStore();case 2:m=u.sent,c.mostNearbyStore=m.data.Data||{};case 4:case"end":return u.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),P=function(){var a=_()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.platform.userAuth().then(function(u){c.userAuthResult=u.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),y=function(){var a=_()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.sys.adminAuth().then(function(u){c.adminAuthResult=u.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),p=function(){var a=_()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.sys.manageAdminQueryAdminPermissions().then(function(u){c.adminPermissions=u.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),U=function(){var a=_()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.mallManager.storeManagerPermissionGetMyPermission().then(function(u){c.managerPermissions=u.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),V=function(){var a=_()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.mallManager.storeManagerAuth().then(function(u){c.storeManagerAuthResult=u.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),f=function(){var a=_()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.mall.userStoreUserAuth().then(function(u){c.storeUserAuthResult=u.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),c=(0,D.sj)({queryUserAuthResult:P,getAppName:S,queryAdminAuthResult:y,queryStoreManagerAuthResult:V,queryStoreUserAuthResult:f,queryAdminPermission:p,queryStoreManagerPermission:U,queryGrades:F,queryStores:I,queryNotificationCount:Z,queryShoppingCartCount:J,queryCurrentStore:A,queryMostNearbyStore:E,messageHistory:[],grades:[],stores:[],notificationCount:0,headerHeight:0,bottomHeight:0,mallSettings:{},shoppingCartCount:0,currentStore:void 0,mostNearbyStore:void 0,userAuthResult:void 0,adminAuthResult:void 0,adminPermissions:void 0,storeUserAuthResult:void 0,storeManagerAuthResult:void 0,managerPermissions:void 0,get user(){var a;return(a=this.userAuthResult)===null||a===void 0?void 0:a.User},get admin(){var a;return(a=this.adminAuthResult)===null||a===void 0?void 0:a.Admin},get storeUser(){var a;return(a=this.storeUserAuthResult)===null||a===void 0?void 0:a.StoreUser},get storeManager(){var a;return(a=this.storeManagerAuthResult)===null||a===void 0?void 0:a.StoreManager}}),ne=function(){return(0,D.ey)(c)}}}]);

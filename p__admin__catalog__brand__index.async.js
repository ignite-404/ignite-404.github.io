"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4563],{74590:function(w,T,e){var x=e(15009),n=e.n(x),c=e(99289),u=e.n(c),g=e(5574),v=e.n(g),M=e(83062),U=e(14726),I=e(67294),t=e(85893);T.Z=function(l){var A=l.action,D=l.confirmText,R=l.hide,y=(0,I.useState)(!1),E=v()(y,2),_=E[0],s=E[1],m=D||"\u786E\u5B9A\u5220\u9664\uFF1F",d=function(){var j=u()(n()().mark(function a(){return n()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(confirm(m)){O.next=2;break}return O.abrupt("return");case 2:return s(!0),O.prev=3,O.next=6,A();case 6:return O.prev=6,s(!1),O.finish(6);case 9:case"end":return O.stop()}},a,null,[[3,,6,9]])}));return function(){return j.apply(this,arguments)}}();return R?null:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(M.Z,{title:m,children:(0,t.jsx)(U.ZP,{loading:_,danger:!0,type:"link",onClick:function(){d()},children:"\u5220\u9664"})})})}},93338:function(w,T,e){var x=e(97857),n=e.n(x),c=e(15009),u=e.n(c),g=e(99289),v=e.n(g),M=e(82052),U=e(68421),I=e(9383),t=e(67294),l=e(85893);T.Z=function(A){var D=A.width,R=A.rate,y=(0,t.useRef)(null),E=(0,M.Z)(y),_=E==null?void 0:E.width,s=function(){var d=v()(u()().mark(function j(){return u()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(R!=null&&_!=null)){o.next=2;break}return o.abrupt("return",_*R);case 2:return o.abrupt("return",void 0);case 3:case"end":return o.stop()}},j)}));return function(){return d.apply(this,arguments)}}(),m=(0,U.Z)(s,{manual:!0,debounceWait:30});return(0,t.useEffect)(function(){m.run()},[_]),(0,l.jsx)("div",{ref:y,style:{display:"block",padding:0,margin:0,width:D!=null?D:"100%"},children:(0,l.jsx)(I.J,n()({width:_||void 0,height:m.data||void 0,radius:"none"},A))})}},48382:function(w,T,e){var x=e(5574),n=e.n(x),c=e(98163),u=e(7134),g=e(55241),v=e(67294),M=e(35291),U=e(66419),I=e(93338),t=e(85893);T.Z=function(l){var A=l.data,D=l.count,R=(0,v.useState)(void 0),y=n()(R,2),E=y[0],_=y[1],s=A||[],m=D||3,d=s.map(function(a){return(0,M.u2)(a)}),j=function(o){return(0,t.jsx)("div",{style:{maxWidth:500},children:(0,t.jsx)(I.Z,{src:o.small||"",alt:""})})};return(0,U.G5)(d)?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{display:"none"},children:(0,t.jsx)(c.Z.PreviewGroup,{preview:{current:Math.max(E||0,0),visible:E!=null,onVisibleChange:function(o,O,f){_(o?f:void 0)},onChange:function(o){E!=null&&_(o)}},children:d.map(function(a,o){return(0,t.jsx)(c.Z,{src:a.large||"",alt:""},o)})})}),(0,t.jsx)("div",{style:{},children:(0,t.jsx)(u.C.Group,{maxCount:m,shape:"square",children:d.map(function(a,o){return(0,t.jsx)(g.Z,{title:"\u9884\u89C8",content:j(a),placement:"left",children:(0,t.jsx)(u.C,{style:{backgroundColor:"gray"},src:a.small||"",size:"large",onClick:function(){_(o)}})},o)})})})]})}},23806:function(w,T,e){var x=e(1288),n=e(85893);T.Z=function(c){var u=c.model,g=c.fallback;if(u==null||u==null)return null;var v=u==null?void 0:u.CreationTime,M=u==null?void 0:u.LastModificationTime;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{style:{},children:[(0,n.jsx)("div",{children:(0,n.jsx)(x.Z,{prefix:(0,n.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:v,fallback:g})}),(0,n.jsx)("div",{children:(0,n.jsx)(x.Z,{prefix:(0,n.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:M,fallback:g})})]})})}},1288:function(w,T,e){var x=e(78957),n=e(83062),c=e(46629),u=e(85893);T.Z=function(g){var v,M=g.timeStr,U=g.fallback,I=g.onlyDate,t=g.prefix,l=(v=(0,c.mg)(M))===null||v===void 0?void 0:v.add(c.Mg,"hour");if(!l)return U||null;var A=(0,c.ND)().utc().add(c.Mg,"hour"),D=l.isSame(A,"year"),R=l.diff(A,"day"),y=D?l.format(c.AK):l.format(c.vc),E=function(){return(0,u.jsxs)("div",{children:[(0,u.jsxs)(x.Z,{direction:"horizontal",children:[(0,u.jsx)("div",{children:l.fromNow()}),(0,u.jsx)("div",{children:l.format(c.On)})]}),(0,u.jsx)("div",{children:l.format(c.t9)})]})};return(0,u.jsx)(n.Z,{title:E(),children:(0,u.jsxs)(x.Z,{direction:"horizontal",children:[t,(0,u.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:I?l.format(c.vc):l.format(c.dq)})]})})}},8045:function(w,T,e){var x=e(97857),n=e.n(x),c=e(14726),u=e(67294),g=e(85893);T.Z=function(v){var M=v.loading,U=v.inputProps,I=v.onSelect,t=v.uploadButtonProps,l=(0,u.useRef)(null);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:{display:"none"},children:(0,g.jsx)("input",n()(n()({ref:l,type:"file",multiple:!1},U),{},{onChange:function(D){try{var R=D.target.files;R&&I&&I(R)}finally{l.current&&(l.current.value="",l.current.files=null)}}}))}),(0,g.jsx)(c.ZP,n()(n()({size:"small",loading:M,type:"dashed"},t),{},{onClick:function(){var D;(D=l.current)===null||D===void 0||D.click()},children:"\u9009\u62E9\u56FE\u7247"}))]})}},6786:function(w,T,e){var x=e(15009),n=e.n(x),c=e(99289),u=e.n(c),g=e(97857),v=e.n(g),M=e(98163),U=e(45360),I=e(14726),t=e(78957),l=e(85134),A=e(55932),D=e(55793),R=e(66419),y=e(8045),E=e(68421),_=e(85893);T.Z=function(s){var m=s.data,d=s.ok,j=s.remove,a=s.loadingSave,o=s.width,O=s.defaultImage,f=s.imageProps,J=s.uploadButtonProps,$=s.removeButtonProps,r=(0,A.Kk)(m,{width:o||100}),Q=function(){var b=r||O;return(0,R.Wq)(b)?null:(0,_.jsx)(M.Z,v()({src:b||"",alt:"",width:o||50},f))},X=function(){var W=u()(n()().mark(function b(B){var K;return n()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(P.prev=0,(0,D.Vl)(B.name)){P.next=4;break}return U.ZP.error("\u53EA\u652F\u6301 ".concat((0,D.$z)().join("\u3001")," \u683C\u5F0F\u7684\u56FE\u7247")),P.abrupt("return");case 4:return P.next=6,(0,D.ur)(B,l.v.upload.max_size);case 6:if(B=P.sent,!(B.size>l.v.upload.max_size)){P.next=10;break}return U.ZP.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC71MB"),P.abrupt("return");case 10:return P.next=12,(0,D.fn)(B);case 12:K=P.sent,K&&d&&d(K),P.next=20;break;case 16:P.prev=16,P.t0=P.catch(0),console.log(P.t0),U.ZP.error("\u4E0A\u4F20\u9047\u5230\u9519\u8BEF");case 20:case"end":return P.stop()}},b,null,[[0,16]])}));return function(B){return W.apply(this,arguments)}}(),H=(0,E.Z)(X,{manual:!0}),Y=function(){return(0,R.Wq)(r)||!j?null:(0,_.jsx)(I.ZP,v()(v()({size:"small",type:"dashed",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&j&&j()}},$),{},{children:"\u79FB\u9664\u56FE\u7247"}))};return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(t.Z,{direction:"horizontal",children:[Q(),(0,_.jsxs)(t.Z,{direction:"vertical",children:[(0,_.jsx)(y.Z,{loading:a||H.loading,inputProps:{accept:"image/*",multiple:!1},onSelect:function(b){var B=b.item(0);B&&H.run(B)},uploadButtonProps:J}),Y()]})]})})}},60951:function(w,T,e){e.r(T),e.d(T,{default:function(){return Y}});var x=e(97857),n=e.n(x),c=e(5574),u=e.n(c),g=e(68421),v=e(40411),M=e(14726),U=e(4393),I=e(80799),t=e(67294),l=e(48382),A=e(23806),D=e(30699),R=e(15009),y=e.n(R),E=e(99289),_=e.n(E),s=e(45360),m=e(85576),d=e(78957),j=e(57381),a=e(11346),o=e(25278),O=e(72269),f=e(74590),J=e(6786),$=e(66419),r=e(85893),Q=function(W){var b=W.show,B=W.hide,K=W.data,G=W.ok,P=(0,t.useState)(!1),L=u()(P,2),F=L[0],V=L[1],N=(0,t.useState)({}),S=u()(N,2),C=S[0],Z=S[1],k=function(i){var p;i.Name=(p=i.Name)===null||p===void 0?void 0:p.trim(),!(0,$.Wq)(i.Name)&&(V(!0),D.x1.mallAdmin.brandSaveBrand(n()({},i)).then(function(z){z.data.Error?s.ZP.error(z.data.Error.Message):(s.ZP.success("\u4FDD\u5B58\u6210\u529F"),G())}).finally(function(){V(!1)}))};return(0,t.useEffect)(function(){Z(n()({},K))},[K]),(0,t.useEffect)(function(){b||Z({})},[b]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(m.Z,{title:"\u54C1\u724C",open:b,onCancel:function(){return B()},footer:(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(f.Z,{action:_()(y()().mark(function h(){var i;return y()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,D.x1.mallAdmin.brandDelete({Id:C.Id});case 2:i=z.sent,(0,$._y)(i,function(){B(),G()});case 4:case"end":return z.stop()}},h)})),hide:(0,$.Wq)(C.Id)}),(0,r.jsx)(M.ZP,{type:"primary",loading:F,onClick:function(){k(C)},children:"\u4FDD\u5B58"})]}),children:(0,r.jsx)(j.Z,{spinning:F,children:(0,r.jsxs)(a.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,r.jsx)(a.Z.Item,{label:"\u56FE\u7247",children:(0,r.jsx)(J.Z,{loadingSave:F,data:C.Picture||{},ok:function(i){Z(n()(n()({},C),{},{PictureMetaId:i.Id,Picture:i}))},remove:function(){confirm("\u786E\u5B9A\u5220\u9664\u56FE\u7247\u5417\uFF1F")&&Z(n()(n()({},C),{},{PictureMetaId:void 0,Picture:void 0}))}})}),(0,r.jsxs)(a.Z.Item,{label:"\u540D\u79F0",required:!0,children:[(0,r.jsx)(o.Z,{count:{show:!0,max:20},maxLength:20,value:C.Name||"",onChange:function(i){Z(n()(n()({},C),{},{Name:i.target.value}))}}),(0,$.Wq)(C.Name)&&(0,r.jsx)("p",{style:{color:"red"},children:"\u5FC5\u586B"})]}),(0,r.jsx)(a.Z.Item,{label:"\u63CF\u8FF0",rules:[{max:50}],children:(0,r.jsx)(o.Z.TextArea,{value:C.Description||"",onChange:function(i){Z(n()(n()({},C),{},{Description:i.target.value}))}})}),(0,r.jsx)(a.Z.Item,{label:"\u5173\u952E\u8BCD",rules:[{max:200}],children:(0,r.jsx)(o.Z.TextArea,{value:C.MetaKeywords||"",onChange:function(i){Z(n()(n()({},C),{},{MetaKeywords:i.target.value}))}})}),(0,r.jsx)(a.Z.Item,{label:"\u9996\u9875\u663E\u793A",children:(0,r.jsx)(O.Z,{checked:C.ShowOnPublicPage,onChange:function(i){Z(n()(n()({},C),{},{ShowOnPublicPage:i}))}})}),(0,r.jsx)(a.Z.Item,{label:"\u662F\u5426\u53D1\u5E03",children:(0,r.jsx)(O.Z,{checked:C.Published,onChange:function(i){Z(n()(n()({},C),{},{Published:i}))}})})]})})})})},X=function(b){var B=b.query,K=b.onSearch,G=(0,t.useState)({}),P=u()(G,2),L=P[0],F=P[1],V=function(S){S.Page=1,K&&K(S)};return(0,t.useEffect)(function(){F(n()({},B||{}))},[B]),(0,r.jsx)(U.Z,{bordered:!1,style:{marginBottom:10},children:(0,r.jsxs)(a.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},autoComplete:"off",layout:"inline",children:[(0,r.jsx)(a.Z.Item,{label:"\u5173\u952E\u8BCD",children:(0,r.jsx)(o.Z,{value:L.Name||"",onChange:function(S){F(n()(n()({},L),{},{Name:S.target.value}))}})}),(0,r.jsx)(a.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,r.jsx)(M.ZP,{type:"primary",htmlType:"submit",onClick:function(){return V(L)},children:"\u641C\u7D22"})})]})})},H=X,Y=function(){var W,b=(0,g.Z)(D.x1.mallAdmin.brandQueryPaging,{manual:!0}),B=b.loading,K=((W=b.data)===null||W===void 0?void 0:W.data)||{},G=(0,t.useState)({Page:1}),P=u()(G,2),L=P[0],F=P[1],V=(0,t.useState)(void 0),N=u()(V,2),S=N[0],C=N[1],Z=function(){b.run(n()({},L))},k=[{title:"\u540D\u79F0",render:function(i,p){return p.Name}},{title:"\u63CF\u8FF0",render:function(i,p){return p.Description||"--"}},{title:"\u5173\u952E\u8BCD",render:function(i,p){return p.MetaKeywords||"--"}},{title:"\u56FE\u7247",render:function(i,p){return p.Picture==null?null:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(l.Z,{data:[p.Picture]})})}},{title:"\u9996\u9875\u5C55\u793A",render:function(i,p){return(0,r.jsx)(v.Z,{status:p.ShowOnPublicPage?"success":"default"})}},{title:"\u72B6\u6001",render:function(i,p){return(0,r.jsxs)(r.Fragment,{children:[p.Published&&(0,r.jsx)(v.Z,{status:"success",text:"\u53EF\u7528"}),p.Published||(0,r.jsx)(v.Z,{status:"error",text:"\u4E0D\u53EF\u7528"})]})}},{title:"\u65F6\u95F4",render:function(i,p){return(0,r.jsx)(A.Z,{model:p})}},{title:"\u64CD\u4F5C",width:200,render:function(i,p){return(0,r.jsx)(M.ZP.Group,{children:(0,r.jsx)(M.ZP,{type:"link",onClick:function(){C(p)},children:"\u7F16\u8F91"})})}}];return(0,t.useEffect)(function(){Z()},[L]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Q,{show:S!=null,hide:function(){return C(void 0)},data:S||{},ok:function(){C(void 0),Z()}}),(0,r.jsx)(H,{query:L,onSearch:function(i){F(i)}}),(0,r.jsx)(U.Z,{title:"\u54C1\u724C",extra:(0,r.jsx)(M.ZP,{type:"primary",onClick:function(){C({})},children:"\u65B0\u589E"}),children:(0,r.jsx)(I.Z,{rowKey:function(i){return i.Id||""},loading:B,columns:k,dataSource:K.Items||[],pagination:{showSizeChanger:!1,pageSize:20,current:L.Page,total:K.TotalCount,onChange:function(i){F(n()(n()({},L),{},{Page:i}))}}})})]})}},55793:function(w,T,e){e.d(T,{$z:function(){return I},Ac:function(){return y},Vl:function(){return t},fn:function(){return D},ur:function(){return A}});var x=e(15009),n=e.n(x),c=e(99289),u=e.n(c),g=e(76857),v=e(66419),M=e(98005),U=e.n(M),I=function(){return["jpg","jpeg","png","gif"]},t=function(_){var s,m=((s=(0,v.mD)(_))===null||s===void 0?void 0:s.toLowerCase())||"";return I().indexOf(m)>=0},l=function(_,s,m,d){return new Promise(function(j,a){var o=new(U())(_,{maxHeight:s,maxWidth:m,quality:d,success:function(f){j(f)},error:function(f){a(f)}});console.log(o)})},A=function(){var E=u()(n()().mark(function _(s,m){var d,j,a,o;return n()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(s.size<=m)){f.next=2;break}return f.abrupt("return",s);case 2:return f.next=4,l(s,void 0,void 0,.9);case 4:if(s=f.sent,!(s.size<=m)){f.next=7;break}return f.abrupt("return",s);case 7:d=5,j=300,a=1e3,o=0;case 11:if(!(++o<=d)){f.next=22;break}return f.next=14,l(s,a,a,1);case 14:if(s=f.sent,!(s.size<=m)){f.next=17;break}return f.abrupt("return",s);case 17:if(a-=j,!(a<=0)){f.next=20;break}return f.abrupt("break",22);case 20:f.next=11;break;case 22:return f.abrupt("return",s);case 23:case"end":return f.stop()}},_)}));return function(s,m){return E.apply(this,arguments)}}(),D=function(){var E=u()(n()().mark(function _(s){var m,d;return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,R([s]);case 2:if(m=a.sent,d=m.at(0),d){a.next=6;break}throw new Error("response error");case 6:return a.abrupt("return",d);case 7:case"end":return a.stop()}},_)}));return function(s){return E.apply(this,arguments)}}(),R=function(){var E=u()(n()().mark(function _(s){var m,d;return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return m=new FormData,s.forEach(function(o,O){m.append("formFileCollection",o,o.name)}),a.next=4,g.M.post("/api/platform/storage/upload",m);case 4:if(d=a.sent,!d.data.Error){a.next=7;break}throw new Error(d.data.Error.Message||"upload error");case 7:return a.abrupt("return",d.data.Data||[]);case 8:case"end":return a.stop()}},_)}));return function(s){return E.apply(this,arguments)}}(),y=function(_){return new Promise(function(s,m){var d=new FileReader;d.onload=function(){s(d.result)},d.onerror=function(j){m(j)},d.readAsDataURL(_)})}}}]);

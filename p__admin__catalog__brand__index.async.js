"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4563],{74590:function(N,U,e){var x=e(15009),n=e.n(x),f=e(99289),u=e.n(f),g=e(5574),v=e.n(g),M=e(83062),A=e(28036),B=e(67294),_=e(85893);U.Z=function(o){var I=o.action,D=o.confirmText,b=o.hide,y=(0,B.useState)(!1),E=v()(y,2),t=E[0],s=E[1],c=D||"\u786E\u5B9A\u5220\u9664\uFF1F",d=function(){var O=u()(n()().mark(function r(){return n()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(confirm(c)){j.next=2;break}return j.abrupt("return");case 2:return s(!0),j.prev=3,j.next=6,I();case 6:return j.prev=6,s(!1),j.finish(6);case 9:case"end":return j.stop()}},r,null,[[3,,6,9]])}));return function(){return O.apply(this,arguments)}}();return b?null:(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(M.Z,{title:c,children:(0,_.jsx)(A.ZP,{loading:t,danger:!0,type:"link",onClick:function(){d()},children:"\u5220\u9664"})})})}},23806:function(N,U,e){var x=e(1288),n=e(85893);U.Z=function(f){var u=f.model,g=f.fallback;if(u==null||u==null)return null;var v=u==null?void 0:u.CreationTime,M=u==null?void 0:u.LastModificationTime;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{style:{},children:[(0,n.jsx)("div",{children:(0,n.jsx)(x.Z,{prefix:(0,n.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:v,fallback:g})}),(0,n.jsx)("div",{children:(0,n.jsx)(x.Z,{prefix:(0,n.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:M,fallback:g})})]})})}},1288:function(N,U,e){var x=e(78957),n=e(83062),f=e(46629),u=e(85893);U.Z=function(g){var v,M=g.timeStr,A=g.fallback,B=g.onlyDate,_=g.prefix,o=(v=(0,f.QW)(M))===null||v===void 0?void 0:v.local();if(!o)return A||null;var I=(0,f.ND)().utc().local(),D=o.isSame(I,"year"),b=o.diff(I,"day"),y=D?o.format(f.AK):o.format(f.vc),E=function(){return(0,u.jsxs)("div",{children:[(0,u.jsxs)(x.Z,{direction:"horizontal",children:[(0,u.jsx)("div",{children:o.fromNow()}),(0,u.jsx)("div",{children:o.format(f.On)})]}),(0,u.jsx)("div",{children:o.format(f.t9)})]})};return(0,u.jsx)(n.Z,{title:E(),children:(0,u.jsxs)(x.Z,{direction:"horizontal",children:[_,(0,u.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:B?o.format(f.vc):o.format(f.dq)})]})})}},94442:function(N,U,e){var x=e(97857),n=e.n(x),f=e(15009),u=e.n(f),g=e(99289),v=e.n(g),M=e(5574),A=e.n(M),B=e(82052),_=e(68421),o=e(18207),I=e(67294),D=e(85893);U.Z=function(b){var y=b.width,E=b.rate,t=b.minHeightBeforeLoaded,s=(0,I.useState)(!1),c=A()(s,2),d=c[0],O=c[1],r=function(){if(!d)return t||void 0},m=(0,I.useRef)(null),j=(0,B.Z)(m),i=j==null?void 0:j.width,J=function(){var a=v()(u()().mark(function V(){return u()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(E!=null&&i!=null)){S.next=2;break}return S.abrupt("return",i*E);case 2:return S.abrupt("return",void 0);case 3:case"end":return S.stop()}},V)}));return function(){return a.apply(this,arguments)}}(),z=(0,_.Z)(J,{manual:!0,debounceWait:90});return(0,I.useEffect)(function(){z.run()},[i,E]),(0,D.jsx)("div",{ref:m,style:{display:"block",width:y!=null?y:"100%"},children:(0,D.jsx)(o.J,n()({showSkeleton:!0,width:i||void 0,height:z.data||void 0,radius:"none",onLoad:function(){O(!0)},style:{minHeight:r()||void 0}},b))})}},80427:function(N,U,e){var x=e(5574),n=e.n(x),f=e(98163),u=e(7134),g=e(55241),v=e(67294),M=e(35291),A=e(95813),B=e(94442),_=e(85893);U.Z=function(o){var I=o.data,D=o.count,b=(0,v.useState)(void 0),y=n()(b,2),E=y[0],t=y[1],s=I||[],c=D||3,d=s.map(function(r){return(0,M.u2)(r)}),O=function(m){return(0,_.jsx)("div",{style:{maxWidth:500},children:(0,_.jsx)(B.Z,{src:m.small||"",alt:""})})};return(0,A.G5)(d)?null:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{style:{display:"none"},children:(0,_.jsx)(f.Z.PreviewGroup,{preview:{current:Math.max(E||0,0),visible:E!=null,onVisibleChange:function(m,j,i){t(m?i:void 0)},onChange:function(m){E!=null&&t(m)}},children:d.map(function(r,m){return(0,_.jsx)(f.Z,{src:r.large||"",alt:""},m)})})}),(0,_.jsx)("div",{style:{},children:(0,_.jsx)(u.C.Group,{maxCount:c,shape:"square",children:d.map(function(r,m){return(0,_.jsx)(g.Z,{title:"\u9884\u89C8",content:O(r),placement:"left",children:(0,_.jsx)(u.C,{style:{backgroundColor:"gray"},src:r.small||"",size:"large",onClick:function(){t(m)}})},m)})})})]})}},8045:function(N,U,e){var x=e(97857),n=e.n(x),f=e(28036),u=e(67294),g=e(85893);U.Z=function(v){var M=v.loading,A=v.inputProps,B=v.onSelect,_=v.uploadButtonProps,o=(0,u.useRef)(null);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:{display:"none"},children:(0,g.jsx)("input",n()(n()({ref:o,type:"file",multiple:!1},A),{},{onChange:function(D){try{var b=D.target.files;b&&B&&B(b)}finally{o.current&&(o.current.value="",o.current.files=null)}}}))}),(0,g.jsx)(f.ZP,n()(n()({size:"small",loading:M,type:"dashed"},_),{},{onClick:function(){var D;(D=o.current)===null||D===void 0||D.click()},children:"\u9009\u62E9\u56FE\u7247"}))]})}},6786:function(N,U,e){var x=e(15009),n=e.n(x),f=e(99289),u=e.n(f),g=e(97857),v=e.n(g),M=e(98163),A=e(45360),B=e(28036),_=e(78957),o=e(85134),I=e(55932),D=e(55793),b=e(95813),y=e(8045),E=e(68421),t=e(85893);U.Z=function(s){var c=s.data,d=s.ok,O=s.remove,r=s.loadingSave,m=s.width,j=s.defaultImage,i=s.imageProps,J=s.uploadButtonProps,z=s.removeButtonProps,a=(0,I.Kk)(c,{width:m||100}),V=function(){var T=a||j;return(0,b.Wq)(T)?null:(0,t.jsx)(M.Z,v()({src:T||"",alt:"",width:m||50},i))},X=function(){var L=u()(n()().mark(function T(R){var W;return n()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(P.prev=0,(0,D.Vl)(R.name)){P.next=4;break}return A.ZP.error("\u53EA\u652F\u6301 ".concat((0,D.$z)().join("\u3001")," \u683C\u5F0F\u7684\u56FE\u7247")),P.abrupt("return");case 4:return P.next=6,(0,D.ur)(R,o.vc.upload.max_size);case 6:if(R=P.sent,!(R.size>o.vc.upload.max_size)){P.next=10;break}return A.ZP.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC71MB"),P.abrupt("return");case 10:return P.next=12,(0,D.fn)(R);case 12:W=P.sent,W&&d&&d(W),P.next=20;break;case 16:P.prev=16,P.t0=P.catch(0),console.log(P.t0),A.ZP.error("\u4E0A\u4F20\u9047\u5230\u9519\u8BEF");case 20:case"end":return P.stop()}},T,null,[[0,16]])}));return function(R){return L.apply(this,arguments)}}(),S=(0,E.Z)(X,{manual:!0}),Y=function(){return(0,b.Wq)(a)||!O?null:(0,t.jsx)(B.ZP,v()(v()({size:"small",type:"dashed",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&O&&O()}},z),{},{children:"\u79FB\u9664\u56FE\u7247"}))};return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(_.Z,{direction:"horizontal",children:[V(),(0,t.jsxs)(_.Z,{direction:"vertical",children:[(0,t.jsx)(y.Z,{loading:r||S.loading,inputProps:{accept:"image/*",multiple:!1},onSelect:function(T){var R=T.item(0);R&&S.run(R)},uploadButtonProps:J}),Y()]})]})})}},60951:function(N,U,e){e.r(U),e.d(U,{default:function(){return Y}});var x=e(97857),n=e.n(x),f=e(5574),u=e.n(f),g=e(68421),v=e(40411),M=e(28036),A=e(4393),B=e(80799),_=e(67294),o=e(80427),I=e(23806),D=e(30699),b=e(15009),y=e.n(b),E=e(99289),t=e.n(E),s=e(45360),c=e(85576),d=e(78957),O=e(57381),r=e(11346),m=e(65233),j=e(72269),i=e(74590),J=e(6786),z=e(95813),a=e(85893),V=function(L){var T=L.show,R=L.hide,W=L.data,$=L.ok,P=(0,_.useState)(!1),K=u()(P,2),w=K[0],Q=K[1],H=(0,_.useState)({}),F=u()(H,2),C=F[0],Z=F[1],k=function(l){var p;l.Name=(p=l.Name)===null||p===void 0?void 0:p.trim(),!(0,z.Wq)(l.Name)&&(Q(!0),D.x1.mallAdmin.brandSaveBrand(n()({},l)).then(function(G){G.data.Error?s.ZP.error(G.data.Error.Message):(s.ZP.success("\u4FDD\u5B58\u6210\u529F"),$())}).finally(function(){Q(!1)}))};return(0,_.useEffect)(function(){Z(n()({},W))},[W]),(0,_.useEffect)(function(){T||Z({})},[T]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(c.Z,{title:"\u54C1\u724C",open:T,onCancel:function(){return R()},footer:(0,a.jsxs)(d.Z,{children:[(0,a.jsx)(i.Z,{action:t()(y()().mark(function h(){var l;return y()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,D.x1.mallAdmin.brandDelete({Id:C.Id});case 2:l=G.sent,(0,z._y)(l,function(){R(),$()});case 4:case"end":return G.stop()}},h)})),hide:(0,z.Wq)(C.Id)}),(0,a.jsx)(M.ZP,{type:"primary",loading:w,onClick:function(){k(C)},children:"\u4FDD\u5B58"})]}),children:(0,a.jsx)(O.Z,{spinning:w,children:(0,a.jsxs)(r.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,a.jsx)(r.Z.Item,{label:"\u56FE\u7247",children:(0,a.jsx)(J.Z,{loadingSave:w,data:C.Picture||{},ok:function(l){Z(n()(n()({},C),{},{PictureMetaId:l.Id,Picture:l}))},remove:function(){confirm("\u786E\u5B9A\u5220\u9664\u56FE\u7247\u5417\uFF1F")&&Z(n()(n()({},C),{},{PictureMetaId:void 0,Picture:void 0}))}})}),(0,a.jsxs)(r.Z.Item,{label:"\u540D\u79F0",required:!0,children:[(0,a.jsx)(m.Z,{count:{show:!0,max:20},maxLength:20,value:C.Name||"",onChange:function(l){Z(n()(n()({},C),{},{Name:l.target.value}))}}),(0,z.Wq)(C.Name)&&(0,a.jsx)("p",{style:{color:"red"},children:"\u5FC5\u586B"})]}),(0,a.jsx)(r.Z.Item,{label:"\u63CF\u8FF0",rules:[{max:50}],children:(0,a.jsx)(m.Z.TextArea,{value:C.Description||"",onChange:function(l){Z(n()(n()({},C),{},{Description:l.target.value}))}})}),(0,a.jsx)(r.Z.Item,{label:"\u5173\u952E\u8BCD",rules:[{max:200}],children:(0,a.jsx)(m.Z.TextArea,{value:C.MetaKeywords||"",onChange:function(l){Z(n()(n()({},C),{},{MetaKeywords:l.target.value}))}})}),(0,a.jsx)(r.Z.Item,{label:"\u9996\u9875\u663E\u793A",children:(0,a.jsx)(j.Z,{checked:C.ShowOnPublicPage,onChange:function(l){Z(n()(n()({},C),{},{ShowOnPublicPage:l}))}})}),(0,a.jsx)(r.Z.Item,{label:"\u662F\u5426\u53D1\u5E03",children:(0,a.jsx)(j.Z,{checked:C.Published,onChange:function(l){Z(n()(n()({},C),{},{Published:l}))}})})]})})})})},X=function(T){var R=T.query,W=T.onSearch,$=(0,_.useState)({}),P=u()($,2),K=P[0],w=P[1],Q=function(F){F.Page=1,W&&W(F)};return(0,_.useEffect)(function(){w(n()({},R||{}))},[R]),(0,a.jsx)(A.Z,{bordered:!1,style:{marginBottom:10},children:(0,a.jsxs)(r.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},autoComplete:"off",layout:"inline",children:[(0,a.jsx)(r.Z.Item,{label:"\u5173\u952E\u8BCD",children:(0,a.jsx)(m.Z,{value:K.Name||"",onChange:function(F){w(n()(n()({},K),{},{Name:F.target.value}))}})}),(0,a.jsx)(r.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsx)(M.ZP,{type:"primary",htmlType:"submit",onClick:function(){return Q(K)},children:"\u641C\u7D22"})})]})})},S=X,Y=function(){var L,T=(0,g.Z)(D.x1.mallAdmin.brandQueryPaging,{manual:!0}),R=T.loading,W=((L=T.data)===null||L===void 0?void 0:L.data)||{},$=(0,_.useState)({Page:1}),P=u()($,2),K=P[0],w=P[1],Q=(0,_.useState)(void 0),H=u()(Q,2),F=H[0],C=H[1],Z=function(){T.run(n()({},K))},k=[{title:"\u540D\u79F0",render:function(l,p){return p.Name}},{title:"\u63CF\u8FF0",render:function(l,p){return p.Description||"--"}},{title:"\u5173\u952E\u8BCD",render:function(l,p){return p.MetaKeywords||"--"}},{title:"\u56FE\u7247",render:function(l,p){return p.Picture==null?null:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(o.Z,{data:[p.Picture]})})}},{title:"\u9996\u9875\u5C55\u793A",render:function(l,p){return(0,a.jsx)(v.Z,{status:p.ShowOnPublicPage?"success":"default"})}},{title:"\u72B6\u6001",render:function(l,p){return(0,a.jsxs)(a.Fragment,{children:[p.Published&&(0,a.jsx)(v.Z,{status:"success",text:"\u53EF\u7528"}),p.Published||(0,a.jsx)(v.Z,{status:"error",text:"\u4E0D\u53EF\u7528"})]})}},{title:"\u65F6\u95F4",render:function(l,p){return(0,a.jsx)(I.Z,{model:p})}},{title:"\u64CD\u4F5C",width:200,render:function(l,p){return(0,a.jsx)(M.ZP.Group,{children:(0,a.jsx)(M.ZP,{type:"link",onClick:function(){C(p)},children:"\u7F16\u8F91"})})}}];return(0,_.useEffect)(function(){Z()},[K]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(V,{show:F!=null,hide:function(){return C(void 0)},data:F||{},ok:function(){C(void 0),Z()}}),(0,a.jsx)(S,{query:K,onSearch:function(l){w(l)}}),(0,a.jsx)(A.Z,{title:"\u54C1\u724C",extra:(0,a.jsx)(M.ZP,{type:"primary",onClick:function(){C({})},children:"\u65B0\u589E"}),children:(0,a.jsx)(B.Z,{rowKey:function(l){return l.Id||""},loading:R,columns:k,dataSource:W.Items||[],pagination:{showSizeChanger:!1,pageSize:20,current:K.Page,total:W.TotalCount,onChange:function(l){w(n()(n()({},K),{},{Page:l}))}}})})]})}},55793:function(N,U,e){e.d(U,{$z:function(){return B},Ac:function(){return y},Vl:function(){return _},fn:function(){return D},ur:function(){return I}});var x=e(15009),n=e.n(x),f=e(99289),u=e.n(f),g=e(76857),v=e(95813),M=e(98005),A=e.n(M),B=function(){return["jpg","jpeg","png","gif"]},_=function(t){var s,c=((s=(0,v.mD)(t))===null||s===void 0?void 0:s.toLowerCase())||"";return B().indexOf(c)>=0},o=function(t,s,c,d){return new Promise(function(O,r){var m=new(A())(t,{maxHeight:s,maxWidth:c,quality:d,success:function(i){O(i)},error:function(i){r(i)}});console.log(m)})},I=function(){var E=u()(n()().mark(function t(s,c){var d,O,r,m;return n()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(s.size<=c)){i.next=2;break}return i.abrupt("return",s);case 2:return i.next=4,o(s,void 0,void 0,.9);case 4:if(s=i.sent,!(s.size<=c)){i.next=7;break}return i.abrupt("return",s);case 7:d=5,O=300,r=1e3,m=0;case 11:if(!(++m<=d)){i.next=22;break}return i.next=14,o(s,r,r,1);case 14:if(s=i.sent,!(s.size<=c)){i.next=17;break}return i.abrupt("return",s);case 17:if(r-=O,!(r<=0)){i.next=20;break}return i.abrupt("break",22);case 20:i.next=11;break;case 22:return i.abrupt("return",s);case 23:case"end":return i.stop()}},t)}));return function(s,c){return E.apply(this,arguments)}}(),D=function(){var E=u()(n()().mark(function t(s){var c,d;return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,b([s]);case 2:if(c=r.sent,d=c.at(0),d){r.next=6;break}throw new Error("response error");case 6:return r.abrupt("return",d);case 7:case"end":return r.stop()}},t)}));return function(s){return E.apply(this,arguments)}}(),b=function(){var E=u()(n()().mark(function t(s){var c,d;return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return c=new FormData,s.forEach(function(m,j){c.append("formFileCollection",m,m.name)}),r.next=4,g.M.post("/api/platform/storage/upload",c);case 4:if(d=r.sent,!d.data.Error){r.next=7;break}throw new Error(d.data.Error.Message||"upload error");case 7:return r.abrupt("return",d.data.Data||[]);case 8:case"end":return r.stop()}},t)}));return function(s){return E.apply(this,arguments)}}(),y=function(t){return new Promise(function(s,c){var d=new FileReader;d.onload=function(){s(d.result)},d.onerror=function(O){c(O)},d.readAsDataURL(t)})}}}]);

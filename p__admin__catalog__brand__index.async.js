"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4563],{74590:function(z,I,e){var x=e(15009),n=e.n(x),c=e(99289),u=e.n(c),g=e(5574),v=e.n(g),O=e(83062),U=e(14726),A=e(67294),t=e(85893);I.Z=function(_){var T=_.action,P=_.confirmText,B=_.hide,y=(0,A.useState)(!1),E=v()(y,2),l=E[0],s=E[1],m=P||"\u786E\u5B9A\u5220\u9664\uFF1F",d=function(){var j=u()(n()().mark(function r(){return n()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(confirm(m)){C.next=2;break}return C.abrupt("return");case 2:return s(!0),C.prev=3,C.next=6,T();case 6:return C.prev=6,s(!1),C.finish(6);case 9:case"end":return C.stop()}},r,null,[[3,,6,9]])}));return function(){return j.apply(this,arguments)}}();return B?null:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(O.Z,{title:m,children:(0,t.jsx)(U.ZP,{loading:l,danger:!0,type:"link",onClick:function(){d()},children:"\u5220\u9664"})})})}},93338:function(z,I,e){var x=e(97857),n=e.n(x),c=e(15009),u=e.n(c),g=e(99289),v=e.n(g),O=e(82052),U=e(68421),A=e(9383),t=e(67294),_=e(85893);I.Z=function(T){var P=T.width,B=T.rate,y=(0,t.useRef)(null),E=(0,O.Z)(y),l=E==null?void 0:E.width,s=function(){var d=v()(u()().mark(function j(){return u()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(B!=null&&l!=null)){o.next=2;break}return o.abrupt("return",l*B);case 2:return o.abrupt("return",void 0);case 3:case"end":return o.stop()}},j)}));return function(){return d.apply(this,arguments)}}(),m=(0,U.Z)(s,{manual:!0,debounceWait:30});return(0,t.useEffect)(function(){m.run()},[l]),(0,_.jsx)("div",{ref:y,style:{display:"block",padding:0,margin:0,width:P!=null?P:"100%"},children:(0,_.jsx)(A.J,n()({width:l||void 0,height:m.data||void 0,radius:"none"},T))})}},48382:function(z,I,e){var x=e(5574),n=e.n(x),c=e(98163),u=e(7134),g=e(55241),v=e(67294),O=e(35291),U=e(66419),A=e(93338),t=e(85893);I.Z=function(_){var T=_.data,P=_.count,B=(0,v.useState)(void 0),y=n()(B,2),E=y[0],l=y[1],s=T||[],m=P||3,d=s.map(function(r){return(0,O.u2)(r)}),j=function(o){return(0,t.jsx)("div",{style:{maxWidth:500},children:(0,t.jsx)(A.Z,{src:o.small||"",alt:""})})};return(0,U.G5)(d)?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{display:"none"},children:(0,t.jsx)(c.Z.PreviewGroup,{preview:{current:Math.max(E||0,0),visible:E!=null,onVisibleChange:function(o,C,f){l(o?f:void 0)},onChange:function(o){E!=null&&l(o)}},children:d.map(function(r,o){return(0,t.jsx)(c.Z,{src:r.large||"",alt:""},o)})})}),(0,t.jsx)("div",{style:{},children:(0,t.jsx)(u.C.Group,{maxCount:m,shape:"square",children:d.map(function(r,o){return(0,t.jsx)(g.Z,{title:"\u9884\u89C8",content:j(r),placement:"left",children:(0,t.jsx)(u.C,{style:{backgroundColor:"gray"},src:r.small||"",size:"large",onClick:function(){l(o)}})},o)})})})]})}},23806:function(z,I,e){var x=e(1288),n=e(85893);I.Z=function(c){var u=c.model,g=c.fallback;if(u==null||u==null)return null;var v=u==null?void 0:u.CreationTime,O=u==null?void 0:u.LastModificationTime;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{style:{},children:[(0,n.jsx)("div",{children:(0,n.jsx)(x.Z,{prefix:(0,n.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:v,fallback:g})}),(0,n.jsx)("div",{children:(0,n.jsx)(x.Z,{prefix:(0,n.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:O,fallback:g})})]})})}},1288:function(z,I,e){var x=e(78957),n=e(83062),c=e(46629),u=e(85893);I.Z=function(g){var v,O=g.timeStr,U=g.fallback,A=g.onlyDate,t=g.prefix,_=(v=(0,c.mg)(O))===null||v===void 0?void 0:v.add(c.Mg,"hour");if(!_)return U||null;var T=(0,c.ND)().utc().add(c.Mg,"hour"),P=_.isSame(T,"year"),B=_.diff(T,"day"),y=P?_.format(c.AK):_.format(c.vc),E=function(){return(0,u.jsxs)("div",{children:[(0,u.jsxs)(x.Z,{direction:"horizontal",children:[(0,u.jsx)("div",{children:_.fromNow()}),(0,u.jsx)("div",{children:_.format(c.On)})]}),(0,u.jsx)("div",{children:_.format(c.t9)})]})};return(0,u.jsx)(n.Z,{title:E(),children:(0,u.jsxs)(x.Z,{direction:"horizontal",children:[t,(0,u.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:A?_.format(c.vc):_.format(c.dq)})]})})}},8045:function(z,I,e){var x=e(97857),n=e.n(x),c=e(14726),u=e(67294),g=e(85893);I.Z=function(v){var O=v.loading,U=v.inputProps,A=v.onSelect,t=v.uploadButtonProps,_=(0,u.useRef)(null);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:{display:"none"},children:(0,g.jsx)("input",n()(n()({ref:_,type:"file",multiple:!1},U),{},{onChange:function(P){try{var B=P.target.files;B&&A&&A(B)}finally{_.current&&(_.current.value="",_.current.files=null)}}}))}),(0,g.jsx)(c.ZP,n()(n()({size:"small",loading:O,type:"dashed"},t),{},{onClick:function(){var P;(P=_.current)===null||P===void 0||P.click()},children:"\u9009\u62E9\u56FE\u7247"}))]})}},6786:function(z,I,e){var x=e(15009),n=e.n(x),c=e(99289),u=e.n(c),g=e(97857),v=e.n(g),O=e(98163),U=e(45360),A=e(14726),t=e(78957),_=e(85134),T=e(55932),P=e(55793),B=e(66419),y=e(8045),E=e(68421),l=e(85893);I.Z=function(s){var m=s.data,d=s.ok,j=s.remove,r=s.loadingSave,o=s.width,C=s.defaultImage,f=s.imageProps,J=s.uploadButtonProps,$=s.removeButtonProps,a=(0,T.Kk)(m,{width:o||100}),Q=function(){var b=a||C;return(0,B.Wq)(b)?null:(0,l.jsx)(O.Z,v()({src:b||"",alt:"",width:o||50},f))},X=function(){var W=u()(n()().mark(function b(R){var K;return n()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(D.prev=0,(0,P.Or)(R.name)){D.next=4;break}return U.ZP.error("\u53EA\u652F\u6301 ".concat((0,P.MU)().join("\u3001")," \u683C\u5F0F\u7684\u56FE\u7247")),D.abrupt("return");case 4:return D.next=6,(0,P.yE)(R,_.v.upload.maxSize);case 6:if(R=D.sent,!(R.size>_.v.upload.maxSize)){D.next=10;break}return U.ZP.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC71MB"),D.abrupt("return");case 10:return D.next=12,(0,P.ku)(R);case 12:K=D.sent,K&&d&&d(K),D.next=20;break;case 16:D.prev=16,D.t0=D.catch(0),console.log(D.t0),U.ZP.error("\u4E0A\u4F20\u9047\u5230\u9519\u8BEF");case 20:case"end":return D.stop()}},b,null,[[0,16]])}));return function(R){return W.apply(this,arguments)}}(),H=(0,E.Z)(X,{manual:!0}),Y=function(){return(0,B.Wq)(a)||!j?null:(0,l.jsx)(A.ZP,v()(v()({size:"small",type:"dashed",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&j&&j()}},$),{},{children:"\u79FB\u9664\u56FE\u7247"}))};return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(t.Z,{direction:"horizontal",children:[Q(),(0,l.jsxs)(t.Z,{direction:"vertical",children:[(0,l.jsx)(y.Z,{loading:r||H.loading,inputProps:{accept:"image/*",multiple:!1},onSelect:function(b){var R=b.item(0);R&&H.run(R)},uploadButtonProps:J}),Y()]})]})})}},60951:function(z,I,e){e.r(I),e.d(I,{default:function(){return Y}});var x=e(97857),n=e.n(x),c=e(5574),u=e.n(c),g=e(68421),v=e(40411),O=e(14726),U=e(4393),A=e(80799),t=e(67294),_=e(48382),T=e(23806),P=e(30699),B=e(15009),y=e.n(B),E=e(99289),l=e.n(E),s=e(45360),m=e(85576),d=e(78957),j=e(57381),r=e(11346),o=e(25278),C=e(72269),f=e(74590),J=e(6786),$=e(66419),a=e(85893),Q=function(W){var b=W.show,R=W.hide,K=W.data,G=W.ok,D=(0,t.useState)(!1),L=u()(D,2),F=L[0],V=L[1],N=(0,t.useState)({}),S=u()(N,2),p=S[0],Z=S[1],k=function(i){var M;i.Name=(M=i.Name)===null||M===void 0?void 0:M.trim(),!(0,$.Wq)(i.Name)&&(V(!0),P.x1.mallAdmin.brandSaveBrand(n()({},i)).then(function(w){w.data.Error?s.ZP.error(w.data.Error.Message):(s.ZP.success("\u4FDD\u5B58\u6210\u529F"),G())}).finally(function(){V(!1)}))};return(0,t.useEffect)(function(){Z(n()({},K))},[K]),(0,t.useEffect)(function(){b||Z({})},[b]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(m.Z,{title:"\u54C1\u724C",open:b,onCancel:function(){return R()},footer:(0,a.jsxs)(d.Z,{children:[(0,a.jsx)(f.Z,{action:l()(y()().mark(function h(){var i;return y()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,P.x1.mallAdmin.brandDelete({Id:p.Id});case 2:i=w.sent,(0,$._y)(i,function(){R(),G()});case 4:case"end":return w.stop()}},h)})),hide:(0,$.Wq)(p.Id)}),(0,a.jsx)(O.ZP,{type:"primary",loading:F,onClick:function(){k(p)},children:"\u4FDD\u5B58"})]}),children:(0,a.jsx)(j.Z,{spinning:F,children:(0,a.jsxs)(r.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,a.jsx)(r.Z.Item,{label:"\u56FE\u7247",children:(0,a.jsx)(J.Z,{loadingSave:F,data:p.Picture||{},ok:function(i){Z(n()(n()({},p),{},{PictureMetaId:i.Id,Picture:i}))},remove:function(){confirm("\u786E\u5B9A\u5220\u9664\u56FE\u7247\u5417\uFF1F")&&Z(n()(n()({},p),{},{PictureMetaId:void 0,Picture:void 0}))}})}),(0,a.jsxs)(r.Z.Item,{label:"\u540D\u79F0",required:!0,children:[(0,a.jsx)(o.Z,{count:{show:!0,max:20},maxLength:20,value:p.Name||"",onChange:function(i){Z(n()(n()({},p),{},{Name:i.target.value}))}}),(0,$.Wq)(p.Name)&&(0,a.jsx)("p",{style:{color:"red"},children:"\u5FC5\u586B"})]}),(0,a.jsx)(r.Z.Item,{label:"\u63CF\u8FF0",rules:[{max:50}],children:(0,a.jsx)(o.Z.TextArea,{value:p.Description||"",onChange:function(i){Z(n()(n()({},p),{},{Description:i.target.value}))}})}),(0,a.jsx)(r.Z.Item,{label:"\u5173\u952E\u8BCD",rules:[{max:200}],children:(0,a.jsx)(o.Z.TextArea,{value:p.MetaKeywords||"",onChange:function(i){Z(n()(n()({},p),{},{MetaKeywords:i.target.value}))}})}),(0,a.jsx)(r.Z.Item,{label:"\u9996\u9875\u663E\u793A",children:(0,a.jsx)(C.Z,{checked:p.ShowOnPublicPage,onChange:function(i){Z(n()(n()({},p),{},{ShowOnPublicPage:i}))}})}),(0,a.jsx)(r.Z.Item,{label:"\u662F\u5426\u53D1\u5E03",children:(0,a.jsx)(C.Z,{checked:p.Published,onChange:function(i){Z(n()(n()({},p),{},{Published:i}))}})})]})})})})},X=function(b){var R=b.query,K=b.onSearch,G=(0,t.useState)({}),D=u()(G,2),L=D[0],F=D[1],V=function(S){S.Page=1,K&&K(S)};return(0,t.useEffect)(function(){F(n()({},R||{}))},[R]),(0,a.jsx)(U.Z,{bordered:!1,style:{marginBottom:10},children:(0,a.jsxs)(r.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},autoComplete:"off",layout:"inline",children:[(0,a.jsx)(r.Z.Item,{label:"\u5173\u952E\u8BCD",children:(0,a.jsx)(o.Z,{value:L.Name||"",onChange:function(S){F(n()(n()({},L),{},{Name:S.target.value}))}})}),(0,a.jsx)(r.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsx)(O.ZP,{type:"primary",htmlType:"submit",onClick:function(){return V(L)},children:"\u641C\u7D22"})})]})})},H=X,Y=function(){var W,b=(0,g.Z)(P.x1.mallAdmin.brandQueryPaging,{manual:!0}),R=b.loading,K=((W=b.data)===null||W===void 0?void 0:W.data)||{},G=(0,t.useState)({Page:1}),D=u()(G,2),L=D[0],F=D[1],V=(0,t.useState)(void 0),N=u()(V,2),S=N[0],p=N[1],Z=function(){b.run(n()({},L))},k=[{title:"\u540D\u79F0",render:function(i,M){return M.Name}},{title:"\u63CF\u8FF0",render:function(i,M){return M.Description||"--"}},{title:"\u5173\u952E\u8BCD",render:function(i,M){return M.MetaKeywords||"--"}},{title:"\u56FE\u7247",render:function(i,M){return M.Picture==null?null:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(_.Z,{data:[M.Picture]})})}},{title:"\u9996\u9875\u5C55\u793A",render:function(i,M){return(0,a.jsx)(v.Z,{status:M.ShowOnPublicPage?"success":"default"})}},{title:"\u72B6\u6001",render:function(i,M){return(0,a.jsxs)(a.Fragment,{children:[M.Published&&(0,a.jsx)(v.Z,{status:"success",text:"\u53EF\u7528"}),M.Published||(0,a.jsx)(v.Z,{status:"error",text:"\u4E0D\u53EF\u7528"})]})}},{title:"\u65F6\u95F4",render:function(i,M){return(0,a.jsx)(T.Z,{model:M})}},{title:"\u64CD\u4F5C",width:200,render:function(i,M){return(0,a.jsx)(O.ZP.Group,{children:(0,a.jsx)(O.ZP,{type:"link",onClick:function(){p(M)},children:"\u7F16\u8F91"})})}}];return(0,t.useEffect)(function(){Z()},[L]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Q,{show:S!=null,hide:function(){return p(void 0)},data:S||{},ok:function(){p(void 0),Z()}}),(0,a.jsx)(H,{query:L,onSearch:function(i){F(i)}}),(0,a.jsx)(U.Z,{title:"\u54C1\u724C",extra:(0,a.jsx)(O.ZP,{type:"primary",onClick:function(){p({})},children:"\u65B0\u589E"}),children:(0,a.jsx)(A.Z,{rowKey:function(i){return i.Id||""},loading:R,columns:k,dataSource:K.Items||[],pagination:{showSizeChanger:!1,pageSize:20,current:L.Page,total:K.TotalCount,onChange:function(i){F(n()(n()({},L),{},{Page:i}))}}})})]})}},55793:function(z,I,e){e.d(I,{MU:function(){return A},Or:function(){return t},jP:function(){return y},ku:function(){return P},yE:function(){return T}});var x=e(15009),n=e.n(x),c=e(99289),u=e.n(c),g=e(76857),v=e(66419),O=e(98005),U=e.n(O),A=function(){return["jpg","jpeg","png","gif"]},t=function(l){var s,m=((s=(0,v.mD)(l))===null||s===void 0?void 0:s.toLowerCase())||"";return A().indexOf(m)>=0},_=function(l,s,m,d){return new Promise(function(j,r){var o=new(U())(l,{maxHeight:s,maxWidth:m,quality:d,success:function(f){j(f)},error:function(f){r(f)}});console.log(o)})},T=function(){var E=u()(n()().mark(function l(s,m){var d,j,r,o;return n()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(s.size<=m)){f.next=2;break}return f.abrupt("return",s);case 2:return f.next=4,_(s,void 0,void 0,.9);case 4:if(s=f.sent,!(s.size<=m)){f.next=7;break}return f.abrupt("return",s);case 7:d=5,j=300,r=1e3,o=0;case 11:if(!(++o<=d)){f.next=22;break}return f.next=14,_(s,r,r,1);case 14:if(s=f.sent,!(s.size<=m)){f.next=17;break}return f.abrupt("return",s);case 17:if(r-=j,!(r<=0)){f.next=20;break}return f.abrupt("break",22);case 20:f.next=11;break;case 22:return f.abrupt("return",s);case 23:case"end":return f.stop()}},l)}));return function(s,m){return E.apply(this,arguments)}}(),P=function(){var E=u()(n()().mark(function l(s){var m,d;return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,B([s]);case 2:if(m=r.sent,d=m.at(0),d){r.next=6;break}throw new Error("response error");case 6:return r.abrupt("return",d);case 7:case"end":return r.stop()}},l)}));return function(s){return E.apply(this,arguments)}}(),B=function(){var E=u()(n()().mark(function l(s){var m,d;return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return m=new FormData,s.forEach(function(o,C){m.append("formFileCollection",o,o.name)}),r.next=4,g.M.post("/api/platform/storage/upload",m);case 4:if(d=r.sent,!d.data.Error){r.next=7;break}throw new Error(d.data.Error.Message||"upload error");case 7:return r.abrupt("return",d.data.Data||[]);case 8:case"end":return r.stop()}},l)}));return function(s){return E.apply(this,arguments)}}(),y=function(l){return new Promise(function(s,m){var d=new FileReader;d.onload=function(){s(d.result)},d.onerror=function(j){m(j)},d.readAsDataURL(l)})}}}]);

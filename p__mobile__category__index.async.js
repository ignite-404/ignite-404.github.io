"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4547],{33816:function(G,f,e){var C=e(70025),a=e(85893);f.Z=function(l){var u=l.open,t=l.onClose,P=l.children;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(C.Z,{open:u,onClose:function(){t&&t()},pureBody:!0,showCloseButton:!0,children:P})})}},70025:function(G,f,e){var C=e(97857),a=e.n(C),l=e(86597),u=e(38787),t=e(94087),P=e(78967),m=e(87740),i=e(96476),A=e(77373),d=e(85893);f.Z=function(h){var L=h.open,r=h.onClose,z=h.children,W=h.title,p=h.action,c=h.pureBody,x=h.showCloseButton,o=h.bodyStyle,s=h.props,R=function(){return c?z:(0,d.jsx)(l.I,{style:o,children:(0,d.jsx)("div",{style:{minHeight:300},children:z})})},O=function(){return x?(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{style:{position:"relative"},children:(0,d.jsx)("div",{style:{position:"absolute",display:"inline",right:"20px",top:"20px",zIndex:1},children:(0,d.jsx)(u.A,{isIconOnly:!0,size:"sm",radius:"full",color:"danger",onClick:function(){r&&r()},children:(0,d.jsx)(A.Z,{stroke:1})})})})}):null};return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(t.R,a()(a()({className:"overflow-hidden",backdrop:"blur",isOpen:L,onClose:r,hideCloseButton:!0,isDismissable:!0,scrollBehavior:"outside"},s),{},{children:(0,d.jsx)(P.A,{children:function(){return(0,d.jsxs)(d.Fragment,{children:[O(),W==null||(0,d.jsx)(m.k,{className:"flex flex-col gap-1",children:W}),R(),p&&(0,d.jsx)(i.R,{children:p})]})}})}))})}},64080:function(G,f,e){var C=e(21274),a=e(85893);f.Z=function(l){var u=l.loading,t=l.hasMore;return u?(0,a.jsx)(C.Z,{}):t?null:(0,a.jsx)("div",{className:"flex flex-row items-center justify-center gap-2",children:(0,a.jsx)("span",{className:"text-slate-400",children:"\u6CA1\u6709\u66F4\u591A\u4E86"})})}},4303:function(G,f,e){e.d(f,{Z:function(){return t}});var C=e(33816),a=e(66419),l=e(44300),u=e(85893);function t(P){var m=P.detailId,i=P.onClose,A=!(0,a.Wq)(m);return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(C.Z,{open:A,onClose:i,children:m&&m.length>0&&(0,u.jsx)(l.Z,{goodsId:m})})})}},13386:function(G,f,e){e.d(f,{Z:function(){return W}});var C=e(97857),a=e.n(C),l=e(78957),u=e(84367),t=e(85893),P=function(p){var c,x=p.model;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(l.Z,{direction:"horizontal",split:(0,t.jsx)(u.j,{orientation:"vertical"}),children:[x.StickyTop&&(0,t.jsx)("span",{className:"inline text-slate-400",children:"\u7F6E\u9876"}),(c=x.Tags)===null||c===void 0?void 0:c.map(function(o,s){return(0,t.jsx)("span",{className:"inline text-slate-400",children:o.Name},s)})]})})},m=e(50209),i=e(66419),A=e(12241),d=e(45837),h=e(19314),L=e(67294),r=e(35291),z=e(93338);function W(p){var c=p.model,x=p.count,o=p.lazy;if((0,i.Wq)(c.Id))return null;var s=(0,L.useMemo)(function(){return(0,r.LK)(c,{width:250,height:250})},[c.GoodsPictures]);return c.Published?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(d.w,a()(a()({shadow:"none",className:"w-full p-0",isHoverable:!0,isPressable:!0},p),{},{children:(0,t.jsx)(h.G,{className:"overflow-hidden",children:(0,t.jsxs)("div",{className:"flex flex-row justify-start items-start gap-2",children:[(0,t.jsx)("div",{className:"xs:w-[120px] w-[120px] sm:w-[170px] md:w-[230px]",children:(0,t.jsx)(z.Z,{rate:3/3,radius:"sm",shadow:"none",isZoomed:!0,loading:o?"lazy":"eager",src:s||void 0,className:"object-cover",classNames:{img:"object-cover"},width:"100%",style:{width:"100%"},alt:""})}),(0,t.jsxs)("div",{className:"w-full flex-grow p-1 ml-0",children:[(0,t.jsx)("h5",{className:"mb-1 text-title",children:c.Name||"--"}),(0,t.jsx)(m.Z,{skus:c.Skus||[],count:x}),(0,i.Wq)(c.AdminComment)||(0,t.jsx)("div",{className:"text-overline",children:c.AdminComment||"--"}),(0,t.jsx)(P,{model:c})]})]})})}))}):(0,t.jsx)(A.Z,{model:c})}},50209:function(G,f,e){var C=e(71016),a=e(74715),l=e(85893);f.Z=function(u){var t=u.skus,P=u.count,m=P||1,i=t.length;return i<=0?(0,l.jsx)("div",{className:"font-mono text-sm font-light text-slate-400",children:"\u6682\u65E0\u53EF\u552E"}):(0,l.jsxs)(l.Fragment,{children:[(0,C.Z)(t,m).map(function(A,d){return(0,l.jsx)(a.Z,{model:A},d)}),i>m&&(0,l.jsx)("div",{className:"text-caption text-sm",children:"\u4E00\u5171".concat(i,"\u79CD\u6B3E\u5F0F")})]})}},74715:function(G,f,e){var C=e(37087),a=e(85893);f.Z=function(l){var u=l.model;return(0,a.jsxs)("div",{className:"flex-row-between",children:[(0,a.jsx)("span",{className:"text-caption",children:u.Name||"--"}),(0,a.jsx)("span",{className:"ml-1",children:(0,a.jsx)(C.Z,{model:u})})]})}},37085:function(G,f,e){e.d(f,{Z:function(){return c}});var C=e(5574),a=e.n(C),l=e(67294),u=e(38295),t=e(66419),P=e(38016),m=e(68421),i=e(66386),A=e(30699),d=e(70025),h=e(78957),L=e(84367),r=e(85893),z=function(x){var o=x.store,s=x.currentId;if(!o)return null;var R=o.Id==s,O=function(n){return(0,r.jsx)("span",{className:"text-sm font-light text-slate-400",children:n})};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"my-2 cursor-pointer overflow-hidden rounded-md border-1 border-gray-100 bg-gray-50 p-2 shadow-sm hover:border-gray-200",onClick:function(){confirm("\u786E\u5B9A\u9009\u62E9[".concat(o.Name,"]\u4F5C\u4E3A\u5F53\u524D\u95E8\u5E97\uFF1F"))&&((0,t.LW)(o.Id||""),window.location.reload())},children:(0,r.jsxs)(h.Z,{direction:"vertical",children:[(0,r.jsxs)(h.Z,{direction:"horizontal",children:[(0,r.jsx)("h6",{className:"mb-1",children:o.Name}),R&&(0,r.jsx)("span",{className:"text-red-400",children:"\u5F53\u524D\u9009\u62E9"})]}),(0,r.jsxs)(h.Z,{direction:"horizontal",split:(0,r.jsx)(L.j,{orientation:"vertical"}),children:[(0,t.Wq)(o.Telephone)||(0,r.jsx)("span",{className:"mb-1 text-sm font-light text-slate-400",children:o.Telephone}),(0,t.Wq)(o.AddressDetail)||(0,r.jsx)("span",{className:"mb-1 text-sm font-light text-slate-400",children:o.AddressDetail})]}),(0,r.jsxs)(h.Z,{direction:"horizontal",split:(0,r.jsx)(L.j,{orientation:"vertical"}),children:[o.Opening&&O("\u8425\u4E1A\u4E2D"),o.InvoiceSupported&&O("\u652F\u6301\u5F00\u53D1\u7968"),o.Distance&&o.Distance>0&&O("".concat((o.Distance/1e3).toFixed(2),"km")),o.InServiceArea!=null&&o.InServiceArea&&O("\u5728\u670D\u52A1\u8303\u56F4\u5185")]})]})})})},W=function(x){var o,s=x.show,R=x.close,O=(0,u.o)(),Z=(0,m.Z)(A.x1.mall.storeListStores,{manual:!0,onSuccess:function(D,K){(0,t._y)(D,function(){})}}),n=((o=Z.data)===null||o===void 0||(o=o.data)===null||o===void 0?void 0:o.Data)||[],Y=(0,m.Z)(t.MK,{manual:!0,onSuccess:function(D){console.log("\u5B9A\u4F4D\u7ED3\u679C",D);var K={Lat:D.coords.latitude,Lon:D.coords.longitude};Z.run({headers:{"x-location":JSON.stringify(K)}})},onError:function(D){var K;console.log(D),(K=t.iI.message)===null||K===void 0||K.error("\u5B9A\u4F4D\u5931\u8D25\uFF0C\u5C06\u5C55\u793A\u9ED8\u8BA4\u95E8\u5E97"),Z.run({})}});(0,l.useEffect)(function(){s&&(alert("\u8BF7\u5141\u8BB8\u6211\u4EEC\u901A\u8FC7\u60A8\u7684\u5B9A\u4F4D\u6765\u83B7\u53D6\u9644\u8FD1\u7684\u95E8\u5E97"),Y.run())},[s]);var b=function(){return Z.loading||Y.loading?(0,r.jsx)(i.Z,{}):(0,t.G5)(n)?(0,r.jsx)("h2",{children:"\u9644\u8FD1\u6CA1\u6709\u53EF\u9009\u95E8\u5E97"}):n==null?void 0:n.map(function(D,K){var Q;return(0,r.jsx)("div",{children:(0,r.jsx)(z,{currentId:(Q=O.currentStore)===null||Q===void 0?void 0:Q.Id,store:D})},K)})};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(d.Z,{open:s,onClose:function(){return R&&R()},title:"\u9644\u8FD1\u95E8\u5E97",children:b()})})},p=e(45991),c=function(){var x,o,s=(0,u.o)(),R=(0,m.Z)(s.queryCurrentStore,{manual:!0}),O=(0,m.Z)(s.queryMostNearbyStore,{manual:!0}),Z=(0,l.useState)(!1),n=a()(Z,2),Y=n[0],b=n[1];return(0,l.useEffect)(function(){var S,D;s.currentStore!=null&&(S=s.mostNearbyStore)!==null&&S!==void 0&&S.Id&&s.mostNearbyStore.Id!=((D=s.currentStore)===null||D===void 0?void 0:D.Id)&&(confirm("\u662F\u5426\u5207\u6362\u5230\u9644\u8FD1\u7684\u95E8\u5E97\uFF1A[".concat(s.mostNearbyStore.Id,"]"))?((0,t.LW)(s.mostNearbyStore.Id||""),setTimeout(function(){window.location.reload()},500)):s.mostNearbyStore=void 0)},[s.mostNearbyStore,s.currentStore]),(0,l.useEffect)(function(){R.run(),s.mostNearbyStore==null&&O.run()},[]),(0,l.useEffect)(function(){var S;(S=s.currentStore)!==null&&S!==void 0&&S.Id&&!s.currentStore.Opening&&confirm("\u5F53\u524D\u95E8\u5E97[".concat(s.currentStore.Name||"--","]\u5DF2\u7ECF\u95ED\u5E97\uFF0C\u662F\u5426\u66F4\u6362\u95E8\u5E97"))&&b(!0)},[s.currentStore]),R.loading||O.loading?(0,r.jsx)("span",{children:"..."}):(x=s.currentStore)!==null&&x!==void 0&&x.Id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(W,{show:Y,close:function(){b(!1)}}),(0,r.jsx)(P.e,{content:"\u9009\u62E9\u95E8\u5E97",showArrow:!0,color:"warning",children:(0,r.jsxs)("div",{className:"flex-row-center gap-1 cursor-pointer",children:[(0,r.jsx)(p.Z,{stroke:1,size:20}),(0,r.jsx)("span",{className:"text-overline m-0 p-0",onClick:function(){b(!0)},children:((o=s.currentStore)===null||o===void 0?void 0:o.Name)||"--"})]})})]}):(0,r.jsx)("span",{children:"\u65E0\u95E8\u5E97\u4FE1\u606F"})}},22163:function(G,f,e){e.r(f),e.d(f,{default:function(){return ve}});var C=e(5574),a=e.n(C),l=e(84179),u=e(82052),t=e(68421),P=e(35195),m=e(38018),i=e(67294),A=e(93338),d=e(21274),h=e(38295),L=e(30699),r=e(55932),z=e(47650),W=e(66419),p=e(15009),c=e.n(p),x=e(99289),o=e.n(x),s=e(68770),R=e(64080),O=e(13386),Z=e(4303),n=e(85893);function Y(j){var g=j.categoryId,y=(0,i.useState)(void 0),N=a()(y,2),E=N[0],I=N[1],M=(0,s.Z)(function(){var $=o()(c()().mark(function T(U){var F,J;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(0,W.Wq)(g)){v.next=2;break}return v.abrupt("return",{list:[]});case 2:return v.next=4,L.x1.mall.searchSearchGoodsList({CategoryId:g,Page:((U==null||(F=U.res)===null||F===void 0?void 0:F.PageIndex)||0)+1});case 4:return J=v.sent,v.abrupt("return",{list:J.data.Items||[],res:J.data});case 6:case"end":return v.stop()}},T)}));return function(T){return $.apply(this,arguments)}}(),{reloadDeps:[g],target:window.document,isNoMore:function(T){var U;return(T==null||(U=T.res)===null||U===void 0?void 0:U.IsEmpty)||!1}}),V=M.loading,H=M.data,B=M.noMore,w=M.loadingMore,ee=M.loadMore,k=M.reload,ne=M.mutate,_=(H==null?void 0:H.list)||[];return(0,i.useEffect)(function(){ne({list:[]})},[g]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.Z,{detailId:E,onClose:function(){I(void 0)}}),(0,n.jsxs)("div",{style:{},children:[_==null?void 0:_.map(function($,T){return(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)(O.Z,{model:$,count:2,lazy:!0,onClick:function(){I($.Id)}})},T)}),(0,n.jsx)(R.Z,{loading:V||w,hasMore:!B})]})]})}var b=e(37085),S=e(13129),D=e(15142),K=e(45336),Q=e(79479),te=e(7311),re=e(38787);function se(j){var g=j.children,y=(0,h.o)(),N=(0,i.useRef)(null),E=(0,u.Z)(N),I=(0,i.useState)(0),M=a()(I,2),V=M[0],H=M[1];return(0,i.useEffect)(function(){V?y.headerHeight=0:y.headerHeight=(E==null?void 0:E.height)||0},[E,V]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(D.R,{ref:N,maxWidth:"lg",isBlurred:!0,position:"static",children:[(0,n.jsx)(K.H,{children:(0,n.jsx)(b.Z,{})}),(0,n.jsx)(Q.U,{justify:"center",children:(0,n.jsx)(te.k,{children:(0,n.jsx)("h6",{className:"text-title",children:window.document.title||y.getAppName()})})}),(0,n.jsx)(Q.U,{justify:"end",children:(0,n.jsx)(te.k,{children:(0,n.jsx)(re.A,{isIconOnly:!0,variant:"light",onClick:function(){z.m8.push({pathname:"/search"})},children:(0,n.jsx)(S.Z,{stroke:1})})})})]}),(0,n.jsx)("div",{style:{marginTop:"".concat(10,"px")},children:g})]})}var ae=function(j){var g,y=j.model,N=j.onSubCategorySelect,E=j.selectedSubCategoryId,I=(0,t.Z)(L.x1.mall.categoryByParent,{manual:!0}),M=((g=I.data)===null||g===void 0||(g=g.data)===null||g===void 0?void 0:g.Data)||[];(0,i.useEffect)(function(){I.mutate(),y&&y.Id&&I.run({Id:y.Id})},[y]);var V=function(){return I.loading?(0,n.jsx)(d.Z,{}):M.length<=0?null:(0,n.jsx)(n.Fragment,{children:M.map(function(B,w){return(0,n.jsx)(re.A,{className:"mb-1 mr-1",variant:E==B.Id?"solid":"flat",color:"primary",size:"sm",onClick:function(){B.Id!=E?N(B.Id):N(void 0)},children:B.Name||"--"},w)})})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"mb-3 p-1",children:[(0,n.jsx)("div",{className:"text-title mb-1",children:y.Name||"--"}),(0,W.Wq)(y.Description)||(0,n.jsx)("p",{className:"text-caption mb-1",children:y.Description}),V()]})})},le=e(93522),ie=e(29505),ue=e(39278);function de(j){var g=j.selectedId,y=j.onSelect,N=j.data;return!N||N.length<=0?null:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(le.n,{isVertical:!0,variant:"light",size:"sm",selectedKey:g||void 0,onSelectionChange:function(I){y(I)},children:N.map(function(E,I){return(0,n.jsx)(ie.r,{title:(0,n.jsx)(ue.O,{content:"",color:"danger",shape:"circle",isInvisible:!E.Recommend,children:(0,n.jsx)("span",{children:E.Name})})},E.Id)})})})}var ce=e(81239);function ve(){var j;(0,l.Z)("\u7C7B\u76EE");var g=(0,h.o)(),y=(0,z.TH)(),N=(0,i.useRef)(null),E=(0,u.Z)(N),I=(0,i.useRef)(null),M=(0,u.Z)(window.document.body),V=(0,i.useMemo)(function(){var v;return((v=I.current)===null||v===void 0?void 0:v.getBoundingClientRect().left)||0},[M,I]),H=(0,t.Z)(L.x1.mall.categoryStoreRootCategory,{manual:!0}),B=((j=H.data)===null||j===void 0||(j=j.data)===null||j===void 0?void 0:j.Data)||[],w=(0,i.useState)(void 0),ee=a()(w,2),k=ee[0],ne=ee[1],_=(0,i.useState)(void 0),$=a()(_,2),T=$[0],U=$[1],F=B.find(function(v){return v.Id==k}),J=T||k;(0,i.useEffect)(function(){var v,X=(v=m.parse(y.search))===null||v===void 0?void 0:v.cat,q=(0,P.Z)(B,function(me){return me.Id==X?-1:0}).at(0);q&&q.Id!=k&&ne(q==null?void 0:q.Id)},[B]),(0,i.useEffect)(function(){H.run({})},[]),(0,i.useEffect)(function(){window&&window.scrollTo({top:0,left:0})},[J]);var oe=function(){var X=(0,r.Kk)(F==null?void 0:F.Picture,{width:300});return X?(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)(A.Z,{src:X,alt:(F==null?void 0:F.Name)||"",className:"object-contain",width:"100%"})}):null};return H.loading?(0,n.jsx)(d.Z,{}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(se,{children:(0,n.jsxs)("div",{ref:I,className:"container max-w-lg",children:[(0,n.jsx)("div",{ref:N,style:{position:"fixed",top:g.headerHeight,bottom:g.bottomHeight,left:V,overflow:"hidden",zIndex:1},children:(0,n.jsx)(ce.o,{hideScrollBar:!0,className:"w-full h-full",children:(0,n.jsx)(de,{selectedId:k||void 0,data:B,onSelect:function(X){ne(X)}})})}),(0,n.jsxs)("div",{style:{marginLeft:"".concat(((E==null?void 0:E.width)||0)+10,"px")},children:[oe(),F==null||(0,n.jsx)(ae,{model:F,selectedSubCategoryId:T,onSubCategorySelect:function(X){U(X)}}),(0,W.Wq)(J)||(0,n.jsx)(Y,{categoryId:J})]})]})})})}}}]);

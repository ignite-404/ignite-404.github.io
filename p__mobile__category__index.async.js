"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4547],{50112:function(G,h,e){var E=e(21274),a=e(85893);h.Z=function(l){var d=l.loading,t=l.hasMore;return d?(0,a.jsx)(E.Z,{}):t?null:(0,a.jsx)("div",{className:"flex flex-row items-center justify-center gap-2",children:(0,a.jsx)("span",{className:"text-slate-400",children:"\u6CA1\u6709\u66F4\u591A\u4E86"})})}},78739:function(G,h,e){e.d(h,{Z:function(){return t}});var E=e(43937),a=e(66419),l=e(44300),d=e(85893);function t(P){var C=P.detailId,i=P.onClose,A=!(0,a.Wq)(C);return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(E.Z,{open:A,onClose:i,children:(0,d.jsx)(l.Z,{goodsId:C})})})}},13386:function(G,h,e){e.d(h,{Z:function(){return W}});var E=e(97857),a=e.n(E),l=e(78957),d=e(84367),t=e(85893),P=function(p){var c,f=p.model;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(l.Z,{direction:"horizontal",split:(0,t.jsx)(d.j,{orientation:"vertical"}),children:[f.StickyTop&&(0,t.jsx)("span",{className:"inline text-slate-400",children:"\u7F6E\u9876"}),(c=f.Tags)===null||c===void 0?void 0:c.map(function(o,s){return(0,t.jsx)("span",{className:"inline text-slate-400",children:o.Name},s)})]})})},C=e(50209),i=e(66419),A=e(12241),u=e(45837),m=e(19314),L=e(67294),r=e(35291),z=e(94442);function W(p){var c=p.model,f=p.count,o=p.lazy;if((0,i.Wq)(c.Id))return null;var s=(0,L.useMemo)(function(){return(0,r.LK)(c,{width:250,height:250})},[c.GoodsPictures]);return c.Published?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(u.w,a()(a()({shadow:"none",className:"w-full p-0",isHoverable:!0,isPressable:!0},p),{},{children:(0,t.jsx)(m.G,{className:"overflow-hidden",children:(0,t.jsxs)("div",{className:"flex flex-row justify-start items-start gap-2",children:[(0,t.jsx)("div",{className:"xs:w-[120px] w-[120px] sm:w-[170px] md:w-[230px]",children:(0,t.jsx)(z.Z,{rate:3/3,radius:"sm",shadow:"none",isZoomed:!0,loading:o?"lazy":"eager",src:s||void 0,className:"object-cover",classNames:{img:"object-cover"},width:"100%",style:{width:"100%"},alt:""})}),(0,t.jsxs)("div",{className:"w-full flex-grow p-1 ml-0",children:[(0,t.jsx)("h5",{className:"mb-1 text-title",children:c.Name||"--"}),(0,t.jsx)(C.Z,{skus:c.Skus||[],count:f}),(0,i.Wq)(c.AdminComment)||(0,t.jsx)("div",{className:"text-overline",children:c.AdminComment||"--"}),(0,t.jsx)(P,{model:c})]})]})})}))}):(0,t.jsx)(A.Z,{model:c})}},50209:function(G,h,e){var E=e(71016),a=e(74715),l=e(85893);h.Z=function(d){var t=d.skus,P=d.count,C=P||1,i=t.length;return i<=0?(0,l.jsx)("div",{className:"font-mono text-sm font-light text-slate-400",children:"\u6682\u65E0\u53EF\u552E"}):(0,l.jsxs)(l.Fragment,{children:[(0,E.Z)(t,C).map(function(A,u){return(0,l.jsx)(a.Z,{model:A},u)}),i>C&&(0,l.jsx)("div",{className:"text-caption text-sm",children:"\u4E00\u5171".concat(i,"\u79CD\u6B3E\u5F0F")})]})}},74715:function(G,h,e){var E=e(37087),a=e(85893);h.Z=function(l){var d=l.model;return(0,a.jsxs)("div",{className:"flex-row-between",children:[(0,a.jsx)("span",{className:"text-caption",children:d.Name||"--"}),(0,a.jsx)("span",{className:"ml-1",children:(0,a.jsx)(E.Z,{model:d})})]})}},37085:function(G,h,e){e.d(h,{Z:function(){return c}});var E=e(5574),a=e.n(E),l=e(67294),d=e(38295),t=e(66419),P=e(38016),C=e(68421),i=e(66386),A=e(30699),u=e(95564),m=e(78957),L=e(84367),r=e(85893),z=function(f){var o=f.store,s=f.currentId;if(!o)return null;var R=o.Id==s,O=function(n){return(0,r.jsx)("span",{className:"text-sm font-light text-slate-400",children:n})};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"my-2 cursor-pointer overflow-hidden rounded-md border-1 border-gray-100 bg-gray-50 p-2 shadow-sm hover:border-gray-200",onClick:function(){confirm("\u786E\u5B9A\u9009\u62E9[".concat(o.Name,"]\u4F5C\u4E3A\u5F53\u524D\u95E8\u5E97\uFF1F"))&&((0,t.LW)(o.Id||""),window.location.reload())},children:(0,r.jsxs)(m.Z,{direction:"vertical",children:[(0,r.jsxs)(m.Z,{direction:"horizontal",children:[(0,r.jsx)("h6",{className:"mb-1",children:o.Name}),R&&(0,r.jsx)("span",{className:"text-red-400",children:"\u5F53\u524D\u9009\u62E9"})]}),(0,r.jsxs)(m.Z,{direction:"horizontal",split:(0,r.jsx)(L.j,{orientation:"vertical"}),children:[(0,t.Wq)(o.Telephone)||(0,r.jsx)("span",{className:"mb-1 text-sm font-light text-slate-400",children:o.Telephone}),(0,t.Wq)(o.AddressDetail)||(0,r.jsx)("span",{className:"mb-1 text-sm font-light text-slate-400",children:o.AddressDetail})]}),(0,r.jsxs)(m.Z,{direction:"horizontal",split:(0,r.jsx)(L.j,{orientation:"vertical"}),children:[o.Opening&&O("\u8425\u4E1A\u4E2D"),o.InvoiceSupported&&O("\u652F\u6301\u5F00\u53D1\u7968"),o.Distance&&o.Distance>0&&O("".concat((o.Distance/1e3).toFixed(2),"km")),o.InServiceArea!=null&&o.InServiceArea&&O("\u5728\u670D\u52A1\u8303\u56F4\u5185")]})]})})})},W=function(f){var o,s=f.show,R=f.close,O=(0,d.o)(),Z=(0,C.Z)(A.x1.mall.storeListStores,{manual:!0,onSuccess:function(D,K){(0,t._y)(D,function(){})}}),n=((o=Z.data)===null||o===void 0||(o=o.data)===null||o===void 0?void 0:o.Data)||[],Y=(0,C.Z)(t.MK,{manual:!0,onSuccess:function(D){console.log("\u5B9A\u4F4D\u7ED3\u679C",D);var K={Lat:D.coords.latitude,Lon:D.coords.longitude};Z.run({headers:{"x-location":JSON.stringify(K)}})},onError:function(D){var K;console.log(D),(K=t.iI.message)===null||K===void 0||K.error("\u5B9A\u4F4D\u5931\u8D25\uFF0C\u5C06\u5C55\u793A\u9ED8\u8BA4\u95E8\u5E97"),Z.run({})}});(0,l.useEffect)(function(){s&&(alert("\u8BF7\u5141\u8BB8\u6211\u4EEC\u901A\u8FC7\u60A8\u7684\u5B9A\u4F4D\u6765\u83B7\u53D6\u9644\u8FD1\u7684\u95E8\u5E97"),Y.run())},[s]);var b=function(){return Z.loading||Y.loading?(0,r.jsx)(i.Z,{}):(0,t.G5)(n)?(0,r.jsx)("h2",{children:"\u9644\u8FD1\u6CA1\u6709\u53EF\u9009\u95E8\u5E97"}):n==null?void 0:n.map(function(D,K){var Q;return(0,r.jsx)("div",{children:(0,r.jsx)(z,{currentId:(Q=O.currentStore)===null||Q===void 0?void 0:Q.Id,store:D})},K)})};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(u.Z,{open:s,onClose:function(){return R&&R()},title:"\u9644\u8FD1\u95E8\u5E97",children:b()})})},p=e(45991),c=function(){var f,o,s=(0,d.o)(),R=(0,C.Z)(s.queryCurrentStore,{manual:!0}),O=(0,C.Z)(s.queryMostNearbyStore,{manual:!0}),Z=(0,l.useState)(!1),n=a()(Z,2),Y=n[0],b=n[1];return(0,l.useEffect)(function(){var S,D;s.currentStore!=null&&(S=s.mostNearbyStore)!==null&&S!==void 0&&S.Id&&s.mostNearbyStore.Id!=((D=s.currentStore)===null||D===void 0?void 0:D.Id)&&(confirm("\u662F\u5426\u5207\u6362\u5230\u9644\u8FD1\u7684\u95E8\u5E97\uFF1A[".concat(s.mostNearbyStore.Id,"]"))?((0,t.LW)(s.mostNearbyStore.Id||""),setTimeout(function(){window.location.reload()},500)):s.mostNearbyStore=void 0)},[s.mostNearbyStore,s.currentStore]),(0,l.useEffect)(function(){R.run(),s.mostNearbyStore==null&&O.run()},[]),(0,l.useEffect)(function(){var S;(S=s.currentStore)!==null&&S!==void 0&&S.Id&&!s.currentStore.Opening&&confirm("\u5F53\u524D\u95E8\u5E97[".concat(s.currentStore.Name||"--","]\u5DF2\u7ECF\u95ED\u5E97\uFF0C\u662F\u5426\u66F4\u6362\u95E8\u5E97"))&&b(!0)},[s.currentStore]),R.loading||O.loading?(0,r.jsx)("span",{children:"..."}):(f=s.currentStore)!==null&&f!==void 0&&f.Id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(W,{show:Y,close:function(){b(!1)}}),(0,r.jsx)(P.e,{content:"\u9009\u62E9\u95E8\u5E97",showArrow:!0,color:"warning",children:(0,r.jsxs)("div",{className:"flex-row-center gap-1 cursor-pointer",children:[(0,r.jsx)(p.Z,{stroke:1,size:20}),(0,r.jsx)("span",{className:"text-overline m-0 p-0",onClick:function(){b(!0)},children:((o=s.currentStore)===null||o===void 0?void 0:o.Name)||"--"})]})})]}):(0,r.jsx)("span",{children:"\u65E0\u95E8\u5E97\u4FE1\u606F"})}},43937:function(G,h,e){var E=e(95564),a=e(85893);h.Z=function(l){var d=l.open,t=l.onClose,P=l.children;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E.Z,{open:d,onClose:function(){t&&t()},props:{placement:"bottom"},pureBody:!0,showCloseButton:!0,children:P})})}},95564:function(G,h,e){var E=e(97857),a=e.n(E),l=e(86597),d=e(38787),t=e(94087),P=e(78967),C=e(87740),i=e(96476),A=e(77373),u=e(85893);h.Z=function(m){var L=m.open,r=m.onClose,z=m.children,W=m.title,p=m.action,c=m.pureBody,f=m.showCloseButton,o=m.bodyStyle,s=m.props,R=function(){return c?z:(0,u.jsx)(l.I,{style:o,children:(0,u.jsx)("div",{style:{minHeight:300},children:z})})},O=function(){return f?(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("div",{style:{position:"relative"},children:(0,u.jsx)("div",{style:{position:"absolute",display:"inline",right:"20px",top:"20px",zIndex:1},children:(0,u.jsx)(d.A,{isIconOnly:!0,size:"sm",radius:"full",color:"danger",onClick:function(){r&&r()},children:(0,u.jsx)(A.Z,{stroke:1})})})})}):null};return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(t.R,a()(a()({className:"overflow-hidden",backdrop:"blur",isOpen:L,onClose:r,hideCloseButton:!0,isDismissable:!0,scrollBehavior:"outside"},s),{},{children:(0,u.jsx)(P.A,{children:function(){return(0,u.jsxs)(u.Fragment,{children:[O(),W==null||(0,u.jsx)(C.k,{className:"flex flex-col gap-1",children:W}),R(),p&&(0,u.jsx)(i.R,{children:p})]})}})}))})}},22163:function(G,h,e){e.r(h),e.d(h,{default:function(){return ve}});var E=e(5574),a=e.n(E),l=e(84179),d=e(82052),t=e(68421),P=e(35195),C=e(38018),i=e(67294),A=e(94442),u=e(21274),m=e(38295),L=e(30699),r=e(55932),z=e(47650),W=e(66419),p=e(15009),c=e.n(p),f=e(99289),o=e.n(f),s=e(68770),R=e(50112),O=e(13386),Z=e(78739),n=e(85893);function Y(x){var j=x.categoryId,y=(0,i.useState)(void 0),N=a()(y,2),g=N[0],I=N[1],M=(0,s.Z)(function(){var $=o()(c()().mark(function T(U){var F,J;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(0,W.Wq)(j)){v.next=2;break}return v.abrupt("return",{list:[]});case 2:return v.next=4,L.x1.mall.searchSearchGoodsList({CategoryId:j,Page:((U==null||(F=U.res)===null||F===void 0?void 0:F.PageIndex)||0)+1});case 4:return J=v.sent,v.abrupt("return",{list:J.data.Items||[],res:J.data});case 6:case"end":return v.stop()}},T)}));return function(T){return $.apply(this,arguments)}}(),{reloadDeps:[j],target:window.document,isNoMore:function(T){var U;return(T==null||(U=T.res)===null||U===void 0?void 0:U.IsEmpty)||!1}}),V=M.loading,H=M.data,B=M.noMore,w=M.loadingMore,ee=M.loadMore,k=M.reload,ne=M.mutate,_=(H==null?void 0:H.list)||[];return(0,i.useEffect)(function(){ne({list:[]})},[j]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.Z,{detailId:g,onClose:function(){I(void 0)}}),(0,n.jsxs)("div",{style:{},children:[_==null?void 0:_.map(function($,T){return(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)(O.Z,{model:$,count:2,lazy:!0,onClick:function(){I($.Id)}})},T)}),(0,n.jsx)(R.Z,{loading:V||w,hasMore:!B})]})]})}var b=e(37085),S=e(13129),D=e(15142),K=e(45336),Q=e(79479),te=e(7311),re=e(38787);function se(x){var j=x.children,y=(0,m.o)(),N=(0,i.useRef)(null),g=(0,d.Z)(N),I=(0,i.useState)(0),M=a()(I,2),V=M[0],H=M[1];return(0,i.useEffect)(function(){V?y.headerHeight=0:y.headerHeight=(g==null?void 0:g.height)||0},[g,V]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(D.R,{ref:N,maxWidth:"lg",isBlurred:!0,position:"static",children:[(0,n.jsx)(K.H,{children:(0,n.jsx)(b.Z,{})}),(0,n.jsx)(Q.U,{justify:"center",children:(0,n.jsx)(te.k,{children:(0,n.jsx)("h6",{className:"text-title",children:window.document.title||y.getAppName()})})}),(0,n.jsx)(Q.U,{justify:"end",children:(0,n.jsx)(te.k,{children:(0,n.jsx)(re.A,{isIconOnly:!0,variant:"light",onClick:function(){z.m8.push({pathname:"/search"})},children:(0,n.jsx)(S.Z,{stroke:1})})})})]}),(0,n.jsx)("div",{style:{marginTop:"".concat(10,"px")},children:j})]})}var ae=function(x){var j,y=x.model,N=x.onSubCategorySelect,g=x.selectedSubCategoryId,I=(0,t.Z)(L.x1.mall.categoryByParent,{manual:!0}),M=((j=I.data)===null||j===void 0||(j=j.data)===null||j===void 0?void 0:j.Data)||[];(0,i.useEffect)(function(){I.mutate(),y&&y.Id&&I.run({Id:y.Id})},[y]);var V=function(){return I.loading?(0,n.jsx)(u.Z,{}):M.length<=0?null:(0,n.jsx)(n.Fragment,{children:M.map(function(B,w){return(0,n.jsx)(re.A,{className:"mb-1 mr-1",variant:g==B.Id?"solid":"flat",color:"primary",size:"sm",onClick:function(){B.Id!=g?N(B.Id):N(void 0)},children:B.Name||"--"},w)})})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"mb-3 p-1",children:[(0,n.jsx)("div",{className:"text-title mb-1",children:y.Name||"--"}),(0,W.Wq)(y.Description)||(0,n.jsx)("p",{className:"text-caption mb-1",children:y.Description}),V()]})})},le=e(93522),ie=e(29505),de=e(39278);function ue(x){var j=x.selectedId,y=x.onSelect,N=x.data;return!N||N.length<=0?null:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(le.n,{isVertical:!0,variant:"light",size:"sm",selectedKey:j||void 0,onSelectionChange:function(I){y(I)},children:N.map(function(g,I){return(0,n.jsx)(ie.r,{title:(0,n.jsx)(de.O,{content:"",color:"danger",shape:"circle",isInvisible:!g.Recommend,children:(0,n.jsx)("span",{children:g.Name})})},g.Id)})})})}var ce=e(81239);function ve(){var x;(0,l.Z)("\u7C7B\u76EE");var j=(0,m.o)(),y=(0,z.TH)(),N=(0,i.useRef)(null),g=(0,d.Z)(N),I=(0,i.useRef)(null),M=(0,d.Z)(window.document.body),V=(0,i.useMemo)(function(){var v;return((v=I.current)===null||v===void 0?void 0:v.getBoundingClientRect().left)||0},[M,I]),H=(0,t.Z)(L.x1.mall.categoryStoreRootCategory,{manual:!0}),B=((x=H.data)===null||x===void 0||(x=x.data)===null||x===void 0?void 0:x.Data)||[],w=(0,i.useState)(void 0),ee=a()(w,2),k=ee[0],ne=ee[1],_=(0,i.useState)(void 0),$=a()(_,2),T=$[0],U=$[1],F=B.find(function(v){return v.Id==k}),J=T||k;(0,i.useEffect)(function(){var v,X=(v=C.parse(y.search))===null||v===void 0?void 0:v.cat,q=(0,P.Z)(B,function(me){return me.Id==X?-1:0}).at(0);q&&q.Id!=k&&ne(q==null?void 0:q.Id)},[B]),(0,i.useEffect)(function(){H.run({})},[]),(0,i.useEffect)(function(){window&&window.scrollTo({top:0,left:0})},[J]);var oe=function(){var X=(0,r.Kk)(F==null?void 0:F.Picture,{width:300});return X?(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)(A.Z,{src:X,alt:(F==null?void 0:F.Name)||"",className:"object-contain",width:"100%"})}):null};return H.loading?(0,n.jsx)(u.Z,{}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(se,{children:(0,n.jsxs)("div",{ref:I,className:"container max-w-lg",children:[(0,n.jsx)("div",{ref:N,style:{position:"fixed",top:j.headerHeight,bottom:j.bottomHeight,left:V,overflow:"hidden",zIndex:1},children:(0,n.jsx)(ce.o,{hideScrollBar:!0,className:"w-full h-full",children:(0,n.jsx)(ue,{selectedId:k||void 0,data:B,onSelect:function(X){ne(X)}})})}),(0,n.jsxs)("div",{style:{marginLeft:"".concat(((g==null?void 0:g.width)||0)+10,"px")},children:[oe(),F==null||(0,n.jsx)(ae,{model:F,selectedSubCategoryId:T,onSubCategorySelect:function(X){U(X)}}),(0,W.Wq)(J)||(0,n.jsx)(Y,{categoryId:J})]})]})})})}}}]);

"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4547],{50112:function(K,g,e){var x=e(21274),s=e(85893);g.Z=function(u){var a=u.loading,r=u.hasMore;return a?(0,s.jsx)(x.Z,{}):r?null:(0,s.jsx)("div",{className:"flex flex-row items-center justify-center gap-2",children:(0,s.jsx)("span",{className:"text-slate-400",children:"\u6CA1\u6709\u66F4\u591A\u4E86"})})}},66386:function(K,g,e){e.d(g,{Z:function(){return u}});var x=e(10843),s=e(85893);function u(){return(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("div",{children:(0,s.jsx)(x.X,{className:"flex h-12 w-12 rounded-full"})}),(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,s.jsx)(x.X,{className:"h-3 w-3/5 rounded-lg"}),(0,s.jsx)(x.X,{className:"h-3 w-4/5 rounded-lg"})]})]})}},13386:function(K,g,e){e.d(g,{Z:function(){return t}});var x=e(97857),s=e.n(x),u=e(78957),a=e(84367),r=e(85893),R=function(c){var d,D=c.model;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(u.Z,{direction:"horizontal",split:(0,r.jsx)(a.j,{orientation:"vertical"}),children:[D.StickyTop&&(0,r.jsx)("span",{className:"inline text-slate-400",children:"\u7F6E\u9876"}),(d=D.Tags)===null||d===void 0?void 0:d.map(function(C,j){return(0,r.jsx)("span",{className:"inline text-slate-400",children:C.Name},j)})]})})},E=e(50209),l=e(95813),v=e(45837),m=e(19314),f=e(35291),P=e(94442);function t(c){var d=c.model,D=c.count,C=c.lazy;if((0,l.Wq)(d.Id))return null;var j=(0,f.LK)(d,{width:250,height:250});return d.Published,(0,r.jsx)(v.w,s()(s()({shadow:"none",className:"w-full p-0",isHoverable:!0,isPressable:!0},c),{},{children:(0,r.jsx)(m.G,{className:"overflow-hidden",children:(0,r.jsxs)("div",{className:"flex flex-row justify-start items-start gap-2",children:[(0,r.jsx)("div",{className:"xs:w-[120px] w-[120px] sm:w-[170px] md:w-[230px]",children:(0,r.jsx)(P.Z,{rate:3/3,radius:"sm",shadow:"none",isZoomed:!0,loading:C?"lazy":"eager",src:j||void 0,className:"object-cover",classNames:{img:"object-cover"},width:"100%",style:{width:"100%"},alt:""})}),(0,r.jsxs)("div",{className:"w-full flex-grow p-1 ml-0",children:[(0,r.jsx)("h5",{className:"mb-1 text-title",children:d.Name||"--"}),(0,r.jsx)(E.Z,{skus:d.Skus||[],count:D}),(0,l.Wq)(d.AdminComment)||(0,r.jsx)("div",{className:"text-overline",children:d.AdminComment||"--"}),(0,r.jsx)(R,{model:d})]})]})})}))}},37087:function(K,g,e){e.d(g,{Z:function(){return r}});var x=e(67294),s=e(95813),u=e(38016),a=e(85893);function r(R){var E,l,v=R.model;if(v==null)return null;if(v.PriceModel==null||v.PriceModel.Empty)return(0,a.jsx)(u.e,{content:"\u4EF7\u683C\u767B\u5F55\u53EF\u89C1",color:"warning",showArrow:!0,children:(0,a.jsx)("span",{className:"text-nowrap font-light text-slate-400",children:"\u767B\u5F55\u89C1\u4EF7\u683C"})});var m=((E=v.PriceModel)===null||E===void 0?void 0:E.BasePrice)||0,f=((l=v.PriceModel)===null||l===void 0?void 0:l.FinalPrice)||0,P=(0,x.useMemo)(function(){var c=[];if(v.PriceModel==null)return c;if(v.PriceModel.DiscountModel!=null){var d=v.PriceModel.DiscountModel.DiscountPercentage||0;c.push("\u6298\u6263-".concat(v.PriceModel.DiscountModel.Name,":").concat(d*100,"%"))}if(v.PriceModel.GradePriceModel!=null){var D=v.PriceModel.GradePriceModel.PriceOffset||0;if(D!=0){var C;c.push("".concat(((C=v.PriceModel.GradePriceModel.Grade)===null||C===void 0?void 0:C.Name)||"\u4F1A\u5458\u4EF7",":").concat(D))}}return c},[v]),t=function(){return(0,a.jsxs)("div",{style:{display:"inline-block"},children:[m==f||(0,a.jsx)("span",{className:"text-slate-400",style:{textDecoration:"line-through",fontSize:"9px",whiteSpace:"nowrap",fontWeight:"lighter"},children:"".concat((0,s.lb)(m))}),(0,a.jsx)("span",{className:"text-nowrap text-black",children:(0,s.lb)(f)})]})};return(0,a.jsxs)(a.Fragment,{children:[P.length<=0&&t(),P.length<=0||(0,a.jsx)(u.e,{color:"warning",showArrow:!0,content:(0,a.jsx)("p",{children:P.map(function(c,d){return(0,a.jsxs)("p",{children:[d+1,":",c]},d)})}),children:t()})]})}},50209:function(K,g,e){var x=e(71016),s=e(74715),u=e(85893);g.Z=function(a){var r=a.skus,R=a.count,E=R||1,l=r.length;return l<=0?(0,u.jsx)("div",{className:"font-mono text-sm font-light text-slate-400",children:"\u6682\u65E0\u53EF\u552E"}):(0,u.jsxs)(u.Fragment,{children:[(0,x.Z)(r,E).map(function(v,m){return(0,u.jsx)(s.Z,{model:v},m)}),l>E&&(0,u.jsx)("div",{className:"text-caption text-sm",children:"\u4E00\u5171".concat(l,"\u79CD\u6B3E\u5F0F")})]})}},74715:function(K,g,e){var x=e(37087),s=e(85893);g.Z=function(u){var a=u.model;return(0,s.jsxs)("div",{className:"flex-row-between",children:[(0,s.jsx)("span",{className:"text-caption",children:a.Name||"--"}),(0,s.jsx)("span",{className:"ml-1",children:(0,s.jsx)(x.Z,{model:a})})]})}},94442:function(K,g,e){var x=e(97857),s=e.n(x),u=e(15009),a=e.n(u),r=e(99289),R=e.n(r),E=e(82052),l=e(68421),v=e(9383),m=e(67294),f=e(85893);g.Z=function(P){var t=P.width,c=P.rate,d=(0,m.useRef)(null),D=(0,E.Z)(d),C=D==null?void 0:D.width,j=function(){var i=R()(a()().mark(function N(){return a()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!(c!=null&&C!=null)){M.next=2;break}return M.abrupt("return",C*c);case 2:return M.abrupt("return",void 0);case 3:case"end":return M.stop()}},N)}));return function(){return i.apply(this,arguments)}}(),o=(0,l.Z)(j,{manual:!0,debounceWait:30});return(0,m.useEffect)(function(){o.run()},[C]),(0,f.jsx)("div",{ref:d,style:{display:"block",padding:0,margin:0,width:t!=null?t:"100%"},children:(0,f.jsx)(v.J,s()({width:C||void 0,height:o.data||void 0,radius:"none"},P))})}},37085:function(K,g,e){e.d(g,{Z:function(){return C}});var x=e(5574),s=e.n(x),u=e(67294),a=e(38295),r=e(95813),R=e(38016),E=e(68421),l=e(66386),v=e(30699),m=e(95564),f=e(78957),P=e(84367),t=e(85893),c=function(j){var o=j.store,i=j.currentId;if(!o)return null;var N=o.Id==i,B=function(n){return(0,t.jsx)("span",{className:"text-sm font-light text-slate-400",children:n})};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"my-2 cursor-pointer overflow-hidden rounded-md border-1 border-gray-100 bg-gray-50 p-2 shadow-sm hover:border-gray-200",onClick:function(){confirm("\u786E\u5B9A\u9009\u62E9[".concat(o.Name,"]\u4F5C\u4E3A\u5F53\u524D\u95E8\u5E97\uFF1F"))&&((0,r.LW)(o.Id||""),window.location.reload())},children:(0,t.jsxs)(f.Z,{direction:"vertical",children:[(0,t.jsxs)(f.Z,{direction:"horizontal",children:[(0,t.jsx)("h6",{className:"mb-1",children:o.Name}),N&&(0,t.jsx)("span",{className:"text-red-400",children:"\u5F53\u524D\u9009\u62E9"})]}),(0,t.jsxs)(f.Z,{direction:"horizontal",split:(0,t.jsx)(P.j,{orientation:"vertical"}),children:[(0,r.Wq)(o.Telephone)||(0,t.jsx)("span",{className:"mb-1 text-sm font-light text-slate-400",children:o.Telephone}),(0,r.Wq)(o.AddressDetail)||(0,t.jsx)("span",{className:"mb-1 text-sm font-light text-slate-400",children:o.AddressDetail})]}),(0,t.jsxs)(f.Z,{direction:"horizontal",split:(0,t.jsx)(P.j,{orientation:"vertical"}),children:[o.Opening&&B("\u8425\u4E1A\u4E2D"),o.InvoiceSupported&&B("\u652F\u6301\u5F00\u53D1\u7968"),o.Distance&&o.Distance>0&&B("".concat((o.Distance/1e3).toFixed(2),"km")),o.InServiceArea!=null&&o.InServiceArea&&B("\u5728\u670D\u52A1\u8303\u56F4\u5185")]})]})})})},d=function(j){var o,i=j.show,N=j.close,B=(0,a.o)(),M=(0,E.Z)(v.x1.mall.storeListStores,{manual:!0,onSuccess:function(p,W){(0,r._y)(p,function(){})}}),n=((o=M.data)===null||o===void 0||(o=o.data)===null||o===void 0?void 0:o.Data)||[],V=(0,E.Z)(r.MK,{manual:!0,onSuccess:function(p){console.log("\u5B9A\u4F4D\u7ED3\u679C",p);var W={Lat:p.coords.latitude,Lon:p.coords.longitude};M.run({headers:{"x-location":JSON.stringify(W)}})},onError:function(p){var W;console.log(p),(W=r.iI.message)===null||W===void 0||W.error("\u5B9A\u4F4D\u5931\u8D25\uFF0C\u5C06\u5C55\u793A\u9ED8\u8BA4\u95E8\u5E97"),M.run({})}});(0,u.useEffect)(function(){i&&(alert("\u8BF7\u5141\u8BB8\u6211\u4EEC\u901A\u8FC7\u60A8\u7684\u5B9A\u4F4D\u6765\u83B7\u53D6\u9644\u8FD1\u7684\u95E8\u5E97"),V.run())},[i]);var G=function(){return M.loading||V.loading?(0,t.jsx)(l.Z,{}):(0,r.G5)(n)?(0,t.jsx)("h2",{children:"\u9644\u8FD1\u6CA1\u6709\u53EF\u9009\u95E8\u5E97"}):n==null?void 0:n.map(function(p,W){var J;return(0,t.jsx)("div",{children:(0,t.jsx)(c,{currentId:(J=B.currentStore)===null||J===void 0?void 0:J.Id,store:p})},W)})};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m.Z,{open:i,onClose:function(){return N&&N()},title:"\u9644\u8FD1\u95E8\u5E97",children:G()})})},D=e(45991),C=function(){var j,o,i=(0,a.o)(),N=(0,E.Z)(i.queryCurrentStore,{manual:!0}),B=(0,E.Z)(i.queryMostNearbyStore,{manual:!0}),M=(0,u.useState)(!1),n=s()(M,2),V=n[0],G=n[1];return(0,u.useEffect)(function(){var S,p;i.currentStore!=null&&(S=i.mostNearbyStore)!==null&&S!==void 0&&S.Id&&i.mostNearbyStore.Id!=((p=i.currentStore)===null||p===void 0?void 0:p.Id)&&(confirm("\u662F\u5426\u5207\u6362\u5230\u9644\u8FD1\u7684\u95E8\u5E97\uFF1A[".concat(i.mostNearbyStore.Id,"]"))?((0,r.LW)(i.mostNearbyStore.Id||""),setTimeout(function(){window.location.reload()},500)):i.mostNearbyStore=void 0)},[i.mostNearbyStore,i.currentStore]),(0,u.useEffect)(function(){N.run(),i.mostNearbyStore==null&&B.run()},[]),(0,u.useEffect)(function(){var S;(S=i.currentStore)!==null&&S!==void 0&&S.Id&&!i.currentStore.Opening&&confirm("\u5F53\u524D\u95E8\u5E97[".concat(i.currentStore.Name||"--","]\u5DF2\u7ECF\u95ED\u5E97\uFF0C\u662F\u5426\u66F4\u6362\u95E8\u5E97"))&&G(!0)},[i.currentStore]),N.loading||B.loading?(0,t.jsx)("span",{children:"..."}):(j=i.currentStore)!==null&&j!==void 0&&j.Id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{show:V,close:function(){G(!1)}}),(0,t.jsx)(R.e,{content:"\u9009\u62E9\u95E8\u5E97",showArrow:!0,color:"warning",children:(0,t.jsxs)("div",{className:"flex-row-center gap-1 cursor-pointer",children:[(0,t.jsx)(D.Z,{stroke:1,size:20}),(0,t.jsx)("span",{className:"text-overline m-0 p-0",onClick:function(){G(!0)},children:((o=i.currentStore)===null||o===void 0?void 0:o.Name)||"--"})]})})]}):(0,t.jsx)("span",{children:"\u65E0\u95E8\u5E97\u4FE1\u606F"})}},95564:function(K,g,e){var x=e(97857),s=e.n(x),u=e(38787),a=e(94087),r=e(78967),R=e(87740),E=e(86597),l=e(96476),v=e(77373),m=e(85893);g.Z=function(f){var P=f.open,t=f.onClose,c=f.children,d=f.title,D=f.action,C=f.pureBody,j=f.showCloseButton,o=f.bodyStyle,i=f.props,N=function(){return j?(0,m.jsx)("div",{style:{position:"relative"},children:(0,m.jsx)(u.A,{style:{position:"absolute",display:"inline",right:"20px",top:"20px",zIndex:1},isIconOnly:!0,size:"sm",radius:"full",color:"danger",onClick:function(){t&&t()},children:(0,m.jsx)(v.Z,{stroke:1})})}):null};return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(a.R,s()(s()({className:"overflow-hidden",backdrop:"blur",isOpen:P,onClose:t,hideCloseButton:!0,isDismissable:!0,scrollBehavior:"outside"},i),{},{children:(0,m.jsxs)(r.A,{children:[N(),d==null||(0,m.jsx)(R.k,{className:"flex flex-col gap-1",children:d}),C&&c,C||(0,m.jsx)(E.I,{style:o,children:(0,m.jsx)("div",{style:{minHeight:300},children:c})}),D&&(0,m.jsx)(l.R,{children:D})]})}))})}},22163:function(K,g,e){e.r(g),e.d(g,{default:function(){return de}});var x=e(5574),s=e.n(x),u=e(84179),a=e(82052),r=e(68421),R=e(35195),E=e(38018),l=e(67294),v=e(21274),m=e(94442),f=e(38295),P=e(30699),t=e(55932),c=e(95813),d=e(76021),D=e(81239),C=e(15009),j=e.n(C),o=e(99289),i=e.n(o),N=e(68770),B=e(50112),M=e(13386),n=e(85893);function V(y){var I=y.categoryId,h=(0,N.Z)(function(){var z=i()(j()().mark(function T(Z){var k,Q;return j()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!(0,c.Wq)(I)){U.next=2;break}return U.abrupt("return",{list:[]});case 2:return U.next=4,P.x1.mall.searchSearchGoodsList({CategoryId:I,Page:((Z==null||(k=Z.res)===null||k===void 0?void 0:k.PageIndex)||0)+1});case 4:return Q=U.sent,U.abrupt("return",{list:Q.data.Items||[],res:Q.data});case 6:case"end":return U.stop()}},T)}));return function(T){return z.apply(this,arguments)}}(),{reloadDeps:[I],target:window.document,isNoMore:function(T){var Z;return(T==null||(Z=T.res)===null||Z===void 0?void 0:Z.IsEmpty)||!1}}),A=h.loading,_=h.data,O=h.noMore,b=h.loadingMore,w=h.loadMore,Y=h.reload,F=h.mutate,X=(_==null?void 0:_.list)||[];return(0,l.useEffect)(function(){F({list:[]})},[I]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{style:{},children:[X==null?void 0:X.map(function(z,T){return(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)(M.Z,{model:z,count:2,lazy:!0,onClick:function(){(0,c.E4)(z.Id)}})},T)}),(0,n.jsx)(B.Z,{loading:A||b,hasMore:!O})]})})}var G=e(37085),S=e(15142),p=e(45336),W=e(79479),J=e(7311),te=e(38787),re=e(13129);function se(y){var I=y.children,h=(0,f.o)(),A=(0,l.useRef)(null),_=(0,a.Z)(A),O=(0,l.useState)(0),b=s()(O,2),w=b[0],Y=b[1];return(0,l.useEffect)(function(){w?h.headerHeight=0:h.headerHeight=(_==null?void 0:_.height)||0},[_,w]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(S.R,{ref:A,maxWidth:"lg",isBlurred:!0,position:"static",children:[(0,n.jsx)(p.H,{children:(0,n.jsx)(G.Z,{})}),(0,n.jsx)(W.U,{justify:"center",children:(0,n.jsx)(J.k,{children:(0,n.jsx)("h6",{className:"text-title",children:window.document.title||h.getAppName()})})}),(0,n.jsx)(W.U,{justify:"end",children:(0,n.jsx)(J.k,{children:(0,n.jsx)(te.A,{isIconOnly:!0,variant:"light",onClick:function(){d.m8.push({pathname:"/search"})},children:(0,n.jsx)(re.Z,{stroke:1})})})})]}),(0,n.jsx)("div",{style:{marginTop:"".concat(10,"px")},children:I})]})}var oe=function(y){var I,h=y.model,A=y.onSubCategorySelect,_=y.selectedSubCategoryId,O=(0,r.Z)(P.x1.mall.categoryByParent,{manual:!0}),b=((I=O.data)===null||I===void 0||(I=I.data)===null||I===void 0?void 0:I.Data)||[];(0,l.useEffect)(function(){O.mutate(),h&&h.Id&&O.run({Id:h.Id})},[h]);var w=function(){return O.loading?(0,n.jsx)("span",{}):b.length<=0?null:(0,n.jsx)(n.Fragment,{children:b.map(function(F,X){return(0,n.jsx)(te.A,{className:"mb-1 mr-1",variant:_==F.Id?"flat":"light",color:"default",size:"sm",radius:"full",onClick:function(){F.Id!=_?A(F.Id):A(void 0)},children:F.Name||"--"},X)})})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"mb-3 p-1",children:[(0,n.jsx)("div",{className:"text-title mb-1",children:h.Name||"--"}),(0,c.Wq)(h.Description)||(0,n.jsx)("p",{className:"text-caption mb-1",children:h.Description}),w()]})})},ae=e(79510),le=e(29505),ie=e(39278);function ue(y){var I=y.selectedId,h=y.onSelect,A=y.data;return!A||A.length<=0?null:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(ae.n,{isVertical:!0,variant:"light",size:"sm",selectedKey:I||void 0,onSelectionChange:function(O){h(O)},children:A.map(function(_,O){return(0,n.jsx)(le.r,{title:(0,n.jsx)(ie.O,{content:"",color:"danger",shape:"circle",isInvisible:!_.Recommend,children:(0,n.jsx)("span",{children:_.Name})})},_.Id)})})})}function de(){var y;(0,u.Z)("\u7C7B\u76EE");var I=(0,f.o)(),h=(0,d.TH)(),A=(0,l.useRef)(null),_=(0,a.Z)(A),O=(0,l.useRef)(null),b=(0,a.Z)(window.document.body),w=(0,l.useMemo)(function(){var L;return((L=O.current)===null||L===void 0?void 0:L.getBoundingClientRect().left)||0},[b,O]),Y=(0,r.Z)(P.x1.mall.categoryStoreRootCategory,{manual:!0}),F=((y=Y.data)===null||y===void 0||(y=y.data)===null||y===void 0?void 0:y.Data)||[],X=(0,l.useState)(void 0),z=s()(X,2),T=z[0],Z=z[1],k=(0,l.useState)(void 0),Q=s()(k,2),ee=Q[0],U=Q[1],H=F.find(function(L){return L.Id==T}),ne=ee||T;(0,l.useEffect)(function(){var L,$=(L=E.parse(h.search))===null||L===void 0?void 0:L.cat,q=(0,R.Z)(F,function(ve){return ve.Id==$?-1:0}).at(0);q&&q.Id!=T&&Z(q==null?void 0:q.Id)},[F]),(0,l.useEffect)(function(){Y.run({})},[]),(0,l.useEffect)(function(){window&&window.scrollTo({top:0,left:0})},[ne]);var ce=function(){var $=(0,t.Kk)(H==null?void 0:H.Picture,{width:300});return $?(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)(m.Z,{src:$,alt:(H==null?void 0:H.Name)||"",className:"object-contain",width:"100%"})}):null};return Y.loading?(0,n.jsx)(v.Z,{}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(se,{children:(0,n.jsxs)("div",{ref:O,className:"container max-w-lg",children:[(0,n.jsx)("div",{ref:A,style:{position:"fixed",top:I.headerHeight,bottom:I.bottomHeight,left:w,overflow:"hidden",zIndex:1},children:(0,n.jsx)(D.o,{hideScrollBar:!0,className:"h-full w-full",children:(0,n.jsx)(ue,{selectedId:T||void 0,data:F,onSelect:function($){Z($)}})})}),(0,n.jsxs)("div",{style:{marginLeft:"".concat(((_==null?void 0:_.width)||0)+10,"px")},children:[ce(),H==null||(0,n.jsx)(oe,{model:H,selectedSubCategoryId:ee,onSubCategorySelect:function($){U($)}}),(0,c.Wq)(ne)||(0,n.jsx)(V,{categoryId:ne})]})]})})})}}}]);

"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2873],{74590:function(z,x,e){var C=e(15009),_=e.n(C),D=e(99289),s=e.n(D),h=e(5574),f=e.n(h),U=e(83062),T=e(28036),M=e(67294),d=e(85893);x.Z=function(o){var b=o.action,m=o.confirmText,O=o.hide,I=(0,M.useState)(!1),g=f()(I,2),u=g[0],n=g[1],t=m||"\u786E\u5B9A\u5220\u9664\uFF1F",c=function(){var l=s()(_()().mark(function a(){return _()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(confirm(t)){v.next=2;break}return v.abrupt("return");case 2:return n(!0),v.prev=3,v.next=6,b();case 6:return v.prev=6,n(!1),v.finish(6);case 9:case"end":return v.stop()}},a,null,[[3,,6,9]])}));return function(){return l.apply(this,arguments)}}();return O?null:(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(U.Z,{title:t,children:(0,d.jsx)(T.ZP,{loading:u,danger:!0,type:"link",onClick:function(){c()},children:"\u5220\u9664"})})})}},23806:function(z,x,e){var C=e(1288),_=e(85893);x.Z=function(D){var s=D.model,h=D.fallback;if(s==null||s==null)return null;var f=s==null?void 0:s.CreationTime,U=s==null?void 0:s.LastModificationTime;return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)("div",{style:{},children:[(0,_.jsx)("div",{children:(0,_.jsx)(C.Z,{prefix:(0,_.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:f,fallback:h})}),(0,_.jsx)("div",{children:(0,_.jsx)(C.Z,{prefix:(0,_.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:U,fallback:h})})]})})}},1288:function(z,x,e){var C=e(78957),_=e(83062),D=e(46629),s=e(85893);x.Z=function(h){var f,U=h.timeStr,T=h.fallback,M=h.onlyDate,d=h.prefix,o=(f=(0,D.QW)(U))===null||f===void 0?void 0:f.local();if(!o)return T||null;var b=(0,D.ND)().utc().local(),m=o.isSame(b,"year"),O=o.diff(b,"day"),I=m?o.format(D.AK):o.format(D.vc),g=function(){return(0,s.jsxs)("div",{children:[(0,s.jsxs)(C.Z,{direction:"horizontal",children:[(0,s.jsx)("div",{children:o.fromNow()}),(0,s.jsx)("div",{children:o.format(D.On)})]}),(0,s.jsx)("div",{children:o.format(D.t9)})]})};return(0,s.jsx)(_.Z,{title:g(),children:(0,s.jsxs)(C.Z,{direction:"horizontal",children:[d,(0,s.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:M?o.format(D.vc):o.format(D.dq)})]})})}},94442:function(z,x,e){var C=e(97857),_=e.n(C),D=e(15009),s=e.n(D),h=e(99289),f=e.n(h),U=e(5574),T=e.n(U),M=e(82052),d=e(68421),o=e(18207),b=e(67294),m=e(85893);x.Z=function(O){var I=O.width,g=O.rate,u=O.minHeightBeforeLoaded,n=(0,b.useState)(!1),t=T()(n,2),c=t[0],l=t[1],a=function(){if(!c)return u||void 0},E=(0,b.useRef)(null),v=(0,M.Z)(E),i=v==null?void 0:v.width,k=function(){var G=f()(s()().mark(function r(){return s()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!(g!=null&&i!=null)){Z.next=2;break}return Z.abrupt("return",i*g);case 2:return Z.abrupt("return",void 0);case 3:case"end":return Z.stop()}},r)}));return function(){return G.apply(this,arguments)}}(),J=(0,d.Z)(k,{manual:!0,debounceWait:90});return(0,b.useEffect)(function(){J.run()},[i,g]),(0,m.jsx)("div",{ref:E,style:{display:"block",width:I!=null?I:"100%"},children:(0,m.jsx)(o.J,_()({showSkeleton:!0,width:i||void 0,height:J.data||void 0,radius:"none",onLoad:function(){l(!0)},style:{minHeight:a()||void 0}},O))})}},80427:function(z,x,e){var C=e(5574),_=e.n(C),D=e(98163),s=e(7134),h=e(55241),f=e(67294),U=e(35291),T=e(95813),M=e(94442),d=e(85893);x.Z=function(o){var b=o.data,m=o.count,O=(0,f.useState)(void 0),I=_()(O,2),g=I[0],u=I[1],n=b||[],t=m||3,c=n.map(function(a){return(0,U.u2)(a)}),l=function(E){return(0,d.jsx)("div",{style:{maxWidth:500},children:(0,d.jsx)(M.Z,{src:E.small||"",alt:""})})};return(0,T.G5)(c)?null:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{style:{display:"none"},children:(0,d.jsx)(D.Z.PreviewGroup,{preview:{current:Math.max(g||0,0),visible:g!=null,onVisibleChange:function(E,v,i){u(E?i:void 0)},onChange:function(E){g!=null&&u(E)}},children:c.map(function(a,E){return(0,d.jsx)(D.Z,{src:a.large||"",alt:""},E)})})}),(0,d.jsx)("div",{style:{},children:(0,d.jsx)(s.C.Group,{maxCount:t,shape:"square",children:c.map(function(a,E){return(0,d.jsx)(h.Z,{title:"\u9884\u89C8",content:l(a),placement:"left",children:(0,d.jsx)(s.C,{style:{backgroundColor:"gray"},src:a.small||"",size:"large",onClick:function(){u(E)}})},E)})})})]})}},8045:function(z,x,e){var C=e(97857),_=e.n(C),D=e(28036),s=e(67294),h=e(85893);x.Z=function(f){var U=f.loading,T=f.inputProps,M=f.onSelect,d=f.uploadButtonProps,o=(0,s.useRef)(null);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{style:{display:"none"},children:(0,h.jsx)("input",_()(_()({ref:o,type:"file",multiple:!1},T),{},{onChange:function(m){try{var O=m.target.files;O&&M&&M(O)}finally{o.current&&(o.current.value="",o.current.files=null)}}}))}),(0,h.jsx)(D.ZP,_()(_()({size:"small",loading:U,type:"dashed"},d),{},{onClick:function(){var m;(m=o.current)===null||m===void 0||m.click()},children:"\u9009\u62E9\u56FE\u7247"}))]})}},6786:function(z,x,e){var C=e(15009),_=e.n(C),D=e(99289),s=e.n(D),h=e(97857),f=e.n(h),U=e(98163),T=e(45360),M=e(28036),d=e(78957),o=e(85134),b=e(55932),m=e(55793),O=e(95813),I=e(8045),g=e(68421),u=e(85893);x.Z=function(n){var t=n.data,c=n.ok,l=n.remove,a=n.loadingSave,E=n.width,v=n.defaultImage,i=n.imageProps,k=n.uploadButtonProps,J=n.removeButtonProps,G=(0,b.Kk)(t,{width:E||100}),r=function(){var L=G||v;return(0,O.Wq)(L)?null:(0,u.jsx)(U.Z,f()({src:L||"",alt:"",width:E||50},i))},q=function(){var F=s()(_()().mark(function L(R){var $;return _()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(j.prev=0,(0,m.Vl)(R.name)){j.next=4;break}return T.ZP.error("\u53EA\u652F\u6301 ".concat((0,m.$z)().join("\u3001")," \u683C\u5F0F\u7684\u56FE\u7247")),j.abrupt("return");case 4:return j.next=6,(0,m.ur)(R,o.vc.upload.max_size);case 6:if(R=j.sent,!(R.size>o.vc.upload.max_size)){j.next=10;break}return T.ZP.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC71MB"),j.abrupt("return");case 10:return j.next=12,(0,m.fn)(R);case 12:$=j.sent,$&&c&&c($),j.next=20;break;case 16:j.prev=16,j.t0=j.catch(0),console.log(j.t0),T.ZP.error("\u4E0A\u4F20\u9047\u5230\u9519\u8BEF");case 20:case"end":return j.stop()}},L,null,[[0,16]])}));return function(R){return F.apply(this,arguments)}}(),Z=(0,g.Z)(q,{manual:!0}),y=function(){return(0,O.Wq)(G)||!l?null:(0,u.jsx)(M.ZP,f()(f()({size:"small",type:"dashed",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&l&&l()}},J),{},{children:"\u79FB\u9664\u56FE\u7247"}))};return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)(d.Z,{direction:"horizontal",children:[r(),(0,u.jsxs)(d.Z,{direction:"vertical",children:[(0,u.jsx)(I.Z,{loading:a||Z.loading,inputProps:{accept:"image/*",multiple:!1},onSelect:function(L){var R=L.item(0);R&&Z.run(R)},uploadButtonProps:k}),y()]})]})})}},17991:function(z,x,e){e.r(x),e.d(x,{default:function(){return Z}});var C=e(15009),_=e.n(C),D=e(99289),s=e.n(D),h=e(5574),f=e.n(h),U=e(68421),T=e(78957),M=e(28036),d=e(45360),o=e(4393),b=e(80799),m=e(67294),O=e(74590),I=e(80427),g=e(23806),u=e(35291),n=e(30699),t=e(95813),c=e(97857),l=e.n(c),a=e(85576),E=e(57381),v=e(11346),i=e(39019),k=e(92783),J=e(65233),G=e(6786),r=e(85893),q=function(y){var F=y.show,L=y.hide,R=y.data,$=y.ok,ee=(0,m.useState)(!1),j=f()(ee,2),Q=j[0],w=j[1],N=(0,m.useState)([]),ne=f()(N,2),ae=ne[0],K=ne[1],W=(0,m.useState)([]),B=f()(W,2),A=B[0],X=B[1],H=(0,m.useState)({}),re=f()(H,2),P=re[0],V=re[1],se=function(){w(!0),n.x1.sys.areaLoadTree({}).then(function(p){(0,t._y)(p,function(){var Y=p.data.Data||[];K(Y);var _e=Y.flatMap(function(ue){return(0,u.PC)(ue)}).map(function(ue){return ue.key});X(_e)})}).finally(function(){w(!1)})},te=function(p){var Y;p.Name=(Y=p.Name)===null||Y===void 0?void 0:Y.trim(),!(0,t.Wq)(p.Name)&&(w(!0),n.x1.sys.areaSave(l()({},p)).then(function(_e){(0,t._y)(_e,function(){d.ZP.success("\u4FDD\u5B58\u6210\u529F"),$()})}).finally(function(){w(!1)}))};return(0,m.useEffect)(function(){V(l()({},R))},[R]),(0,m.useEffect)(function(){F?se():V({})},[F]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(a.Z,{title:"\u533A\u57DF",confirmLoading:Q,open:F,onCancel:function(){return L()},footer:(0,r.jsx)(T.Z,{children:(0,r.jsx)(M.ZP,{type:"primary",loading:Q,onClick:function(){te(P)},children:"\u4FDD\u5B58"})}),children:(0,r.jsx)(E.Z,{spinning:Q,children:(0,r.jsxs)(v.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,r.jsx)(v.Z.Item,{label:"\u56FE\u7247",children:(0,r.jsx)(G.Z,{loadingSave:Q,data:P.StorageMeta||{},ok:function(p){V(l()(l()({},P),{},{MetaId:p.Id,StorageMeta:p}))},remove:function(){confirm("\u786E\u5B9A\u5220\u9664\u56FE\u7247\u5417\uFF1F")&&V(l()(l()({},P),{},{MetaId:void 0,StorageMeta:void 0}))}})}),(0,r.jsx)(v.Z.Item,{label:"\u7236\u7EA7",children:(0,r.jsx)(i.Z,{placeholder:"\u65E0\u7236\u7EA7\u5206\u7C7B\u5219\u89C6\u4E3A\u9876\u7EA7\u5206\u7C7B",treeData:ae.map(function(S){return(0,u.iw)(S)}),treeExpandedKeys:A,onTreeExpand:function(p){return X(p)},allowClear:!0,value:P.ParentId||void 0,onChange:function(p){if(!(0,t.Wq)(P.Id)&&p==P.Id){d.ZP.error("\u65E0\u6CD5\u6307\u5B9A\u8BE5\u8282\u70B9");return}V(l()(l()({},P),{},{ParentId:p}))}})}),(0,r.jsx)(v.Z.Item,{label:"\u7C7B\u578B",children:(0,r.jsx)(k.Z,{options:[{label:"\u5927\u6D32",value:"continent"},{label:"\u56FD\u5BB6",value:"country"},{label:"\u5730\u533A",value:"area"},{label:"\u5176\u4ED6",value:"other"}],value:P.AreaType,onChange:function(p){V(l()(l()({},P),{},{AreaType:p}))}})}),(0,r.jsxs)(v.Z.Item,{label:"\u540D\u79F0",required:!0,children:[(0,r.jsx)(J.Z,{count:{show:!0,max:20},maxLength:20,required:!0,value:P.Name||"",onChange:function(p){V(l()(l()({},P),{},{Name:p.target.value}))}}),(0,t.Wq)(P.Name)&&(0,r.jsx)("p",{style:{color:"red"},children:"\u5FC5\u586B"})]}),(0,r.jsx)(v.Z.Item,{label:"\u63CF\u8FF0",children:(0,r.jsx)(J.Z.TextArea,{rows:2,count:{show:!0,max:20},maxLength:20,required:!0,value:P.Description||"",onChange:function(p){V(l()(l()({},P),{},{Description:p.target.value}))}})})]})})})})},Z=function(){var y,F=(0,m.useState)([]),L=f()(F,2),R=L[0],$=L[1],ee=(0,m.useState)(void 0),j=f()(ee,2),Q=j[0],w=j[1],N=(0,U.Z)(n.x1.sys.areaLoadTree,{manual:!0,onSuccess:function(W,B){var A=W.data.Data||[],X=A.flatMap(function(H){return(0,u.PC)(H)}).map(function(H){return H.key||""});$(X)}}),ne=((y=N.data)===null||y===void 0||(y=y.data)===null||y===void 0?void 0:y.Data)||[],ae=[{title:"\u540D\u79F0",render:function(W,B){return B.title}},{title:"\u63CF\u8FF0",render:function(W,B){var A;return((A=B.raw_data)===null||A===void 0?void 0:A.Description)||"--"}},{title:"\u7C7B\u578B",render:function(W,B){var A;return((A=B.raw_data)===null||A===void 0?void 0:A.AreaType)||"--"}},{title:"\u56FE\u7247",render:function(W,B){var A=B.raw_data||{};return A.StorageMeta==null?null:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(I.Z,{data:[A.StorageMeta]})})}},{title:"\u65F6\u95F4",render:function(W,B){return(0,r.jsx)(g.Z,{model:B.raw_data})}},{title:"\u64CD\u4F5C",width:200,render:function(W,B){var A=B.raw_data||{};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(T.Z,{direction:"horizontal",children:[(0,r.jsx)(M.ZP,{type:"link",onClick:function(){w(A)},children:"\u7F16\u8F91"}),(0,t.G5)(B.children)&&(0,r.jsx)(O.Z,{action:s()(_()().mark(function X(){var H;return _()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,n.x1.sys.areaDeleteById({Id:A.Id});case 2:H=P.sent,(0,t._y)(H,function(){d.ZP.success("\u5220\u9664\u6210\u529F"),N.run({})});case 4:case"end":return P.stop()}},X)}))})]})})}}];return(0,m.useEffect)(function(){N.run({})},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q,{show:Q!=null,hide:function(){return w(void 0)},data:Q||{},ok:function(){w(void 0),N.run({})}}),(0,r.jsx)(o.Z,{title:"\u5730\u533A",loading:N.loading,extra:(0,r.jsx)(M.ZP,{type:"primary",onClick:function(){w({})},children:"\u65B0\u589E"}),children:(0,r.jsx)(b.Z,{rowKey:function(W){return W.key||""},expandable:{expandedRowKeys:R,defaultExpandAllRows:!0,showExpandColumn:!0,onExpandedRowsChange:function(W){$(W)}},loading:N.loading,columns:ae,dataSource:ne,pagination:!1})})]})}},55793:function(z,x,e){e.d(x,{$z:function(){return M},Ac:function(){return I},Vl:function(){return d},fn:function(){return m},ur:function(){return b}});var C=e(15009),_=e.n(C),D=e(99289),s=e.n(D),h=e(76857),f=e(95813),U=e(98005),T=e.n(U),M=function(){return["jpg","jpeg","png","gif"]},d=function(u){var n,t=((n=(0,f.mD)(u))===null||n===void 0?void 0:n.toLowerCase())||"";return M().indexOf(t)>=0},o=function(u,n,t,c){return new Promise(function(l,a){var E=new(T())(u,{maxHeight:n,maxWidth:t,quality:c,success:function(i){l(i)},error:function(i){a(i)}});console.log(E)})},b=function(){var g=s()(_()().mark(function u(n,t){var c,l,a,E;return _()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(n.size<=t)){i.next=2;break}return i.abrupt("return",n);case 2:return i.next=4,o(n,void 0,void 0,.9);case 4:if(n=i.sent,!(n.size<=t)){i.next=7;break}return i.abrupt("return",n);case 7:c=5,l=300,a=1e3,E=0;case 11:if(!(++E<=c)){i.next=22;break}return i.next=14,o(n,a,a,1);case 14:if(n=i.sent,!(n.size<=t)){i.next=17;break}return i.abrupt("return",n);case 17:if(a-=l,!(a<=0)){i.next=20;break}return i.abrupt("break",22);case 20:i.next=11;break;case 22:return i.abrupt("return",n);case 23:case"end":return i.stop()}},u)}));return function(n,t){return g.apply(this,arguments)}}(),m=function(){var g=s()(_()().mark(function u(n){var t,c;return _()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,O([n]);case 2:if(t=a.sent,c=t.at(0),c){a.next=6;break}throw new Error("response error");case 6:return a.abrupt("return",c);case 7:case"end":return a.stop()}},u)}));return function(n){return g.apply(this,arguments)}}(),O=function(){var g=s()(_()().mark(function u(n){var t,c;return _()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=new FormData,n.forEach(function(E,v){t.append("formFileCollection",E,E.name)}),a.next=4,h.M.post("/api/platform/storage/upload",t);case 4:if(c=a.sent,!c.data.Error){a.next=7;break}throw new Error(c.data.Error.Message||"upload error");case 7:return a.abrupt("return",c.data.Data||[]);case 8:case"end":return a.stop()}},u)}));return function(n){return g.apply(this,arguments)}}(),I=function(u){return new Promise(function(n,t){var c=new FileReader;c.onload=function(){n(c.result)},c.onerror=function(l){t(l)},c.readAsDataURL(u)})}}}]);

"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2633],{39526:function(N,S,e){var L=e(70025),t=e(85893);S.Z=function(j){var f=j.open,A=j.onClose,m=j.title,b=j.action,c=j.children;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(L.Z,{open:f,onClose:function(){A&&A()},title:m,action:b,props:{hideCloseButton:!1,size:"md",backdrop:"blur"},children:c})})}},70025:function(N,S,e){var L=e(97857),t=e.n(L),j=e(86597),f=e(38787),A=e(94087),m=e(78967),b=e(87740),c=e(96476),R=e(77373),o=e(85893);S.Z=function(_){var W=_.open,g=_.onClose,I=_.children,O=_.title,M=_.action,i=_.pureBody,u=_.showCloseButton,v=_.bodyStyle,p=_.props,U=function(){return i?I:(0,o.jsx)(j.I,{style:v,children:(0,o.jsx)("div",{style:{minHeight:300},children:I})})},n=function(){return u?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{style:{position:"relative"},children:(0,o.jsx)("div",{style:{position:"absolute",display:"inline",right:"20px",top:"20px",zIndex:1},children:(0,o.jsx)(f.A,{isIconOnly:!0,size:"sm",radius:"full",color:"danger",onClick:function(){g&&g()},children:(0,o.jsx)(R.Z,{stroke:1})})})})}):null};return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(A.R,t()(t()({className:"overflow-hidden",backdrop:"blur",isOpen:W,onClose:g,hideCloseButton:!0,isDismissable:!0,scrollBehavior:"outside"},p),{},{children:(0,o.jsx)(m.A,{children:function(){return(0,o.jsxs)(o.Fragment,{children:[n(),O==null||(0,o.jsx)(b.k,{className:"flex flex-col gap-1",children:O}),U(),M&&(0,o.jsx)(c.R,{children:M})]})}})}))})}},85685:function(N,S,e){e.d(S,{Z:function(){return b}});var L=e(38295),t=e(47650),j=e(66419),f=e(38787),A=e(48135),m=e(85893);function b(c){var R=c.children,o=c.rightButtons,_=c.leftButtons,W=(0,L.o)(),g=function(){window.history.length>1?t.m8.back():t.m8.push({pathname:"/"})},I=function(){return(0,m.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,j.G5)(_)&&(0,m.jsxs)("div",{className:"flex-row-center cursor-pointer gap-1",onClick:function(i){i.preventDefault(),i.stopPropagation(),g()},children:[(0,m.jsx)(f.A,{size:"lg",color:"default",radius:"full",variant:"light",isIconOnly:!0,onClick:function(i){i.preventDefault(),i.stopPropagation(),g()},children:(0,m.jsx)(A.Z,{stroke:1})}),(0,m.jsx)("h1",{className:"text-title m-0 p-0",children:window.document.title||W.getAppName()})]}),_==null?void 0:_.map(function(M){return M})]})};return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"container max-w-lg",children:[(0,m.jsxs)("div",{className:"flex-row-between py-1",children:[I(),(0,m.jsx)("div",{className:"flex-row-center gap-2",children:o==null?void 0:o.map(function(O){return O})})]}),(0,m.jsx)("div",{children:R})]})})}},8045:function(N,S,e){var L=e(97857),t=e.n(L),j=e(14726),f=e(67294),A=e(85893);S.Z=function(m){var b=m.loading,c=m.inputProps,R=m.onSelect,o=m.uploadButtonProps,_=(0,f.useRef)(null);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{style:{display:"none"},children:(0,A.jsx)("input",t()(t()({ref:_,type:"file",multiple:!1},c),{},{onChange:function(g){try{var I=g.target.files;I&&R&&R(I)}finally{_.current&&(_.current.value="",_.current.files=null)}}}))}),(0,A.jsx)(j.ZP,t()(t()({size:"small",loading:b,type:"dashed"},o),{},{onClick:function(){var g;(g=_.current)===null||g===void 0||g.click()},children:"\u9009\u62E9\u56FE\u7247"}))]})}},6786:function(N,S,e){var L=e(15009),t=e.n(L),j=e(99289),f=e.n(j),A=e(97857),m=e.n(A),b=e(98163),c=e(45360),R=e(14726),o=e(78957),_=e(85134),W=e(55932),g=e(55793),I=e(66419),O=e(8045),M=e(68421),i=e(85893);S.Z=function(u){var v=u.data,p=u.ok,U=u.remove,n=u.loadingSave,x=u.width,P=u.defaultImage,h=u.imageProps,a=u.uploadButtonProps,l=u.removeButtonProps,d=(0,W.Kk)(v,{width:x||100}),s=function(){var D=d||P;return(0,I.Wq)(D)?null:(0,i.jsx)(b.Z,m()({src:D||"",alt:"",width:x||50},h))},r=function(){var T=f()(t()().mark(function D(y){var K;return t()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(C.prev=0,(0,g.Vl)(y.name)){C.next=4;break}return c.ZP.error("\u53EA\u652F\u6301 ".concat((0,g.$z)().join("\u3001")," \u683C\u5F0F\u7684\u56FE\u7247")),C.abrupt("return");case 4:return C.next=6,(0,g.ur)(y,_.v.upload.max_size);case 6:if(y=C.sent,!(y.size>_.v.upload.max_size)){C.next=10;break}return c.ZP.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC71MB"),C.abrupt("return");case 10:return C.next=12,(0,g.fn)(y);case 12:K=C.sent,K&&p&&p(K),C.next=20;break;case 16:C.prev=16,C.t0=C.catch(0),console.log(C.t0),c.ZP.error("\u4E0A\u4F20\u9047\u5230\u9519\u8BEF");case 20:case"end":return C.stop()}},D,null,[[0,16]])}));return function(y){return T.apply(this,arguments)}}(),E=(0,M.Z)(r,{manual:!0}),B=function(){return(0,I.Wq)(d)||!U?null:(0,i.jsx)(R.ZP,m()(m()({size:"small",type:"dashed",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&U&&U()}},l),{},{children:"\u79FB\u9664\u56FE\u7247"}))};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(o.Z,{direction:"horizontal",children:[s(),(0,i.jsxs)(o.Z,{direction:"vertical",children:[(0,i.jsx)(O.Z,{loading:n||E.loading,inputProps:{accept:"image/*",multiple:!1},onSelect:function(D){var y=D.item(0);y&&E.run(y)},uploadButtonProps:a}),B()]})]})})}},62666:function(N,S,e){e.r(S),e.d(S,{default:function(){return s}});var L=e(84179),t=e(68421),j=e(67294),f=e(21274),A=e(85685),m=e(38295),b=e(35291),c=e(30699),R=e(47650),o=e(66419),_=e(38787),W=e(97857),g=e.n(W),I=e(5574),O=e.n(I),M=e(6786),i=e(55932),u=e(45820),v=e(39526),p=e(84367),U=e(97322),n=e(85893);function x(r){var E=r.title,B=r.right;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"cursor-pointer px-2 py-4 hover:bg-slate-100",style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end"},children:[(0,n.jsx)("div",{className:"flex-grow",children:(0,n.jsx)("span",{children:E||""})}),(0,n.jsx)("div",{children:B}),(0,n.jsx)(U.Z,{stroke:1,color:"gray",className:"ml-1 text-gray-300"})]}),(0,n.jsx)(p.j,{})]})}function P(r){var E=r.model,B=r.ok,T=(0,j.useState)(!1),D=O()(T,2),y=D[0],K=D[1],w=(0,j.useState)(!1),C=O()(w,2),$=C[0],F=C[1],z=(0,i.SZ)(E.Avatar,{width:80,height:80}),G=function(){return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex-col-top gap-1 w-full",children:[(0,n.jsx)(M.Z,{width:200,defaultImage:z,data:E.Avatar||"{}",ok:function(V){confirm("\u66F4\u6362\u5934\u50CF\uFF1F")&&(K(!0),c.x1.platform.userUpdateProfile(g()(g()({},E),{},{Avatar:JSON.stringify(V)})).then(function(k){(0,o._y)(k,function(){F(!1),(0,o.cQ)("\u4FEE\u6539\u6210\u529F"),B&&B()})}).finally(function(){K(!1)}))}}),y&&(0,n.jsx)("p",{children:"loading..."})]})})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{title:"\u4E0A\u4F20\u5934\u50CF",open:$,onClose:function(){F(!1)},children:G()}),(0,n.jsx)(x,{title:"",right:(0,n.jsx)(u.h,{style:{width:80,height:80},radius:"full",color:"default",isBordered:!0,src:z,onClick:function(){F(!0)},children:E.NickName||E.IdentityName||"--"})})]})}function h(r){var E=r.model,B=r.ok;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(x,{title:"\u7528\u6237\u540D",right:(0,n.jsx)("span",{className:"text-sm text-slate-300",children:E.IdentityName||"--"})})})}function a(r){var E,B=r.model,T=r.ok,D=(0,j.useState)(!1),y=O()(D,2),K=y[0],w=y[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{title:"\u4FEE\u6539\u624B\u673A\u53F7",open:K,onClose:function(){return w(!1)},action:(0,n.jsx)("div",{className:"flex-row-center",children:(0,n.jsx)(_.A,{variant:"solid",isDisabled:!0,children:"\u4FDD\u5B58"})}),children:(0,n.jsx)("p",{children:"\u4FEE\u6539\u624B\u673A\u53F7"})}),(0,n.jsx)("div",{onClick:function(){w(!0)},children:(0,n.jsx)(x,{title:"\u624B\u673A\u53F7",right:(0,n.jsx)("span",{className:"text-sm text-slate-300",children:((E=B.UserMobile)===null||E===void 0?void 0:E.MobilePhone)||"--"})})})]})}var l=e(69047);function d(r){var E=r.model,B=r.ok,T=(0,j.useState)(!1),D=O()(T,2),y=D[0],K=D[1],w=(0,j.useState)(""),C=O()(w,2),$=C[0],F=C[1],z=(0,j.useState)(!1),G=O()(z,2),H=G[0],Q=G[1],V=function(){F(E.NickName||""),K(!0)},k=function(){K(!1)},X=function(){Q(!0),c.x1.platform.userUpdateProfile(g()(g()({},E),{},{NickName:$})).then(function(J){(0,o._y)(J,function(){k(),B&&B()})}).finally(function(){Q(!1)})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(v.Z,{open:y,onClose:k,title:"\u4FEE\u6539\u6635\u79F0",action:(0,n.jsxs)("div",{className:"flex flex-row items-center justify-center gap-2",children:[(0,n.jsx)(_.A,{onClick:k,children:"\u53D6\u6D88"}),(0,n.jsx)(_.A,{color:"primary",onClick:function(){X()},isLoading:H,children:"\u786E\u8BA4\u4FEE\u6539"})]}),children:[(0,n.jsx)("p",{className:"mb-2",children:"\u8BF7\u8F93\u5165\u6635\u79F0\u3002\u8981\u6C4210\u4E2A\u5B57\u7B26\u5185\uFF0C\u4E0D\u5305\u542B\u7279\u6B8A\u5B57\u7B26\u548C\u7A7A\u683C\u3002"}),(0,n.jsx)(l.Y,{autoFocus:!0,label:"\u65B0\u6635\u79F0",fullWidth:!0,value:$,onChange:function(J){return F(J.target.value)},variant:"bordered"})]}),(0,n.jsx)("div",{onClick:function(){V()},children:(0,n.jsx)(x,{title:"\u6635\u79F0",right:(0,n.jsx)("span",{className:"text-slate-500",children:E.NickName||"--"})})})]})}function s(){var r;(0,L.Z)("\u4E2A\u4EBA\u4FE1\u606F");var E=(0,m.o)(),B=((r=E.storeUser)===null||r===void 0?void 0:r.User)||{},T=(0,t.Z)(c.x1.mall.userAuthStoreUserAuth,{manual:!0,onSuccess:function(y,K){(0,o._y)(y,function(){E.storeUserAuthResult=y.data||{}})}});return(0,j.useEffect)(function(){T.run({})},[]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(A.Z,{children:(0,n.jsxs)("div",{className:"container max-w-lg",children:[T.loading&&(0,n.jsx)(f.Z,{}),(0,n.jsxs)("div",{className:"mb-2 overflow-hidden rounded-md bg-white",children:[(0,n.jsx)(P,{model:B,ok:function(){T.run({})}}),(0,n.jsx)(h,{model:B,ok:function(){T.run({})}}),(0,n.jsx)(d,{model:B,ok:function(){T.run({})}}),(0,n.jsx)(a,{model:B,ok:function(){T.run({})}})]}),(0,n.jsxs)("div",{className:"mb-2 overflow-hidden rounded-md bg-white",children:[(0,n.jsx)("div",{onClick:function(){},children:(0,n.jsx)(x,{title:"\u670D\u52A1\u7EC6\u5219",right:null})}),(0,n.jsx)("div",{onClick:function(){},children:(0,n.jsx)(x,{title:"\u5173\u4E8E\u6211\u4EEC",right:null})})]}),(0,b.lE)(E.storeUser)&&(0,n.jsx)("div",{className:"mx-5 my-10",children:(0,n.jsx)(_.A,{fullWidth:!0,variant:"solid",color:"danger",onClick:function(){confirm("\u786E\u5B9A\u9000\u51FA\u561B\uFF1F")&&((0,o.M8)(""),R.m8.push({pathname:"/"}))},children:"\u9000\u51FA\u767B\u5F55"})})]})})})}},38295:function(N,S,e){e.d(S,{o:function(){return h}});var L=e(15009),t=e.n(L),j=e(99289),f=e.n(j),A=e(19632),m=e.n(A),b=e(47650),c=e(30699),R=e(85134),o=e(66419),_=function(l){var d=P.mallSettings||{},s=[d.StoreNickName,d.StoreEnglishName];l?s=[d.StoreOfficialName,d.StoreOfficialEnglishName].concat(m()(s)):s=[].concat(m()(s),[d.StoreOfficialName,d.StoreOfficialEnglishName]);var r=s.filter(function(E){return!(0,o.Wq)(E)}).at(0);return r||R.v.app.name||R.v.app.english_name},W=function(){var a=f()(t()().mark(function l(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,c.x1.mall.notificationUnReadCount().then(function(r){P.notificationCount=r.data.Data||0});case 2:case"end":return s.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),g=function(){var a=f()(t()().mark(function l(){var d;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.x1.mallAdmin.gradeListGrades();case 2:d=r.sent,P.grades=d.data.Data||[];case 4:case"end":return r.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),I=function(){var a=f()(t()().mark(function l(){var d;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.x1.mallAdmin.storeQueryStores();case 2:d=r.sent,P.stores=d.data.Data||[];case 4:case"end":return r.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),O=function(){var a=f()(t()().mark(function l(){var d;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.x1.mall.shoppingCartCount();case 2:d=r.sent,P.shoppingCartCount=d.data.Data||0;case 4:case"end":return r.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),M=function(){var a=f()(t()().mark(function l(){var d;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.x1.mall.storeGetCurrentStore();case 2:d=r.sent,P.currentStore=d.data.Data||{};case 4:case"end":return r.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),i=function(){var a=f()(t()().mark(function l(){var d;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.x1.mall.storeMostNearbyStore();case 2:d=r.sent,P.mostNearbyStore=d.data.Data||{};case 4:case"end":return r.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),u=function(){var a=f()(t()().mark(function l(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,c.x1.platform.userAuth().then(function(r){P.userAuthResult=r.data||{}});case 2:case"end":return s.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),v=function(){var a=f()(t()().mark(function l(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,c.x1.sys.adminAuth().then(function(r){P.adminAuthResult=r.data||{}});case 2:case"end":return s.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),p=function(){var a=f()(t()().mark(function l(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,c.x1.sys.manageAdminQueryAdminPermissions().then(function(r){P.adminPermissions=r.data||{}});case 2:case"end":return s.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),U=function(){var a=f()(t()().mark(function l(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,c.x1.mallManager.storeManagerPermissionGetMyPermission().then(function(r){P.managerPermissions=r.data||{}});case 2:case"end":return s.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),n=function(){var a=f()(t()().mark(function l(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,c.x1.mallManager.storeManagerAuth().then(function(r){P.storeManagerAuthResult=r.data||{}});case 2:case"end":return s.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),x=function(){var a=f()(t()().mark(function l(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,c.x1.mall.userStoreUserAuth().then(function(r){P.storeUserAuthResult=r.data||{}});case 2:case"end":return s.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),P=(0,b.sj)({queryUserAuthResult:u,getAppName:_,queryAdminAuthResult:v,queryStoreManagerAuthResult:n,queryStoreUserAuthResult:x,queryAdminPermission:p,queryStoreManagerPermission:U,queryGrades:g,queryStores:I,queryNotificationCount:W,queryShoppingCartCount:O,queryCurrentStore:M,queryMostNearbyStore:i,messageHistory:[],grades:[],stores:[],notificationCount:0,headerHeight:0,bottomHeight:0,mallSettings:{},shoppingCartCount:0,currentStore:void 0,mostNearbyStore:void 0,userAuthResult:void 0,adminAuthResult:void 0,adminPermissions:void 0,storeUserAuthResult:void 0,storeManagerAuthResult:void 0,managerPermissions:void 0,get user(){var a;return(a=this.userAuthResult)===null||a===void 0?void 0:a.User},get admin(){var a;return(a=this.adminAuthResult)===null||a===void 0?void 0:a.Admin},get storeUser(){var a;return(a=this.storeUserAuthResult)===null||a===void 0?void 0:a.StoreUser},get storeManager(){var a;return(a=this.storeManagerAuthResult)===null||a===void 0?void 0:a.StoreManager}}),h=function(){return(0,b.ey)(P)}},55793:function(N,S,e){e.d(S,{$z:function(){return R},Ac:function(){return O},Vl:function(){return o},fn:function(){return g},ur:function(){return W}});var L=e(15009),t=e.n(L),j=e(99289),f=e.n(j),A=e(76857),m=e(66419),b=e(98005),c=e.n(b),R=function(){return["jpg","jpeg","png","gif"]},o=function(i){var u,v=((u=(0,m.mD)(i))===null||u===void 0?void 0:u.toLowerCase())||"";return R().indexOf(v)>=0},_=function(i,u,v,p){return new Promise(function(U,n){var x=new(c())(i,{maxHeight:u,maxWidth:v,quality:p,success:function(h){U(h)},error:function(h){n(h)}});console.log(x)})},W=function(){var M=f()(t()().mark(function i(u,v){var p,U,n,x;return t()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(u.size<=v)){h.next=2;break}return h.abrupt("return",u);case 2:return h.next=4,_(u,void 0,void 0,.9);case 4:if(u=h.sent,!(u.size<=v)){h.next=7;break}return h.abrupt("return",u);case 7:p=5,U=300,n=1e3,x=0;case 11:if(!(++x<=p)){h.next=22;break}return h.next=14,_(u,n,n,1);case 14:if(u=h.sent,!(u.size<=v)){h.next=17;break}return h.abrupt("return",u);case 17:if(n-=U,!(n<=0)){h.next=20;break}return h.abrupt("break",22);case 20:h.next=11;break;case 22:return h.abrupt("return",u);case 23:case"end":return h.stop()}},i)}));return function(u,v){return M.apply(this,arguments)}}(),g=function(){var M=f()(t()().mark(function i(u){var v,p;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,I([u]);case 2:if(v=n.sent,p=v.at(0),p){n.next=6;break}throw new Error("response error");case 6:return n.abrupt("return",p);case 7:case"end":return n.stop()}},i)}));return function(u){return M.apply(this,arguments)}}(),I=function(){var M=f()(t()().mark(function i(u){var v,p;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return v=new FormData,u.forEach(function(x,P){v.append("formFileCollection",x,x.name)}),n.next=4,A.M.post("/api/platform/storage/upload",v);case 4:if(p=n.sent,!p.data.Error){n.next=7;break}throw new Error(p.data.Error.Message||"upload error");case 7:return n.abrupt("return",p.data.Data||[]);case 8:case"end":return n.stop()}},i)}));return function(u){return M.apply(this,arguments)}}(),O=function(i){return new Promise(function(u,v){var p=new FileReader;p.onload=function(){u(p.result)},p.onerror=function(U){v(U)},p.readAsDataURL(i)})}}}]);

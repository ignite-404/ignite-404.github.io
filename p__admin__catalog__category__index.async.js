"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2275],{74590:function(w,U,e){var C=e(15009),l=e.n(C),E=e(99289),o=e.n(E),D=e(5574),c=e.n(D),A=e(83062),b=e(14726),I=e(67294),i=e(85893);U.Z=function(_){var R=_.action,p=_.confirmText,j=_.hide,W=(0,I.useState)(!1),h=c()(W,2),u=h[0],r=h[1],d=p||"\u786E\u5B9A\u5220\u9664\uFF1F",t=function(){var M=o()(l()().mark(function n(){return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(confirm(d)){T.next=2;break}return T.abrupt("return");case 2:return r(!0),T.prev=3,T.next=6,R();case 6:return T.prev=6,r(!1),T.finish(6);case 9:case"end":return T.stop()}},n,null,[[3,,6,9]])}));return function(){return M.apply(this,arguments)}}();return j?null:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(A.Z,{title:d,children:(0,i.jsx)(b.ZP,{loading:u,danger:!0,type:"link",onClick:function(){t()},children:"\u5220\u9664"})})})}},93338:function(w,U,e){var C=e(97857),l=e.n(C),E=e(15009),o=e.n(E),D=e(99289),c=e.n(D),A=e(82052),b=e(68421),I=e(9383),i=e(67294),_=e(85893);U.Z=function(R){var p=R.width,j=R.rate,W=(0,i.useRef)(null),h=(0,A.Z)(W),u=h==null?void 0:h.width,r=function(){var t=c()(o()().mark(function M(){return o()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(j!=null&&u!=null)){m.next=2;break}return m.abrupt("return",u*j);case 2:return m.abrupt("return",void 0);case 3:case"end":return m.stop()}},M)}));return function(){return t.apply(this,arguments)}}(),d=(0,b.Z)(r,{manual:!0,debounceWait:30});return(0,i.useEffect)(function(){d.run()},[u]),(0,_.jsx)("div",{ref:W,style:{display:"block",padding:0,margin:0,width:p!=null?p:"100%"},children:(0,_.jsx)(I.J,l()({width:u||void 0,height:d.data||void 0,radius:"none"},R))})}},48382:function(w,U,e){var C=e(5574),l=e.n(C),E=e(98163),o=e(7134),D=e(55241),c=e(67294),A=e(35291),b=e(66419),I=e(93338),i=e(85893);U.Z=function(_){var R=_.data,p=_.count,j=(0,c.useState)(void 0),W=l()(j,2),h=W[0],u=W[1],r=R||[],d=p||3,t=r.map(function(n){return(0,A.u2)(n)}),M=function(m){return(0,i.jsx)("div",{style:{maxWidth:500},children:(0,i.jsx)(I.Z,{src:m.small||"",alt:""})})};return(0,b.G5)(t)?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{display:"none"},children:(0,i.jsx)(E.Z.PreviewGroup,{preview:{current:Math.max(h||0,0),visible:h!=null,onVisibleChange:function(m,T,s){u(m?s:void 0)},onChange:function(m){h!=null&&u(m)}},children:t.map(function(n,m){return(0,i.jsx)(E.Z,{src:n.large||"",alt:""},m)})})}),(0,i.jsx)("div",{style:{},children:(0,i.jsx)(o.C.Group,{maxCount:d,shape:"square",children:t.map(function(n,m){return(0,i.jsx)(D.Z,{title:"\u9884\u89C8",content:M(n),placement:"left",children:(0,i.jsx)(o.C,{style:{backgroundColor:"gray"},src:n.small||"",size:"large",onClick:function(){u(m)}})},m)})})})]})}},23806:function(w,U,e){var C=e(1288),l=e(85893);U.Z=function(E){var o=E.model,D=E.fallback;if(o==null||o==null)return null;var c=o==null?void 0:o.CreationTime,A=o==null?void 0:o.LastModificationTime;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{style:{},children:[(0,l.jsx)("div",{children:(0,l.jsx)(C.Z,{prefix:(0,l.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:c,fallback:D})}),(0,l.jsx)("div",{children:(0,l.jsx)(C.Z,{prefix:(0,l.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:A,fallback:D})})]})})}},1288:function(w,U,e){var C=e(78957),l=e(83062),E=e(46629),o=e(85893);U.Z=function(D){var c,A=D.timeStr,b=D.fallback,I=D.onlyDate,i=D.prefix,_=(c=(0,E.mg)(A))===null||c===void 0?void 0:c.add(E.Mg,"hour");if(!_)return b||null;var R=(0,E.ND)().utc().add(E.Mg,"hour"),p=_.isSame(R,"year"),j=_.diff(R,"day"),W=p?_.format(E.AK):_.format(E.vc),h=function(){return(0,o.jsxs)("div",{children:[(0,o.jsxs)(C.Z,{direction:"horizontal",children:[(0,o.jsx)("div",{children:_.fromNow()}),(0,o.jsx)("div",{children:_.format(E.On)})]}),(0,o.jsx)("div",{children:_.format(E.t9)})]})};return(0,o.jsx)(l.Z,{title:h(),children:(0,o.jsxs)(C.Z,{direction:"horizontal",children:[i,(0,o.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:I?_.format(E.vc):_.format(E.dq)})]})})}},8045:function(w,U,e){var C=e(97857),l=e.n(C),E=e(14726),o=e(67294),D=e(85893);U.Z=function(c){var A=c.loading,b=c.inputProps,I=c.onSelect,i=c.uploadButtonProps,_=(0,o.useRef)(null);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{style:{display:"none"},children:(0,D.jsx)("input",l()(l()({ref:_,type:"file",multiple:!1},b),{},{onChange:function(p){try{var j=p.target.files;j&&I&&I(j)}finally{_.current&&(_.current.value="",_.current.files=null)}}}))}),(0,D.jsx)(E.ZP,l()(l()({size:"small",loading:A,type:"dashed"},i),{},{onClick:function(){var p;(p=_.current)===null||p===void 0||p.click()},children:"\u9009\u62E9\u56FE\u7247"}))]})}},6786:function(w,U,e){var C=e(15009),l=e.n(C),E=e(99289),o=e.n(E),D=e(97857),c=e.n(D),A=e(98163),b=e(45360),I=e(14726),i=e(78957),_=e(85134),R=e(55932),p=e(55793),j=e(66419),W=e(8045),h=e(68421),u=e(85893);U.Z=function(r){var d=r.data,t=r.ok,M=r.remove,n=r.loadingSave,m=r.width,T=r.defaultImage,s=r.imageProps,ne=r.uploadButtonProps,Q=r.removeButtonProps,X=(0,R.Kk)(d,{width:m||100}),J=function(){var S=X||T;return(0,j.Wq)(S)?null:(0,u.jsx)(A.Z,c()({src:S||"",alt:"",width:m||50},s))},ae=function(){var N=o()(l()().mark(function S(x){var L;return l()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(O.prev=0,(0,p.Vl)(x.name)){O.next=4;break}return b.ZP.error("\u53EA\u652F\u6301 ".concat((0,p.$z)().join("\u3001")," \u683C\u5F0F\u7684\u56FE\u7247")),O.abrupt("return");case 4:return O.next=6,(0,p.ur)(x,_.v.upload.max_size);case 6:if(x=O.sent,!(x.size>_.v.upload.max_size)){O.next=10;break}return b.ZP.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC71MB"),O.abrupt("return");case 10:return O.next=12,(0,p.fn)(x);case 12:L=O.sent,L&&t&&t(L),O.next=20;break;case 16:O.prev=16,O.t0=O.catch(0),console.log(O.t0),b.ZP.error("\u4E0A\u4F20\u9047\u5230\u9519\u8BEF");case 20:case"end":return O.stop()}},S,null,[[0,16]])}));return function(x){return N.apply(this,arguments)}}(),a=(0,h.Z)(ae,{manual:!0}),re=function(){return(0,j.Wq)(X)||!M?null:(0,u.jsx)(I.ZP,c()(c()({size:"small",type:"dashed",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&M&&M()}},Q),{},{children:"\u79FB\u9664\u56FE\u7247"}))};return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)(i.Z,{direction:"horizontal",children:[J(),(0,u.jsxs)(i.Z,{direction:"vertical",children:[(0,u.jsx)(W.Z,{loading:n||a.loading,inputProps:{accept:"image/*",multiple:!1},onSelect:function(S){var x=S.item(0);x&&a.run(x)},uploadButtonProps:ne}),re()]})]})})}},53989:function(w,U,e){e.r(U),e.d(U,{default:function(){return S}});var C=e(15009),l=e.n(C),E=e(99289),o=e.n(E),D=e(5574),c=e.n(D),A=e(78957),b=e(66309),I=e(40411),i=e(14726),_=e(45360),R=e(4393),p=e(80799),j=e(67294),W=e(74590),h=e(48382),u=e(23806),r=e(35291),d=e(30699),t=e(66419),M=e(97857),n=e.n(M),m=e(85576),T=e(57381),s=e(11346),ne=e(59847),Q=e(25278),X=e(24435),J=e(72269),ae=e(6786),a=e(85893),re=function(x){var L=x.show,Y=x.hide,O=x.data,k=x.ok,ue=(0,j.useState)(!1),q=c()(ue,2),G=q[0],z=q[1],H=(0,j.useState)([]),$=c()(H,2),te=$[0],y=$[1],B=(0,j.useState)([]),P=c()(B,2),g=P[0],F=P[1],ee=(0,j.useState)({}),se=c()(ee,2),f=se[0],Z=se[1],oe=function(){z(!0),d.x1.mallAdmin.categoryQueryAntdTree({}).then(function(v){(0,t._y)(v,function(){var V=v.data.Data||[];y(V);var le=V.flatMap(function(_e){return(0,r.PC)(_e)}).map(function(_e){return _e.key});F(le)})}).finally(function(){z(!1)})},ie=function(v){var V;v.Name=(V=v.Name)===null||V===void 0?void 0:V.trim(),!(0,t.Wq)(v.Name)&&(z(!0),d.x1.mallAdmin.categorySaveCategory(n()({},v)).then(function(le){(0,t._y)(le,function(){_.ZP.success("\u4FDD\u5B58\u6210\u529F"),k()})}).finally(function(){z(!1)}))};return(0,j.useEffect)(function(){Z(n()({},O))},[O]),(0,j.useEffect)(function(){L?oe():Z({})},[L]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(m.Z,{title:"\u5206\u7C7B",confirmLoading:G,open:L,onCancel:function(){return Y()},footer:(0,a.jsx)(A.Z,{children:(0,a.jsx)(i.ZP,{type:"primary",loading:G,onClick:function(){ie(f)},children:"\u4FDD\u5B58"})}),children:(0,a.jsx)(T.Z,{spinning:G,children:(0,a.jsxs)(s.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,a.jsx)(s.Z.Item,{label:"\u56FE\u7247",children:(0,a.jsx)(ae.Z,{loadingSave:G,data:f.Picture||{},ok:function(v){Z(n()(n()({},f),{},{PictureMetaId:v.Id,Picture:v}))},remove:function(){confirm("\u786E\u5B9A\u5220\u9664\u56FE\u7247\u5417\uFF1F")&&Z(n()(n()({},f),{},{PictureMetaId:void 0,Picture:void 0}))}})}),(0,a.jsx)(s.Z.Item,{label:"\u7236\u7EA7",children:(0,a.jsx)(ne.Z,{placeholder:"\u65E0\u7236\u7EA7\u5206\u7C7B\u5219\u89C6\u4E3A\u9876\u7EA7\u5206\u7C7B",treeData:te.map(function(K){return(0,r.iw)(K)}),treeExpandedKeys:g,onTreeExpand:function(v){return F(v)},allowClear:!0,value:f.ParentId||void 0,onChange:function(v){if(!(0,t.Wq)(f.Id)&&v==f.Id){_.ZP.error("\u65E0\u6CD5\u6307\u5B9A\u8BE5\u8282\u70B9");return}Z(n()(n()({},f),{},{ParentId:v}))}})}),(0,a.jsxs)(s.Z.Item,{label:"\u540D\u79F0",required:!0,children:[(0,a.jsx)(Q.Z,{count:{show:!0,max:20},maxLength:20,required:!0,value:f.Name||"",onChange:function(v){Z(n()(n()({},f),{},{Name:v.target.value}))}}),(0,t.Wq)(f.Name)&&(0,a.jsx)("p",{style:{color:"red"},children:"\u5FC5\u586B"})]}),(0,a.jsx)(s.Z.Item,{label:"SeoName",children:(0,a.jsx)(Q.Z,{maxLength:20,value:f.SeoName||"",onChange:function(v){Z(n()(n()({},f),{},{SeoName:v.target.value}))}})}),(0,a.jsx)(s.Z.Item,{label:"\u63CF\u8FF0",children:(0,a.jsx)(Q.Z.TextArea,{maxLength:50,value:f.Description||"",onChange:function(v){Z(n()(n()({},f),{},{Description:v.target.value}))}})}),(0,a.jsx)(s.Z.Item,{label:"\u6392\u5E8F",children:(0,a.jsx)(X.Z,{value:f.DisplayOrder,onChange:function(v){Z(n()(n()({},f),{},{DisplayOrder:v||0}))}})}),(0,a.jsx)(s.Z.Item,{label:"\u63A8\u8350",children:(0,a.jsx)(J.Z,{checked:f.Recommend,onChange:function(v){Z(n()(n()({},f),{},{Recommend:v}))}})}),(0,a.jsx)(s.Z.Item,{label:"\u53EF\u7528",children:(0,a.jsx)(J.Z,{checked:f.Published,onChange:function(v){Z(n()(n()({},f),{},{Published:v}))}})}),(0,a.jsx)(s.Z.Item,{label:"\u9996\u9875\u5C55\u793A",children:(0,a.jsx)(J.Z,{checked:f.ShowOnHomePage,onChange:function(v){Z(n()(n()({},f),{},{ShowOnHomePage:v}))}})})]})})})})},N=e(68421),S=function(){var x,L=(0,N.Z)(d.x1.mallAdmin.categoryQueryAntdTree,{manual:!0,onSuccess:function(B){var P=B.data.Data||[],g=P.flatMap(function(F){return(0,r.PC)(F)}).map(function(F){return F.key||""})}}),Y=((x=L.data)===null||x===void 0||(x=x.data)===null||x===void 0?void 0:x.Data)||[],O=(0,j.useState)([]),k=c()(O,2),ue=k[0],q=k[1],G=(0,j.useState)(void 0),z=c()(G,2),H=z[0],$=z[1],te=[{title:"\u540D\u79F0",render:function(B,P){return P.title}},{title:"SeoName",render:function(B,P){var g;return((g=P.raw_data)===null||g===void 0?void 0:g.SeoName)||"--"}},{title:"\u63CF\u8FF0",render:function(B,P){var g;return(g=P.raw_data)===null||g===void 0?void 0:g.Description}},{title:"\u56FE\u7247",render:function(B,P){var g=P.raw_data||{};return g.Picture?(0,a.jsx)(h.Z,{data:[g.Picture]}):null}},{title:"\u6392\u5E8F",render:function(B,P){var g;return(g=P.raw_data)===null||g===void 0?void 0:g.DisplayOrder}},{title:"\u6807\u8BB0",render:function(B,P){var g=P.raw_data||{};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(A.Z,{direction:"vertical",children:[g.Recommend&&(0,a.jsx)(b.Z,{color:"red",children:"\u63A8\u8350"}),g.ShowOnHomePage&&(0,a.jsx)(b.Z,{color:"green",children:"\u9996\u9875\u5C55\u793A"})]})})}},{title:"\u72B6\u6001",render:function(B,P){var g=P.raw_data||{};return(0,a.jsxs)(a.Fragment,{children:[g.Published&&(0,a.jsx)(I.Z,{status:"success",text:"\u53EF\u7528"}),g.Published||(0,a.jsx)(I.Z,{status:"error",text:"\u4E0D\u53EF\u7528"})]})}},{title:"\u65F6\u95F4",render:function(B,P){return(0,a.jsx)(u.Z,{model:P.raw_data})}},{title:"\u64CD\u4F5C",width:200,render:function(B,P){return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(A.Z,{direction:"horizontal",children:[(0,a.jsx)(i.ZP,{type:"link",onClick:function(){$(P)},children:"\u7F16\u8F91"}),(0,t.G5)(P.children)&&(0,a.jsx)(W.Z,{action:o()(l()().mark(function g(){var F,ee;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,d.x1.mallAdmin.categoryDelete({Id:(F=P.raw_data)===null||F===void 0?void 0:F.Id});case 2:ee=f.sent,(0,t._y)(ee,function(){_.ZP.success("\u5220\u9664\u6210\u529F"),L.run()});case 4:case"end":return f.stop()}},g)}))})]})})}}];return(0,j.useEffect)(function(){L.run()},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(re,{show:H!=null,hide:function(){return $(void 0)},data:(H==null?void 0:H.raw_data)||{},ok:function(){$(void 0),L.run()}}),(0,a.jsx)(R.Z,{title:"\u4EA7\u54C1\u5206\u7C7B",extra:(0,a.jsx)(i.ZP,{type:"primary",onClick:function(){$({})},children:"\u65B0\u589E"}),children:(0,a.jsx)(p.Z,{rowKey:function(B){return B.key||""},expandable:{expandedRowKeys:ue,defaultExpandAllRows:!0,showExpandColumn:!0,onExpandedRowsChange:function(B){q(B)}},loading:L.loading,columns:te,dataSource:Y,pagination:!1})})]})}},55793:function(w,U,e){e.d(U,{$z:function(){return I},Ac:function(){return W},Vl:function(){return i},fn:function(){return p},ur:function(){return R}});var C=e(15009),l=e.n(C),E=e(99289),o=e.n(E),D=e(76857),c=e(66419),A=e(98005),b=e.n(A),I=function(){return["jpg","jpeg","png","gif"]},i=function(u){var r,d=((r=(0,c.mD)(u))===null||r===void 0?void 0:r.toLowerCase())||"";return I().indexOf(d)>=0},_=function(u,r,d,t){return new Promise(function(M,n){var m=new(b())(u,{maxHeight:r,maxWidth:d,quality:t,success:function(s){M(s)},error:function(s){n(s)}});console.log(m)})},R=function(){var h=o()(l()().mark(function u(r,d){var t,M,n,m;return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(r.size<=d)){s.next=2;break}return s.abrupt("return",r);case 2:return s.next=4,_(r,void 0,void 0,.9);case 4:if(r=s.sent,!(r.size<=d)){s.next=7;break}return s.abrupt("return",r);case 7:t=5,M=300,n=1e3,m=0;case 11:if(!(++m<=t)){s.next=22;break}return s.next=14,_(r,n,n,1);case 14:if(r=s.sent,!(r.size<=d)){s.next=17;break}return s.abrupt("return",r);case 17:if(n-=M,!(n<=0)){s.next=20;break}return s.abrupt("break",22);case 20:s.next=11;break;case 22:return s.abrupt("return",r);case 23:case"end":return s.stop()}},u)}));return function(r,d){return h.apply(this,arguments)}}(),p=function(){var h=o()(l()().mark(function u(r){var d,t;return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,j([r]);case 2:if(d=n.sent,t=d.at(0),t){n.next=6;break}throw new Error("response error");case 6:return n.abrupt("return",t);case 7:case"end":return n.stop()}},u)}));return function(r){return h.apply(this,arguments)}}(),j=function(){var h=o()(l()().mark(function u(r){var d,t;return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return d=new FormData,r.forEach(function(m,T){d.append("formFileCollection",m,m.name)}),n.next=4,D.M.post("/api/platform/storage/upload",d);case 4:if(t=n.sent,!t.data.Error){n.next=7;break}throw new Error(t.data.Error.Message||"upload error");case 7:return n.abrupt("return",t.data.Data||[]);case 8:case"end":return n.stop()}},u)}));return function(r){return h.apply(this,arguments)}}(),W=function(u){return new Promise(function(r,d){var t=new FileReader;t.onload=function(){r(t.result)},t.onerror=function(M){d(M)},t.readAsDataURL(u)})}}}]);

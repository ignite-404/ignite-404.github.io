"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2275],{74590:function(w,A,e){var T=e(15009),s=e.n(T),h=e(99289),_=e.n(h),j=e(5574),m=e.n(j),b=e(83062),U=e(28036),I=e(67294),d=e(85893);A.Z=function(l){var R=l.action,C=l.confirmText,v=l.hide,K=(0,I.useState)(!1),g=m()(K,2),o=g[0],r=g[1],i=C||"\u786E\u5B9A\u5220\u9664\uFF1F",t=function(){var O=_()(s()().mark(function n(){return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(confirm(i)){p.next=2;break}return p.abrupt("return");case 2:return r(!0),p.prev=3,p.next=6,R();case 6:return p.prev=6,r(!1),p.finish(6);case 9:case"end":return p.stop()}},n,null,[[3,,6,9]])}));return function(){return O.apply(this,arguments)}}();return v?null:(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(b.Z,{title:i,children:(0,d.jsx)(U.ZP,{loading:o,danger:!0,type:"link",onClick:function(){t()},children:"\u5220\u9664"})})})}},23806:function(w,A,e){var T=e(1288),s=e(85893);A.Z=function(h){var _=h.model,j=h.fallback;if(_==null||_==null)return null;var m=_==null?void 0:_.CreationTime,b=_==null?void 0:_.LastModificationTime;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{style:{},children:[(0,s.jsx)("div",{children:(0,s.jsx)(T.Z,{prefix:(0,s.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:m,fallback:j})}),(0,s.jsx)("div",{children:(0,s.jsx)(T.Z,{prefix:(0,s.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:b,fallback:j})})]})})}},1288:function(w,A,e){var T=e(78957),s=e(83062),h=e(46629),_=e(85893);A.Z=function(j){var m,b=j.timeStr,U=j.fallback,I=j.onlyDate,d=j.prefix,l=(m=(0,h.QW)(b))===null||m===void 0?void 0:m.local();if(!l)return U||null;var R=(0,h.ND)().utc().local(),C=l.isSame(R,"year"),v=l.diff(R,"day"),K=C?l.format(h.AK):l.format(h.vc),g=function(){return(0,_.jsxs)("div",{children:[(0,_.jsxs)(T.Z,{direction:"horizontal",children:[(0,_.jsx)("div",{children:l.fromNow()}),(0,_.jsx)("div",{children:l.format(h.On)})]}),(0,_.jsx)("div",{children:l.format(h.t9)})]})};return(0,_.jsx)(s.Z,{title:g(),children:(0,_.jsxs)(T.Z,{direction:"horizontal",children:[d,(0,_.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:I?l.format(h.vc):l.format(h.dq)})]})})}},94442:function(w,A,e){var T=e(97857),s=e.n(T),h=e(15009),_=e.n(h),j=e(99289),m=e.n(j),b=e(5574),U=e.n(b),I=e(82052),d=e(68421),l=e(18207),R=e(67294),C=e(85893);A.Z=function(v){var K=v.width,g=v.rate,o=v.minHeightBeforeLoaded,r=(0,R.useState)(!1),i=U()(r,2),t=i[0],O=i[1],n=function(){if(!t)return o||void 0},E=(0,R.useRef)(null),p=(0,I.Z)(E),u=p==null?void 0:p.width,Y=function(){var $=m()(_()().mark(function N(){return _()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(g!=null&&u!=null)){a.next=2;break}return a.abrupt("return",u*g);case 2:return a.abrupt("return",void 0);case 3:case"end":return a.stop()}},N)}));return function(){return $.apply(this,arguments)}}(),z=(0,d.Z)(Y,{manual:!0,debounceWait:90});return(0,R.useEffect)(function(){z.run()},[u,g]),(0,C.jsx)("div",{ref:E,style:{display:"block",width:K!=null?K:"100%"},children:(0,C.jsx)(l.J,s()({showSkeleton:!0,width:u||void 0,height:z.data||void 0,radius:"none",onLoad:function(){O(!0)},style:{minHeight:n()||void 0}},v))})}},80427:function(w,A,e){var T=e(5574),s=e.n(T),h=e(98163),_=e(7134),j=e(55241),m=e(67294),b=e(35291),U=e(95813),I=e(94442),d=e(85893);A.Z=function(l){var R=l.data,C=l.count,v=(0,m.useState)(void 0),K=s()(v,2),g=K[0],o=K[1],r=R||[],i=C||3,t=r.map(function(n){return(0,b.u2)(n)}),O=function(E){return(0,d.jsx)("div",{style:{maxWidth:500},children:(0,d.jsx)(I.Z,{src:E.small||"",alt:""})})};return(0,U.G5)(t)?null:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{style:{display:"none"},children:(0,d.jsx)(h.Z.PreviewGroup,{preview:{current:Math.max(g||0,0),visible:g!=null,onVisibleChange:function(E,p,u){o(E?u:void 0)},onChange:function(E){g!=null&&o(E)}},children:t.map(function(n,E){return(0,d.jsx)(h.Z,{src:n.large||"",alt:""},E)})})}),(0,d.jsx)("div",{style:{},children:(0,d.jsx)(_.C.Group,{maxCount:i,shape:"square",children:t.map(function(n,E){return(0,d.jsx)(j.Z,{title:"\u9884\u89C8",content:O(n),placement:"left",children:(0,d.jsx)(_.C,{style:{backgroundColor:"gray"},src:n.small||"",size:"large",onClick:function(){o(E)}})},E)})})})]})}},8045:function(w,A,e){var T=e(97857),s=e.n(T),h=e(28036),_=e(67294),j=e(85893);A.Z=function(m){var b=m.loading,U=m.inputProps,I=m.onSelect,d=m.uploadButtonProps,l=(0,_.useRef)(null);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{style:{display:"none"},children:(0,j.jsx)("input",s()(s()({ref:l,type:"file",multiple:!1},U),{},{onChange:function(C){try{var v=C.target.files;v&&I&&I(v)}finally{l.current&&(l.current.value="",l.current.files=null)}}}))}),(0,j.jsx)(h.ZP,s()(s()({size:"small",loading:b,type:"dashed"},d),{},{onClick:function(){var C;(C=l.current)===null||C===void 0||C.click()},children:"\u9009\u62E9\u56FE\u7247"}))]})}},6786:function(w,A,e){var T=e(15009),s=e.n(T),h=e(99289),_=e.n(h),j=e(97857),m=e.n(j),b=e(98163),U=e(45360),I=e(28036),d=e(78957),l=e(85134),R=e(55932),C=e(55793),v=e(95813),K=e(8045),g=e(68421),o=e(85893);A.Z=function(r){var i=r.data,t=r.ok,O=r.remove,n=r.loadingSave,E=r.width,p=r.defaultImage,u=r.imageProps,Y=r.uploadButtonProps,z=r.removeButtonProps,$=(0,R.Kk)(i,{width:E||100}),N=function(){var S=$||p;return(0,v.Wq)(S)?null:(0,o.jsx)(b.Z,m()({src:S||"",alt:"",width:E||50},u))},k=function(){var V=_()(s()().mark(function S(x){var W;return s()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(M.prev=0,(0,C.Vl)(x.name)){M.next=4;break}return U.ZP.error("\u53EA\u652F\u6301 ".concat((0,C.$z)().join("\u3001")," \u683C\u5F0F\u7684\u56FE\u7247")),M.abrupt("return");case 4:return M.next=6,(0,C.ur)(x,l.vc.upload.max_size);case 6:if(x=M.sent,!(x.size>l.vc.upload.max_size)){M.next=10;break}return U.ZP.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC71MB"),M.abrupt("return");case 10:return M.next=12,(0,C.fn)(x);case 12:W=M.sent,W&&t&&t(W),M.next=20;break;case 16:M.prev=16,M.t0=M.catch(0),console.log(M.t0),U.ZP.error("\u4E0A\u4F20\u9047\u5230\u9519\u8BEF");case 20:case"end":return M.stop()}},S,null,[[0,16]])}));return function(x){return V.apply(this,arguments)}}(),a=(0,g.Z)(k,{manual:!0}),re=function(){return(0,v.Wq)($)||!O?null:(0,o.jsx)(I.ZP,m()(m()({size:"small",type:"dashed",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&O&&O()}},z),{},{children:"\u79FB\u9664\u56FE\u7247"}))};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(d.Z,{direction:"horizontal",children:[N(),(0,o.jsxs)(d.Z,{direction:"vertical",children:[(0,o.jsx)(K.Z,{loading:n||a.loading,inputProps:{accept:"image/*",multiple:!1},onSelect:function(S){var x=S.item(0);x&&a.run(x)},uploadButtonProps:Y}),re()]})]})})}},53989:function(w,A,e){e.r(A),e.d(A,{default:function(){return S}});var T=e(15009),s=e.n(T),h=e(99289),_=e.n(h),j=e(5574),m=e.n(j),b=e(78957),U=e(66309),I=e(40411),d=e(28036),l=e(45360),R=e(4393),C=e(80799),v=e(67294),K=e(74590),g=e(80427),o=e(23806),r=e(35291),i=e(30699),t=e(95813),O=e(97857),n=e.n(O),E=e(85576),p=e(57381),u=e(11346),Y=e(39019),z=e(65233),$=e(24435),N=e(72269),k=e(6786),a=e(85893),re=function(x){var W=x.show,q=x.hide,M=x.data,ee=x.ok,ue=(0,v.useState)(!1),ne=m()(ue,2),Q=ne[0],G=ne[1],J=(0,v.useState)([]),H=m()(J,2),te=H[0],y=H[1],B=(0,v.useState)([]),P=m()(B,2),D=P[0],F=P[1],ae=(0,v.useState)({}),se=m()(ae,2),c=se[0],Z=se[1],oe=function(){G(!0),i.x1.mallAdmin.categoryQueryAntdTree({}).then(function(f){(0,t._y)(f,function(){var X=f.data.Data||[];y(X);var _e=X.flatMap(function(le){return(0,r.PC)(le)}).map(function(le){return le.key});F(_e)})}).finally(function(){G(!1)})},ie=function(f){var X;f.Name=(X=f.Name)===null||X===void 0?void 0:X.trim(),!(0,t.Wq)(f.Name)&&(G(!0),i.x1.mallAdmin.categorySaveCategory(n()({},f)).then(function(_e){(0,t._y)(_e,function(){l.ZP.success("\u4FDD\u5B58\u6210\u529F"),ee()})}).finally(function(){G(!1)}))};return(0,v.useEffect)(function(){Z(n()({},M))},[M]),(0,v.useEffect)(function(){W?oe():Z({})},[W]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E.Z,{title:"\u5206\u7C7B",confirmLoading:Q,open:W,onCancel:function(){return q()},footer:(0,a.jsx)(b.Z,{children:(0,a.jsx)(d.ZP,{type:"primary",loading:Q,onClick:function(){ie(c)},children:"\u4FDD\u5B58"})}),children:(0,a.jsx)(p.Z,{spinning:Q,children:(0,a.jsxs)(u.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,a.jsx)(u.Z.Item,{label:"\u56FE\u7247",children:(0,a.jsx)(k.Z,{loadingSave:Q,data:c.Picture||{},ok:function(f){Z(n()(n()({},c),{},{PictureMetaId:f.Id,Picture:f}))},remove:function(){confirm("\u786E\u5B9A\u5220\u9664\u56FE\u7247\u5417\uFF1F")&&Z(n()(n()({},c),{},{PictureMetaId:void 0,Picture:void 0}))}})}),(0,a.jsx)(u.Z.Item,{label:"\u7236\u7EA7",children:(0,a.jsx)(Y.Z,{placeholder:"\u65E0\u7236\u7EA7\u5206\u7C7B\u5219\u89C6\u4E3A\u9876\u7EA7\u5206\u7C7B",treeData:te.map(function(L){return(0,r.iw)(L)}),treeExpandedKeys:D,onTreeExpand:function(f){return F(f)},allowClear:!0,value:c.ParentId||void 0,onChange:function(f){if(!(0,t.Wq)(c.Id)&&f==c.Id){l.ZP.error("\u65E0\u6CD5\u6307\u5B9A\u8BE5\u8282\u70B9");return}Z(n()(n()({},c),{},{ParentId:f}))}})}),(0,a.jsxs)(u.Z.Item,{label:"\u540D\u79F0",required:!0,children:[(0,a.jsx)(z.Z,{count:{show:!0,max:20},maxLength:20,required:!0,value:c.Name||"",onChange:function(f){Z(n()(n()({},c),{},{Name:f.target.value}))}}),(0,t.Wq)(c.Name)&&(0,a.jsx)("p",{style:{color:"red"},children:"\u5FC5\u586B"})]}),(0,a.jsx)(u.Z.Item,{label:"SeoName",children:(0,a.jsx)(z.Z,{maxLength:20,value:c.SeoName||"",onChange:function(f){Z(n()(n()({},c),{},{SeoName:f.target.value}))}})}),(0,a.jsx)(u.Z.Item,{label:"\u63CF\u8FF0",children:(0,a.jsx)(z.Z.TextArea,{maxLength:50,value:c.Description||"",onChange:function(f){Z(n()(n()({},c),{},{Description:f.target.value}))}})}),(0,a.jsx)(u.Z.Item,{label:"\u6392\u5E8F",children:(0,a.jsx)($.Z,{value:c.DisplayOrder,onChange:function(f){Z(n()(n()({},c),{},{DisplayOrder:f||0}))}})}),(0,a.jsx)(u.Z.Item,{label:"\u63A8\u8350",children:(0,a.jsx)(N.Z,{checked:c.Recommend,onChange:function(f){Z(n()(n()({},c),{},{Recommend:f}))}})}),(0,a.jsx)(u.Z.Item,{label:"\u53EF\u7528",children:(0,a.jsx)(N.Z,{checked:c.Published,onChange:function(f){Z(n()(n()({},c),{},{Published:f}))}})}),(0,a.jsx)(u.Z.Item,{label:"\u9996\u9875\u5C55\u793A",children:(0,a.jsx)(N.Z,{checked:c.ShowOnHomePage,onChange:function(f){Z(n()(n()({},c),{},{ShowOnHomePage:f}))}})})]})})})})},V=e(68421),S=function(){var x,W=(0,V.Z)(i.x1.mallAdmin.categoryQueryAntdTree,{manual:!0,onSuccess:function(B){var P=B.data.Data||[],D=P.flatMap(function(F){return(0,r.PC)(F)}).map(function(F){return F.key||""})}}),q=((x=W.data)===null||x===void 0||(x=x.data)===null||x===void 0?void 0:x.Data)||[],M=(0,v.useState)([]),ee=m()(M,2),ue=ee[0],ne=ee[1],Q=(0,v.useState)(void 0),G=m()(Q,2),J=G[0],H=G[1],te=[{title:"\u540D\u79F0",render:function(B,P){return P.title}},{title:"SeoName",render:function(B,P){var D;return((D=P.raw_data)===null||D===void 0?void 0:D.SeoName)||"--"}},{title:"\u63CF\u8FF0",render:function(B,P){var D;return(D=P.raw_data)===null||D===void 0?void 0:D.Description}},{title:"\u56FE\u7247",render:function(B,P){var D=P.raw_data||{};return D.Picture?(0,a.jsx)(g.Z,{data:[D.Picture]}):null}},{title:"\u6392\u5E8F",render:function(B,P){var D;return(D=P.raw_data)===null||D===void 0?void 0:D.DisplayOrder}},{title:"\u6807\u8BB0",render:function(B,P){var D=P.raw_data||{};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(b.Z,{direction:"vertical",children:[D.Recommend&&(0,a.jsx)(U.Z,{color:"red",children:"\u63A8\u8350"}),D.ShowOnHomePage&&(0,a.jsx)(U.Z,{color:"green",children:"\u9996\u9875\u5C55\u793A"})]})})}},{title:"\u72B6\u6001",render:function(B,P){var D=P.raw_data||{};return(0,a.jsxs)(a.Fragment,{children:[D.Published&&(0,a.jsx)(I.Z,{status:"success",text:"\u53EF\u7528"}),D.Published||(0,a.jsx)(I.Z,{status:"error",text:"\u4E0D\u53EF\u7528"})]})}},{title:"\u65F6\u95F4",render:function(B,P){return(0,a.jsx)(o.Z,{model:P.raw_data})}},{title:"\u64CD\u4F5C",width:200,render:function(B,P){return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(b.Z,{direction:"horizontal",children:[(0,a.jsx)(d.ZP,{type:"link",onClick:function(){H(P)},children:"\u7F16\u8F91"}),(0,t.G5)(P.children)&&(0,a.jsx)(K.Z,{action:_()(s()().mark(function D(){var F,ae;return s()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,i.x1.mallAdmin.categoryDelete({Id:(F=P.raw_data)===null||F===void 0?void 0:F.Id});case 2:ae=c.sent,(0,t._y)(ae,function(){l.ZP.success("\u5220\u9664\u6210\u529F"),W.run()});case 4:case"end":return c.stop()}},D)}))})]})})}}];return(0,v.useEffect)(function(){W.run()},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(re,{show:J!=null,hide:function(){return H(void 0)},data:(J==null?void 0:J.raw_data)||{},ok:function(){H(void 0),W.run()}}),(0,a.jsx)(R.Z,{title:"\u4EA7\u54C1\u5206\u7C7B",extra:(0,a.jsx)(d.ZP,{type:"primary",onClick:function(){H({})},children:"\u65B0\u589E"}),children:(0,a.jsx)(C.Z,{rowKey:function(B){return B.key||""},expandable:{expandedRowKeys:ue,defaultExpandAllRows:!0,showExpandColumn:!0,onExpandedRowsChange:function(B){ne(B)}},loading:W.loading,columns:te,dataSource:q,pagination:!1})})]})}},55793:function(w,A,e){e.d(A,{$z:function(){return I},Ac:function(){return K},Vl:function(){return d},fn:function(){return C},ur:function(){return R}});var T=e(15009),s=e.n(T),h=e(99289),_=e.n(h),j=e(76857),m=e(95813),b=e(98005),U=e.n(b),I=function(){return["jpg","jpeg","png","gif"]},d=function(o){var r,i=((r=(0,m.mD)(o))===null||r===void 0?void 0:r.toLowerCase())||"";return I().indexOf(i)>=0},l=function(o,r,i,t){return new Promise(function(O,n){var E=new(U())(o,{maxHeight:r,maxWidth:i,quality:t,success:function(u){O(u)},error:function(u){n(u)}});console.log(E)})},R=function(){var g=_()(s()().mark(function o(r,i){var t,O,n,E;return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(r.size<=i)){u.next=2;break}return u.abrupt("return",r);case 2:return u.next=4,l(r,void 0,void 0,.9);case 4:if(r=u.sent,!(r.size<=i)){u.next=7;break}return u.abrupt("return",r);case 7:t=5,O=300,n=1e3,E=0;case 11:if(!(++E<=t)){u.next=22;break}return u.next=14,l(r,n,n,1);case 14:if(r=u.sent,!(r.size<=i)){u.next=17;break}return u.abrupt("return",r);case 17:if(n-=O,!(n<=0)){u.next=20;break}return u.abrupt("break",22);case 20:u.next=11;break;case 22:return u.abrupt("return",r);case 23:case"end":return u.stop()}},o)}));return function(r,i){return g.apply(this,arguments)}}(),C=function(){var g=_()(s()().mark(function o(r){var i,t;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v([r]);case 2:if(i=n.sent,t=i.at(0),t){n.next=6;break}throw new Error("response error");case 6:return n.abrupt("return",t);case 7:case"end":return n.stop()}},o)}));return function(r){return g.apply(this,arguments)}}(),v=function(){var g=_()(s()().mark(function o(r){var i,t;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=new FormData,r.forEach(function(E,p){i.append("formFileCollection",E,E.name)}),n.next=4,j.M.post("/api/platform/storage/upload",i);case 4:if(t=n.sent,!t.data.Error){n.next=7;break}throw new Error(t.data.Error.Message||"upload error");case 7:return n.abrupt("return",t.data.Data||[]);case 8:case"end":return n.stop()}},o)}));return function(r){return g.apply(this,arguments)}}(),K=function(o){return new Promise(function(r,i){var t=new FileReader;t.onload=function(){r(t.result)},t.onerror=function(O){i(O)},t.readAsDataURL(o)})}}}]);

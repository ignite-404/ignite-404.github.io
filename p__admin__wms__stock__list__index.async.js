"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[326],{96256:function(G,Z,e){var y=e(97857),a=e.n(y),h=e(19632),u=e.n(h),_=e(5574),D=e.n(_),P=e(85980),f=e(34041),T=e(57381),g=e(67294),l=e(85893);Z.Z=function(E){var n=E.onSearch,L=E.value,d=E.onChange,i=E.style,o=E.initItem,A=E.placeholder,m=E.props,x=(0,g.useState)(!1),N=D()(x,2),z=N[0],M=N[1],Q=(0,g.useState)([]),X=D()(Q,2),Y=X[0],ee=X[1],ne=(0,P.Z)(function(k){M(!0),n(k).then(function(j){ee(j||[])}).finally(function(){return M(!1)})},{wait:500});(0,g.useEffect)(function(){},[]);var te=function(){var j=u()(Y);return o&&!j.find(function(C){return C.value===o.value})&&j.push(o),j};return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(f.Z,a()({style:a()({minWidth:300},i),loading:z,value:L,showSearch:!0,allowClear:!0,filterOption:!1,onSearch:function(j){ne.run(j)},onChange:function(j){var C=Y.find(function(R){return R.value==j});d&&d(C)},onClear:function(){d&&d(void 0)},placeholder:A||"\u8F93\u5165\u5173\u952E\u8BCD",notFoundContent:z&&(0,l.jsx)(T.Z,{size:"small"}),options:te()},m))})}},23806:function(G,Z,e){var y=e(1288),a=e(85893);Z.Z=function(h){var u=h.model,_=h.fallback;if(u==null||u==null)return null;var D=u==null?void 0:u.CreationTime,P=u==null?void 0:u.LastModificationTime;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{style:{},children:[(0,a.jsx)("div",{children:(0,a.jsx)(y.Z,{prefix:(0,a.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:D,fallback:_})}),(0,a.jsx)("div",{children:(0,a.jsx)(y.Z,{prefix:(0,a.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:P,fallback:_})})]})})}},1288:function(G,Z,e){var y=e(78957),a=e(83062),h=e(46629),u=e(85893);Z.Z=function(_){var D,P=_.timeStr,f=_.fallback,T=_.onlyDate,g=_.prefix,l=(D=(0,h.mg)(P))===null||D===void 0?void 0:D.add(h.Mg,"hour");if(!l)return f||null;var E=(0,h.ND)().utc().add(h.Mg,"hour"),n=l.isSame(E,"year"),L=l.diff(E,"day"),d=n?l.format(h.AK):l.format(h.vc),i=function(){return(0,u.jsxs)("div",{children:[(0,u.jsxs)(y.Z,{direction:"horizontal",children:[(0,u.jsx)("div",{children:l.fromNow()}),(0,u.jsx)("div",{children:l.format(h.On)})]}),(0,u.jsx)("div",{children:l.format(h.t9)})]})};return(0,u.jsx)(a.Z,{title:i(),children:(0,u.jsxs)(y.Z,{direction:"horizontal",children:[g,(0,u.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:T?l.format(h.vc):l.format(h.dq)})]})})}},48746:function(G,Z,e){var y=e(15009),a=e.n(y),h=e(99289),u=e.n(h),_=e(96256),D=e(35291),P=e(30699),f=e(66419),T=e(85893);Z.Z=function(g){var l=g.selectedSku,E=g.onChange,n=g.style,L=g.props,d=function(){var i=u()(a()().mark(function o(A){var m,x,N;return a()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!(0,f.Wq)(A)){M.next=2;break}return M.abrupt("return",[]);case 2:return M.next=4,P.x1.mallAdmin.skuQuerySkuForSelection({Keywords:A,Take:20});case 4:return x=M.sent,N=x==null||(m=x.data)===null||m===void 0||(m=m.Data)===null||m===void 0?void 0:m.map(function(Q){return{label:(0,D.CQ)(Q)||"--",value:Q.Id||"--"}}),M.abrupt("return",N||[]);case 7:case"end":return M.stop()}},o)}));return function(A){return i.apply(this,arguments)}}();return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(_.Z,{style:n,props:L,onSearch:function(){var i=u()(a()().mark(function o(A){return a()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,d(A);case 2:return x.abrupt("return",x.sent);case 3:case"end":return x.stop()}},o)}));return function(o){return i.apply(this,arguments)}}(),placeholder:"\u641C\u7D22\u5546\u54C1...",value:(l==null?void 0:l.Id)||void 0,initItem:l==null?void 0:{label:(0,D.CQ)(l)||"",value:l.Id||""},onChange:function(o){E&&E(o==null?void 0:{Id:o.value,Name:o.label})}})})}},47246:function(G,Z,e){e.r(Z),e.d(Z,{default:function(){return k}});var y=e(97857),a=e.n(y),h=e(5574),u=e.n(h),_=e(45360),D=e(66309),P=e(14726),f=e(67294),T=e(23806),g=e(30699),l=e(66419),E=e(57731),n=e(85893),L=function(j){var C=j.data,R=[{title:"\u5546\u54C1",render:function(K,p){var I,v;return(0,n.jsx)("span",{children:"".concat(((I=p.Goods)===null||I===void 0?void 0:I.Name)||"--","/").concat(((v=p.Sku)===null||v===void 0?void 0:v.Name)||"--")})}},{title:"\u91C7\u8D2D\u5355\u4EF7",render:function(K,p){return(0,n.jsx)("span",{children:p.Price})}},{title:"\u91C7\u8D2D\u6570\u91CF",render:function(K,p){return(0,n.jsx)("span",{children:p.Quantity})}}];return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(E.Z,{options:!1,search:!1,bordered:!0,headerTitle:"\u5E93\u5B58\u6279\u6B21\u660E\u7EC6",columns:R,dataSource:C||[],pagination:!1})})},d=e(4393),i=e(11346),o=e(25278),A=function(C){var R=C.query,O=C.onSearch,K=(0,f.useState)({}),p=u()(K,2),I=p[0],v=p[1],S=function(c){c.Page=1,O&&O(c)};return(0,f.useEffect)(function(){v(a()({},R))},[]),(0,n.jsx)(d.Z,{bordered:!1,style:{marginBottom:10},children:(0,n.jsxs)(i.Z,{layout:"inline",children:[(0,n.jsx)(i.Z.Item,{label:"\u6279\u6B21\u53F7",children:(0,n.jsx)(o.Z,{value:I.SerialNo||"",onChange:function(c){v(function(B){return a()(a()({},B),{},{SerialNo:c.target.value})})}})}),(0,n.jsx)(i.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,n.jsx)(P.ZP,{type:"primary",htmlType:"submit",onClick:function(){S(I)},children:"\u641C\u7D22"})})]})})},m=A,x=e(85576),N=e(34041),z=e(19632),M=e.n(z),Q=e(24435),X=e(80799),Y=e(77953),ee=e(48746),ne=function(j){var C=j.items,R=j.onChange,O=function(I,v){var S=M()(C);S[I]=v(S[I]),R(S)},K=[{title:"\u5546\u54C1",width:300,render:function(I,v,S){return(0,n.jsxs)(n.Fragment,{children:[(0,l.Wq)(v.SkuId)&&(0,n.jsx)("div",{style:{fontWeight:"bold",color:"red",marginBottom:5},children:"\u8BF7\u9009\u62E9"}),(0,n.jsx)(ee.Z,{selectedSku:v.Sku||{},onChange:function(c){if(c){if(C.some(function(B,$){return $!=$&&B.SkuId==c.Id})){_.ZP.error("\u5546\u54C1\u5DF2\u7ECF\u5B58\u5728\u4E8E\u91C7\u8D2D\u5355\uFF0C\u8BF7\u91CD\u65B0\u9009\u62E9");return}O(S,function(B){return a()(a()({},B),{},{Sku:c,SkuId:c.Id})})}},style:{width:"100%"}})]})}},{title:"\u6570\u91CF",render:function(I,v,S){return(0,n.jsxs)(n.Fragment,{children:[v.Quantity&&v.Quantity>0||(0,n.jsx)("div",{style:{fontWeight:"bold",color:"red",marginBottom:5},children:"\u8BF7\u8F93\u5165"}),(0,n.jsx)(Q.Z,{min:1,value:v.Quantity,onChange:function(c){O(S,function(B){return a()(a()({},B),{},{Quantity:c||0})})}})]})}},{title:"\u8FDB\u8D27\u4EF7",render:function(I,v,S){return(0,n.jsxs)(n.Fragment,{children:[v.Price&&v.Price>0||(0,n.jsx)("div",{style:{fontWeight:"bold",color:"red",marginBottom:5},children:"\u8BF7\u8F93\u5165"}),(0,n.jsx)(Q.Z,{min:0,value:v.Price,onChange:function(c){O(S,function(B){return a()(a()({},B),{},{Price:c||0})})}})]})}},{title:"\u64CD\u4F5C",render:function(I,v,S){return(0,n.jsx)(P.ZP,{type:"link",danger:!0,onClick:function(){if(confirm("\u786E\u8BA4\u5220\u9664\uFF1F")){var c=M()(C);(0,Y.Z)(c,S),R(c)}},children:"\u5220\u9664"})}}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(X.Z,{dataSource:C,columns:K,pagination:!1,style:{marginBottom:10}}),(0,n.jsx)(P.ZP,{block:!0,type:"dashed",onClick:function(){R([].concat(M()(C),[{Quantity:10}]))},children:"\u6DFB\u52A0\u5546\u54C1"})]})},te=function(j){var C=j.show,R=j.hide,O=j.data,K=j.ok,p=(0,f.useState)(!1),I=u()(p,2),v=I[0],S=I[1],b=(0,f.useState)([]),c=u()(b,2),B=c[0],$=c[1],w=(0,f.useState)([]),H=u()(w,2),J=H[0],ae=H[1],q=(0,f.useState)({}),V=u()(q,2),W=V[0],U=V[1],re=function(t){return!!(t.SkuId&&t.Quantity&&t.Quantity>0&&t.Price&&t.Price>0)},ue=function(t){if(!t.Items||t.Items.length<=0){_.ZP.error("\u8BF7\u6DFB\u52A0\u5546\u54C1");return}if(t.Items.some(function(r){return!re(r)})){_.ZP.error("\u8BF7\u8F93\u5165\u91C7\u8D2D\u4FE1\u606F");return}S(!0),g.x1.mallAdmin.stockInsertStock(a()({},t)).then(function(r){(0,l._y)(r,function(){_.ZP.success("\u4FDD\u5B58\u6210\u529F"),K()})}).finally(function(){S(!1)})},le=function(){g.x1.mallAdmin.supplierQueryAll({}).then(function(t){(0,l._y)(t,function(){ae(t.data.Data||[])})}),g.x1.mallAdmin.warehouseQueryAll({}).then(function(t){(0,l._y)(t,function(){$(t.data.Data||[])})})};return(0,f.useEffect)(function(){C&&le()},[C]),(0,f.useEffect)(function(){U(a()({},O))},[O]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(x.Z,{confirmLoading:v,open:C,onCancel:function(){return R()},onOk:function(){return ue(W)},width:"90%",title:"\u6DFB\u52A0\u91C7\u8D2D\u5355",forceRender:!0,destroyOnClose:!0,children:[(0,n.jsxs)(i.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,n.jsx)(i.Z.Item,{label:"\u4F9B\u5E94\u5546",name:"SupplierId",children:(0,n.jsx)(N.Z,{allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u4F9B\u8D27\u5546",value:W.SupplierId,onChange:function(t){U(function(r){return a()(a()({},r),{},{SupplierId:t})})},onClear:function(){U(a()(a()({},W),{},{SupplierId:void 0}))},options:J.map(function(s){return{label:s.Name,value:s.Id}})})}),(0,n.jsx)(i.Z.Item,{label:"\u76EE\u6807\u4ED3\u5E93",children:(0,n.jsx)(N.Z,{allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u76EE\u6807\u4ED3\u5E93",value:W.WarehouseId,onChange:function(t){U(function(r){return a()(a()({},r),{},{WarehouseId:t})})},onClear:function(){U(a()(a()({},W),{},{WarehouseId:void 0}))},options:B.map(function(s){return{label:s.Name,value:s.Id}})})}),(0,n.jsx)(i.Z.Item,{label:"\u5907\u6CE8",name:"Remark",rules:[{max:500}],children:(0,n.jsx)(o.Z.TextArea,{placeholder:"\u8BF7\u8F93\u5165\u91C7\u8D2D\u5907\u6CE8"})})]}),C&&(0,n.jsx)(ne,{items:W.Items||[],onChange:function(t){U(a()(a()({},W),{},{Items:t}))}})]})})},k=function(){var j=(0,f.useState)(!0),C=u()(j,2),R=C[0],O=C[1],K=(0,f.useState)({Items:[],TotalCount:0}),p=u()(K,2),I=p[0],v=p[1],S=(0,f.useState)({Page:1}),b=u()(S,2),c=b[0],B=b[1],$=(0,f.useState)(void 0),w=u()($,2),H=w[0],J=w[1],ae=(0,f.useState)(void 0),q=u()(ae,2),V=q[0],W=q[1],U=function(t){O(!0),g.x1.mallAdmin.stockStockPaging(t).then(function(r){r.data.Error?_.ZP.error(r.data.Error.Message):v(r.data||{})}).finally(function(){O(!1)})},re=function(t){t.Approved||confirm("\u786E\u5B9A\u6279\u51C6\u91C7\u8D2D\u5355\uFF1F")&&(W(t.Id||""),g.x1.mallAdmin.stockApproveStock({Id:t.Id}).then(function(r){(0,l._y)(r,function(){_.ZP.success("\u5DF2\u7ECF\u6279\u51C6\u91C7\u8D2D"),U(c)})}).finally(function(){W("")}))},ue=function(t){confirm("\u5220\u9664\u5165\u5E93\u5355\uFF1F")&&(W(t.Id||""),g.x1.mallAdmin.stockDeleteUnApprovedStock({Id:t.Id}).then(function(r){r.data.Error?_.ZP.error(r.data.Error.Message):(_.ZP.success("\u5220\u9664\u6210\u529F"),U(c))}).finally(function(){W("")}))},le=[{title:"\u6279\u53F7",render:function(t,r){return(0,n.jsx)("b",{children:"".concat(r.No||"--")})}},{title:"\u5907\u6CE8\u4FE1\u606F",render:function(t,r){return r.Remark||"--"}},{title:"\u4ED3\u5E93",render:function(t,r){var F;return(0,n.jsx)("span",{children:((F=r.Warehouse)===null||F===void 0?void 0:F.Name)||"--"})}},{title:"\u4F9B\u8D27\u5546",render:function(t,r){var F;return(0,n.jsx)("span",{children:((F=r.Supplier)===null||F===void 0?void 0:F.Name)||"--"})}},{title:"\u72B6\u6001",render:function(t,r){return r.Approved?(0,n.jsx)(D.Z,{color:"green",children:"\u5DF2\u6279\u51C6"}):(0,n.jsx)(D.Z,{color:"yellow",children:"\u5F85\u5BA1\u6838"})}},{title:"\u65F6\u95F4",render:function(t,r){return(0,n.jsx)(T.Z,{model:r})}},{title:"\u64CD\u4F5C",width:200,render:function(t,r){return(0,n.jsxs)(P.ZP.Group,{children:[r.Approved||(0,n.jsx)(P.ZP,{loading:V==r.Id,type:"primary",onClick:function(){re(r)},children:"\u5BA1\u6838"}),r.Approved||(0,n.jsx)(P.ZP,{loading:V==r.Id,danger:!0,onClick:function(){ue(r)},children:"\u5220\u9664"})]})}}];return(0,f.useEffect)(function(){U(c)},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(te,{show:H!=null,hide:function(){return J(void 0)},data:H||{},ok:function(){J(void 0),U(c)}}),(0,n.jsx)(m,{query:c,onSearch:function(t){B(t),U(t)}}),(0,n.jsx)(E.Z,{options:!1,search:!1,headerTitle:"\u91C7\u8D2D\u5355",toolBarRender:function(){return[(0,n.jsx)(P.ZP,{type:"primary",onClick:function(){J({})},children:"\u65B0\u589E"})]},rowKey:function(t){return t.Id||""},loading:R,columns:le,dataSource:I.Items||[],expandable:{expandedRowRender:function(t){return(0,n.jsx)("div",{style:{padding:10,border:"5px dashed orange"},children:(0,n.jsx)(L,{data:t.Items||[]})})}},pagination:{showSizeChanger:!1,pageSize:20,current:c.Page,total:I.TotalCount,onChange:function(t){var r=a()(a()({},c),{},{Page:t});B(r),U(r)}}})]})}},85980:function(G,Z,e){var y=e(97582),a=e(23279),h=e.n(a),u=e(67294),_=e(3930),D=e(45210),P=e(92770),f=e(31663);function T(g,l){var E;f.Z&&((0,P.mf)(g)||console.error("useDebounceFn expected parameter is a function, got ".concat(typeof g)));var n=(0,_.Z)(g),L=(E=l==null?void 0:l.wait)!==null&&E!==void 0?E:1e3,d=(0,u.useMemo)(function(){return h()(function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return n.current.apply(n,(0,y.ev)([],(0,y.CR)(i),!1))},L,l)},[]);return(0,D.Z)(function(){d.cancel()}),{run:d,cancel:d.cancel,flush:d.flush}}Z.Z=T},77953:function(G,Z,e){e.d(Z,{Z:function(){return L}});var y=e(74073),a=e(16423);function h(d,i){for(var o=-1,A=i.length,m=Array(A),x=d==null;++o<A;)m[o]=x?void 0:(0,a.Z)(d,i[o]);return m}var u=h,_=e(49344),D=e(56009),P=Array.prototype,f=P.splice;function T(d,i){for(var o=d?i.length:0,A=o-1;o--;){var m=i[o];if(o==A||m!==x){var x=m;(0,D.Z)(m)?f.call(d,m,1):(0,_.Z)(d,m)}}return d}var g=T,l=e(97109),E=e(94008),n=(0,E.Z)(function(d,i){var o=d==null?0:d.length,A=u(d,i);return g(d,(0,y.Z)(i,function(m){return(0,D.Z)(m,o)?+m:m}).sort(l.Z)),A}),L=n}}]);

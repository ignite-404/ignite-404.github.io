"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5193],{96256:function(w,S,n){var d=n(97857),_=n.n(d),C=n(19632),f=n.n(C),j=n(5574),p=n.n(j),B=n(85980),L=n(34041),b=n(57381),g=n(67294),r=n(85893);S.Z=function(l){var A=l.onSearch,M=l.value,P=l.onChange,c=l.style,h=l.initItem,$=l.placeholder,W=l.props,x=(0,g.useState)(!1),V=p()(x,2),o=V[0],R=V[1],Q=(0,g.useState)([]),z=p()(Q,2),Z=z[0],G=z[1],F=(0,B.Z)(function(O){R(!0),A(O).then(function(E){G(E||[])}).finally(function(){return R(!1)})},{wait:500});(0,g.useEffect)(function(){},[]);var Y=function(){var E=f()(Z);return h&&!E.find(function(e){return e.value===h.value})&&E.push(h),E};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(L.Z,_()({style:_()({minWidth:300},c),loading:o,value:M,showSearch:!0,allowClear:!0,filterOption:!1,onSearch:function(E){F.run(E)},onChange:function(E){var e=Z.find(function(s){return s.value==E});P&&P(e)},onClear:function(){P&&P(void 0)},placeholder:$||"\u8F93\u5165\u5173\u952E\u8BCD",notFoundContent:o&&(0,r.jsx)(b.Z,{size:"small"}),options:Y()},W))})}},1288:function(w,S,n){var d=n(78957),_=n(83062),C=n(46629),f=n(85893);S.Z=function(j){var p,B=j.timeStr,L=j.fallback,b=j.onlyDate,g=j.prefix,r=(p=(0,C.mg)(B))===null||p===void 0?void 0:p.add(C.Mg,"hour");if(!r)return L||null;var l=(0,C.ND)().utc().add(C.Mg,"hour"),A=r.isSame(l,"year"),M=r.diff(l,"day"),P=A?r.format(C.AK):r.format(C.vc),c=function(){return(0,f.jsxs)("div",{children:[(0,f.jsxs)(d.Z,{direction:"horizontal",children:[(0,f.jsx)("div",{children:r.fromNow()}),(0,f.jsx)("div",{children:r.format(C.On)})]}),(0,f.jsx)("div",{children:r.format(C.t9)})]})};return(0,f.jsx)(_.Z,{title:c(),children:(0,f.jsxs)(d.Z,{direction:"horizontal",children:[g,(0,f.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:b?r.format(C.vc):r.format(C.dq)})]})})}},48746:function(w,S,n){var d=n(15009),_=n.n(d),C=n(99289),f=n.n(C),j=n(96256),p=n(35291),B=n(30967),L=n(42838),b=n(85893);S.Z=function(g){var r=g.selectedSku,l=g.onChange,A=g.style,M=g.props,P=function(){var c=f()(_()().mark(function h($){var W,x,V;return _()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(!(0,L.Wq)($)){R.next=2;break}return R.abrupt("return",[]);case 2:return R.next=4,B.x1.mallAdmin.skuQuerySkuForSelection({Keywords:$,Take:20});case 4:return x=R.sent,V=x==null||(W=x.data)===null||W===void 0||(W=W.Data)===null||W===void 0?void 0:W.map(function(Q){return{label:(0,p.CQ)(Q)||"--",value:Q.Id||"--"}}),R.abrupt("return",V||[]);case 7:case"end":return R.stop()}},h)}));return function($){return c.apply(this,arguments)}}();return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(j.Z,{style:A,props:M,onSearch:function(){var c=f()(_()().mark(function h($){return _()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,P($);case 2:return x.abrupt("return",x.sent);case 3:case"end":return x.stop()}},h)}));return function(h){return c.apply(this,arguments)}}(),placeholder:"\u641C\u7D22\u5546\u54C1...",value:(r==null?void 0:r.Id)||void 0,initItem:r==null?void 0:{label:(0,p.CQ)(r)||"",value:r.Id||""},onChange:function(h){l&&l(h==null?void 0:{Id:h.value,Name:h.label})}})})}},47176:function(w,S,n){n.r(S),n.d(S,{default:function(){return Q}});var d=n(97857),_=n.n(d),C=n(5574),f=n.n(C),j=n(68421),p=n(45360),B=n(66309),L=n(4393),b=n(78957),g=n(14726),r=n(80799),l=n(67294),A=n(1288),M=n(48746),P=n(30967),c=n(42838),h=n(50472),$=n(85576),W=n(29127),x=n(25278),V=n(76857),o=n(85893),R=function(z){var Z=z.show,G=z.close,F=z.ok,Y=(0,l.useState)([]),O=f()(Y,2),E=O[0],e=O[1],s=(0,l.useState)(""),v=f()(s,2),a=v[0],u=v[1],U=function(t){var i=new FormData;return i.append("collection",t,t.name),V.M.post("/api/mall-admin/external-sku/upload-and-parse-excel",i)},D=(0,j.Z)(U,{manual:!0,onSuccess:function(t,i){(0,c._y)(t,function(){var m,I=((m=t.data)===null||m===void 0?void 0:m.Data)||[];I.length<=0&&p.ZP.warning("\u8868\u683C\u4E2D\u6CA1\u6709\u6570\u636E"),e(I)})}}),K=(0,j.Z)(P.x1.mallAdmin.externalSkuInsertMany,{manual:!0,onSuccess:function(t,i){(0,c._y)(t,function(){p.ZP.success("\u4FDD\u5B58\u6210\u529F"),F()})}});(0,l.useEffect)(function(){Z||e([])},[Z]);var N=[{title:"\u552F\u4E00\u6807\u8BC6",render:function(t,i){return"".concat(i.ExternalSkuId,"@").concat(a||"--")}},{title:"\u89C4\u683C\u540D\u79F0",render:function(t,i){return i.SkuName||"--"}},{title:"\u4EF7\u683C",render:function(t,i){return(0,c.lb)(i.Price||0)}}];return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)($.Z,{open:Z,onCancel:function(){G()},onOk:function(){G()},width:"95%",children:(0,o.jsxs)(b.Z,{direction:"vertical",style:{width:"100%"},children:[(0,o.jsxs)(b.Z,{direction:"horizontal",children:[(0,o.jsx)(W.Z,{fileList:[],showUploadList:!1,multiple:!1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",customRequest:function(t){var i=t.file;i&&D.run(i)},children:(0,o.jsx)(g.ZP,{size:"large",type:"primary",loading:D.loading,children:"\u4E0A\u4F20\u8868\u683C"})}),(0,o.jsx)(x.Z,{size:"large",value:a,onChange:function(t){return u(t.target.value)},placeholder:"\u6570\u636E\u5206\u7EC4"}),(0,o.jsx)(g.ZP,{size:"large",disabled:E.length<=0||(0,c.Wq)(a),onClick:function(){var t=E.map(function(i){return _()(_()({},i),{},{SystemName:a})});K.run(t)},loading:K.loading,children:"\u5BFC\u5165\u6570\u636E"}),(0,o.jsx)(g.ZP,{size:"large",type:"dashed",disabled:E.length<=0,onClick:function(){return e([])},children:"\u6E05\u7A7A\u6570\u636E"})]}),(0,o.jsx)(r.Z,{columns:N,dataSource:E,pagination:!1})]})})})},Q=function(){var z,Z=(0,l.useState)({Page:1}),G=f()(Z,2),F=G[0],Y=G[1],O=(0,j.Z)(P.x1.mallAdmin.externalSkuQueryPaging,{manual:!0}),E=((z=O.data)===null||z===void 0?void 0:z.data)||{},e=(0,l.useState)(!1),s=f()(e,2),v=s[0],a=s[1];(0,l.useEffect)(function(){O.run(_()({},F))},[]);var u=(0,l.useState)(void 0),U=f()(u,2),D=U[0],K=U[1],N=(0,j.Z)(P.x1.mallAdmin.externalSkuSaveMapping,{manual:!0,onSuccess:function(i){(0,c._y)(i,function(){p.ZP.success("\u4FDD\u5B58\u6210\u529F"),O.run(_()({},F))})},onFinally:function(){return K(void 0)}}),y=[{title:"\u552F\u4E00\u6807\u8BC6",render:function(i,m){return(0,o.jsx)(B.Z,{children:m.CombineId})}},{title:"\u89C4\u683C\u540D\u79F0",render:function(i,m){var I,X=(I=m.Items)===null||I===void 0?void 0:I.at(0);if(!X)return(0,o.jsx)("span",{children:"--"});var T=[X.GoodsName||"",X.SkuName||""].filter(function(q){return q.length>0});return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("span",{children:T.join("-")})})}},{title:"\u5173\u8054\u89C4\u683C",render:function(i,m,I){return(0,o.jsx)(M.Z,{selectedSku:m.Sku||void 0,props:{loading:D===m.CombineId},onChange:function(T){console.log(I,T),K(m.CombineId),N.run({CombineId:m.CombineId,SkuId:T==null?void 0:T.Id})}})}},{title:"\u8BB0\u5F55\u6570\u91CF",render:function(i,m){var I;return(0,o.jsx)("b",{children:((I=m.Items)===null||I===void 0?void 0:I.length)||0})}},{title:"\u6700\u65B0\u66F4\u65B0\u65F6\u95F4",render:function(i,m){return(0,o.jsx)(A.Z,{timeStr:m.CreationTime})}}];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(R,{show:v,close:function(){return a(!1)},ok:function(){a(!1),O.run(_()({},F))}}),(0,o.jsx)(L.Z,{extra:(0,o.jsxs)(b.Z,{direction:"horizontal",children:[(0,o.jsx)(g.ZP,{icon:(0,o.jsx)(h.Z,{stroke:1}),size:"small",loading:O.loading,type:"dashed",onClick:function(){O.run(_()({},F))}}),(0,o.jsx)(g.ZP,{type:"primary",size:"small",onClick:function(){a(!0)},children:"\u5BFC\u5165"})]}),children:(0,o.jsx)(r.Z,{loading:O.loading,columns:y,dataSource:E.Items||[],expandable:{expandedRowRender:function(i){return(0,o.jsx)(o.Fragment,{children:JSON.stringify(i)})}},pagination:{total:E.TotalCount,pageSize:E.PageSize,current:E.PageIndex,onChange:function(i){var m=_()(_()({},F),{},{Page:i});O.run(m),Y(m)}}})})]})}},30967:function(w,S,n){n.d(S,{HK:function(){return r},c2:function(){return g},x1:function(){return b}});var d=n(15009),_=n.n(d),C=n(97857),f=n.n(C),j=n(99289),p=n.n(j),B=n(76857),L=n(60379),b=function(){var l=new L.V0;return l.instance=B.M,l}(),g=function(){var l=new L.V0;return l.instance=B.M,l}(),r=function(){var l=p()(_()().mark(function A(M){return _()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(M){c.next=2;break}return c.abrupt("return");case 2:return c.next=4,b.mall.commonSaveActivityLog(f()(f()({},M),{},{Id:void 0}));case 4:return c.abrupt("return",c.sent);case 5:case"end":return c.stop()}},A)}));return function(M){return l.apply(this,arguments)}}()},85980:function(w,S,n){var d=n(97582),_=n(23279),C=n.n(_),f=n(67294),j=n(3930),p=n(45210),B=n(92770),L=n(31663);function b(g,r){var l;L.Z&&((0,B.mf)(g)||console.error("useDebounceFn expected parameter is a function, got ".concat(typeof g)));var A=(0,j.Z)(g),M=(l=r==null?void 0:r.wait)!==null&&l!==void 0?l:1e3,P=(0,f.useMemo)(function(){return C()(function(){for(var c=[],h=0;h<arguments.length;h++)c[h]=arguments[h];return A.current.apply(A,(0,d.ev)([],(0,d.CR)(c),!1))},M,r)},[]);return(0,p.Z)(function(){P.cancel()}),{run:P,cancel:P.cancel,flush:P.flush}}S.Z=b},66309:function(w,S,n){n.d(S,{Z:function(){return E}});var d=n(67294),_=n(93967),C=n.n(_),f=n(98423),j=n(98787),p=n(69760),B=n(96159),L=n(45353),b=n(53124),g=n(11568),r=n(10274),l=n(14747),A=n(83262),M=n(83559);const P=e=>{const{paddingXXS:s,lineWidth:v,tagPaddingHorizontal:a,componentCls:u,calc:U}=e,D=U(a).sub(v).equal(),K=U(s).sub(v).equal();return{[u]:Object.assign(Object.assign({},(0,l.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:D,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,g.bf)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${u}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${u}-close-icon`]:{marginInlineStart:K,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${u}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${u}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:D}}),[`${u}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},c=e=>{const{lineWidth:s,fontSizeIcon:v,calc:a}=e,u=e.fontSizeSM;return(0,A.IX)(e,{tagFontSize:u,tagLineHeight:(0,g.bf)(a(e.lineHeightSM).mul(u).equal()),tagIconSize:a(v).sub(a(s).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},h=e=>({defaultBg:new r.C(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var $=(0,M.I$)("Tag",e=>{const s=c(e);return P(s)},h),W=function(e,s){var v={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&s.indexOf(a)<0&&(v[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,a=Object.getOwnPropertySymbols(e);u<a.length;u++)s.indexOf(a[u])<0&&Object.prototype.propertyIsEnumerable.call(e,a[u])&&(v[a[u]]=e[a[u]]);return v},V=d.forwardRef((e,s)=>{const{prefixCls:v,style:a,className:u,checked:U,onChange:D,onClick:K}=e,N=W(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:y,tag:t}=d.useContext(b.E_),i=ee=>{D==null||D(!U),K==null||K(ee)},m=y("tag",v),[I,X,T]=$(m),q=C()(m,`${m}-checkable`,{[`${m}-checkable-checked`]:U},t==null?void 0:t.className,u,X,T);return I(d.createElement("span",Object.assign({},N,{ref:s,style:Object.assign(Object.assign({},a),t==null?void 0:t.style),className:q,onClick:i})))}),o=n(98719);const R=e=>(0,o.Z)(e,(s,v)=>{let{textColor:a,lightBorderColor:u,lightColor:U,darkColor:D}=v;return{[`${e.componentCls}${e.componentCls}-${s}`]:{color:a,background:U,borderColor:u,"&-inverse":{color:e.colorTextLightSolid,background:D,borderColor:D},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}});var Q=(0,M.bk)(["Tag","preset"],e=>{const s=c(e);return R(s)},h);function z(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const Z=(e,s,v)=>{const a=z(v);return{[`${e.componentCls}${e.componentCls}-${s}`]:{color:e[`color${v}`],background:e[`color${a}Bg`],borderColor:e[`color${a}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var G=(0,M.bk)(["Tag","status"],e=>{const s=c(e);return[Z(s,"success","Success"),Z(s,"processing","Info"),Z(s,"error","Error"),Z(s,"warning","Warning")]},h),F=function(e,s){var v={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&s.indexOf(a)<0&&(v[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,a=Object.getOwnPropertySymbols(e);u<a.length;u++)s.indexOf(a[u])<0&&Object.prototype.propertyIsEnumerable.call(e,a[u])&&(v[a[u]]=e[a[u]]);return v};const O=d.forwardRef((e,s)=>{const{prefixCls:v,className:a,rootClassName:u,style:U,children:D,icon:K,color:N,onClose:y,bordered:t=!0,visible:i}=e,m=F(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:I,direction:X,tag:T}=d.useContext(b.E_),[q,ee]=d.useState(!0),ie=(0,f.Z)(m,["closeIcon","closable"]);d.useEffect(()=>{i!==void 0&&ee(i)},[i]);const te=(0,j.o2)(N),oe=(0,j.yT)(N),ne=te||oe,de=Object.assign(Object.assign({backgroundColor:N&&!ne?N:void 0},T==null?void 0:T.style),U),H=I("tag",v),[ce,_e,me]=$(H),fe=C()(H,T==null?void 0:T.className,{[`${H}-${N}`]:ne,[`${H}-has-color`]:N&&!ne,[`${H}-hidden`]:!q,[`${H}-rtl`]:X==="rtl",[`${H}-borderless`]:!t},a,u,_e,me),le=k=>{k.stopPropagation(),y==null||y(k),!k.defaultPrevented&&ee(!1)},[,ve]=(0,p.Z)((0,p.w)(e),(0,p.w)(T),{closable:!1,closeIconRender:k=>{const Ce=d.createElement("span",{className:`${H}-close-icon`,onClick:le},k);return(0,B.wm)(k,Ce,J=>({onClick:ue=>{var ae;(ae=J==null?void 0:J.onClick)===null||ae===void 0||ae.call(J,ue),le(ue)},className:C()(J==null?void 0:J.className,`${H}-close-icon`)}))}}),ge=typeof m.onClick=="function"||D&&D.type==="a",re=K||null,he=re?d.createElement(d.Fragment,null,re,D&&d.createElement("span",null,D)):D,se=d.createElement("span",Object.assign({},ie,{ref:s,className:fe,style:de}),he,ve,te&&d.createElement(Q,{key:"preset",prefixCls:H}),oe&&d.createElement(G,{key:"status",prefixCls:H}));return ce(ge?d.createElement(L.Z,{component:"Tag"},se):se)});O.CheckableTag=V;var E=O},50472:function(w,S,n){n.d(S,{Z:function(){return _}});var d=n(33733);var _=(0,d.Z)("outline","reload","IconReload",[["path",{d:"M19.933 13.041a8 8 0 1 1 -9.925 -8.788c3.899 -1 7.935 1.007 9.425 4.747",key:"svg-0"}],["path",{d:"M20 4v5h-5",key:"svg-1"}]])}}]);

"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7482],{96256:function(X,K,r){var L=r(97857),_=r.n(L),Z=r(19632),E=r.n(Z),T=r(68421),z=r(34041),N=r(57381),C=r(85893);K.Z=function(F){var P=F.onSearch,D=F.value,M=F.onChange,v=F.style,w=F.initItem,V=F.placeholder,S=F.props,B=(0,T.Z)(P,{manual:!0,debounceWait:500}),a=B.data||[],U=function(){var R=E()(a);return w&&!R.find(function(A){return A.value===w.value})&&R.push(w),R};return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(z.Z,_()({style:_()({minWidth:300},v),loading:B.loading,value:D,showSearch:!0,allowClear:!0,filterOption:!1,onSearch:function(R){B.run(R)},onChange:function(R){var A=a.find(function(W){return W.value==R});M&&M(A)},onClear:function(){M&&M(void 0)},placeholder:V||"\u8F93\u5165\u5173\u952E\u8BCD",notFoundContent:B.loading&&(0,C.jsx)(N.Z,{size:"small"}),options:U()},S))})}},23806:function(X,K,r){var L=r(1288),_=r(85893);K.Z=function(Z){var E=Z.model,T=Z.fallback;if(E==null||E==null)return null;var z=E==null?void 0:E.CreationTime,N=E==null?void 0:E.LastModificationTime;return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)("div",{style:{},children:[(0,_.jsx)("div",{children:(0,_.jsx)(L.Z,{prefix:(0,_.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:z,fallback:T})}),(0,_.jsx)("div",{children:(0,_.jsx)(L.Z,{prefix:(0,_.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:N,fallback:T})})]})})}},1288:function(X,K,r){var L=r(78957),_=r(83062),Z=r(46629),E=r(85893);K.Z=function(T){var z,N=T.timeStr,C=T.fallback,F=T.onlyDate,P=T.prefix,D=(z=(0,Z.mg)(N))===null||z===void 0?void 0:z.add(Z.Mg,"hour");if(!D)return C||null;var M=(0,Z.ND)().utc().add(Z.Mg,"hour"),v=D.isSame(M,"year"),w=D.diff(M,"day"),V=v?D.format(Z.AK):D.format(Z.vc),S=function(){return(0,E.jsxs)("div",{children:[(0,E.jsxs)(L.Z,{direction:"horizontal",children:[(0,E.jsx)("div",{children:D.fromNow()}),(0,E.jsx)("div",{children:D.format(Z.On)})]}),(0,E.jsx)("div",{children:D.format(Z.t9)})]})};return(0,E.jsx)(_.Z,{title:S(),children:(0,E.jsxs)(L.Z,{direction:"horizontal",children:[P,(0,E.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:F?D.format(Z.vc):D.format(Z.dq)})]})})}},48746:function(X,K,r){var L=r(15009),_=r.n(L),Z=r(99289),E=r.n(Z),T=r(96256),z=r(35291),N=r(30699),C=r(95813),F=r(85893);K.Z=function(P){var D=P.selectedSku,M=P.onChange,v=P.style,w=P.props,V=function(){var S=E()(_()().mark(function B(a){var U,y,R;return _()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!(0,C.Wq)(a)){W.next=2;break}return W.abrupt("return",[]);case 2:return W.next=4,N.x1.mallAdmin.skuQuerySkuForSelection({Keywords:a,Take:20});case 4:return y=W.sent,R=y==null||(U=y.data)===null||U===void 0||(U=U.Data)===null||U===void 0?void 0:U.map(function(q){return{label:(0,z.CQ)(q)||"--",value:q.Id||"--"}}),W.abrupt("return",R||[]);case 7:case"end":return W.stop()}},B)}));return function(a){return S.apply(this,arguments)}}();return(0,F.jsx)(F.Fragment,{children:(0,F.jsx)(T.Z,{style:v,props:w,onSearch:function(){var S=E()(_()().mark(function B(a){return _()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,V(a);case 2:return y.abrupt("return",y.sent);case 3:case"end":return y.stop()}},B)}));return function(B){return S.apply(this,arguments)}}(),placeholder:"\u641C\u7D22\u5546\u54C1...",value:(D==null?void 0:D.Id)||void 0,initItem:D==null?void 0:{label:(0,z.CQ)(D)||"",value:D.Id||""},onChange:function(B){M&&M(B==null?void 0:{Id:B.value,Name:B.label})}})})}},73263:function(X,K,r){r.r(K),r.d(K,{default:function(){return Ie}});var L=r(5574),_=r.n(L),Z=r(49677),E=r.n(Z),T=r(65885),z=r(68421),N=r(85137),C=r(78957),F=r(40056),P=r(67294),D=r(35291),M=r(30699),v=r(95813),w=r(76021),V=r(19632),S=r.n(V),B=r(97857),a=r.n(B),U=r(71230),y=r(15746),R=r(4393),A=r(14726),W=r(97975),q=r(30291),e=r(85893),he=function(c){var n=c.children,t=(0,P.useRef)(null),l=(0,P.useState)(0),h=_()(l,2),s=h[0],i=h[1];return(0,P.useEffect)(function(){var u=function(){var d;i(window.innerHeight-(((d=t.current)===null||d===void 0?void 0:d.getBoundingClientRect().top)||0)-10)},o=setInterval(function(){return u()},1e3);return window.onresize=function(){return u()},window.onscroll=function(){return u()},u(),function(){o&&clearInterval(o),window.onresize=null,window.onscroll=null}},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(q.Z,{offsetTop:80,children:(0,e.jsx)("div",{ref:t,style:{overflowY:"scroll",height:s},children:n})})})},le=r(96074),G=r(66309),$=r(83062),ee=r(26855),ve=r(47221),J=r(66090),me=r(84567),Y=r(11346),H=r(65233),te=function(c){var n,t=c.address,l=c.onChange,h=c.nameLabel;if(!t||!l)return(0,e.jsx)("h1",{children:"error"});var s=(0,v.tq)(t.Tel||""),i=(n=(0,v.kw)(t.AddressDetail||""))===null||n===void 0?void 0:n.at(0),u=function(){return s||(0,v.Wq)(i)?null:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(C.Z,{direction:"horizontal",children:[(0,e.jsxs)("span",{children:["\u627E\u5230\u624B\u673A\u53F7\uFF1A",i]}),(0,e.jsx)(A.ZP,{size:"small",type:"link",onClick:function(){l(a()(a()({},t),{},{Tel:i}))},children:"\u4F7F\u7528\u6B64\u53F7\u7801"})]})})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Y.Z,{labelCol:{span:8},wrapperCol:{span:16},children:(0,e.jsxs)(U.Z,{gutter:[10,10],children:[(0,e.jsx)(y.Z,{span:6,children:(0,e.jsx)(Y.Z.Item,{label:h||"\u6536\u4EF6\u4EBA",children:(0,e.jsx)(H.Z,{value:t.Name||"",status:(0,v.Wq)(t.Name)?"error":void 0,onChange:function(m){l(a()(a()({},t),{},{Name:m.target.value}))}})})}),(0,e.jsx)(y.Z,{span:6,children:(0,e.jsxs)(Y.Z.Item,{label:"\u8054\u7CFB\u7535\u8BDD",children:[(0,e.jsx)(H.Z,{status:s?void 0:"error",value:t.Tel||"",onChange:function(m){l(a()(a()({},t),{},{Tel:m.target.value}))}}),s||(0,e.jsx)("b",{style:{color:"red"},children:"\u8BF7\u8F93\u5165\u6709\u6548\u624B\u673A\u53F7"})]})}),(0,e.jsx)(y.Z,{span:12,children:(0,e.jsxs)(Y.Z.Item,{label:"\u6536\u4EF6\u5730\u5740",children:[(0,e.jsx)(H.Z.TextArea,{rows:2,status:(0,v.Wq)(t.AddressDetail)?"error":void 0,value:t.AddressDetail||"",onChange:function(m){l(a()(a()({},t),{},{AddressDetail:m.target.value}))}}),u()]})})]})})})},fe=r(96864),k=r(46629),ge=function(c){var n=c.order,t=c.onChange;if(!n||!t)return(0,e.jsx)("h1",{children:"error"});var l=k.ND.utc().add(-10,"year"),h=function(){var i=(0,k.mg)(n.CreationTime);if(i&&i.isAfter(l))return i.add(k.Mg,"hour")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Y.Z,{labelCol:{span:8},wrapperCol:{span:16},children:(0,e.jsxs)(U.Z,{gutter:[10,10],children:[(0,e.jsx)(y.Z,{span:8,children:(0,e.jsx)(Y.Z.Item,{label:"\u4E0B\u5355\u65F6\u95F4",children:(0,e.jsx)(fe.default,{format:k.vc,presets:[{label:"\u4ECA\u5929",value:k.ND.utc()},{label:"\u6628\u5929",value:k.ND.utc().add(-1,"days")},{label:"\u524D\u5929",value:k.ND.utc().add(-2,"days")}],value:h(),onChange:function(i){t(a()(a()({},n),{},{CreationTime:i==null?void 0:i.add(-k.Mg,"hour").format(k.dq)}))}})})}),(0,e.jsx)(y.Z,{span:8,children:(0,e.jsx)(Y.Z.Item,{label:"\u8BA2\u5355\u5907\u6CE8",children:(0,e.jsx)(H.Z.TextArea,{rows:2,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5907\u6CE8",value:n.Remark||"",onChange:function(i){t(a()(a()({},n),{},{Remark:i.target.value}))}})})})]})})})},ae=r(24435),se=r(80799),je=r(48746),ue=function(n){return(0,J.Z)(n,function(t){return(t.Quantity||0)*(t.UnitPrice||0)})},de=function(n){return!!(!n||(0,v.Wq)(n.Name)||(0,v.Wq)(n.Tel)||(0,v.Wq)(n.AddressDetail)||!(0,v.tq)(n.Tel||""))},xe=function(n){var t;return!!(de(n.UserAddress)||n.SpecificSender&&de(n.Sender)||!(0,v.tq)(((t=n.UserAddress)===null||t===void 0?void 0:t.Tel)||"")||!n.PaymentBills||n.PaymentBills.length<=0||n.PaymentBills.some(function(l){return(l.Price||0)<=0})||!n.Items||n.Items.length<=0||n.Items.some(function(l){var h;return(l.Quantity||0)<=0||(l.UnitPrice||0)<=0||(0,v.Wq)(l.Remark)&&(0,v.Wq)((h=l.Sku)===null||h===void 0?void 0:h.Name)}))},Ce=function(c){var n=c.items,t=c.onChange;if(!n||!t)return(0,e.jsx)("h1",{children:"error"});var l=function(i,u){var o=S()(n);o[i]=u,t(o)},h=[{render:function(i,u,o){return(0,e.jsx)(G.Z,{color:"blue",children:o+1})}},{title:"\u5546\u54C1",render:function(i,u,o){return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(C.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(je.Z,{selectedSku:u.Sku,onChange:function(d){l(o,a()(a()({},u),{},{Sku:d,SkuId:d==null?void 0:d.Id}))},style:{width:"100%"}}),(0,e.jsx)(H.Z.TextArea,{rows:1,placeholder:"\u8F93\u5165\u5546\u54C1\u5907\u6CE8",value:u.Remark||"",onChange:function(d){l(o,a()(a()({},u),{},{Remark:d.target.value}))}}),(0,v.Wq)(u.SkuId)&&(0,v.Wq)(u.Remark)&&(0,e.jsx)("b",{style:{color:"red"},children:"\u8BF7\u9009\u62E9\u5546\u54C1\u6216\u8005\u8F93\u5165\u5907\u6CE8"})]})})}},{title:"\u5355\u4EF7",render:function(i,u,o){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ae.Z,{size:"large",addonAfter:"\u5143",min:0,status:(u.UnitPrice||0)<=0?"error":void 0,value:u.UnitPrice,onChange:function(d){l(o,a()(a()({},u),{},{UnitPrice:d||0}))}})})}},{title:"\u6570\u91CF",render:function(i,u,o){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ae.Z,{size:"large",addonAfter:"\u4E2A",min:1,status:(u.Quantity||0)<=0?"error":void 0,value:u.Quantity,onChange:function(d){l(o,a()(a()({},u),{},{Quantity:d||0}))}})})}},{title:"\u5355\u54C1\u603B\u4EF7",render:function(i,u,o){return(0,e.jsx)(G.Z,{color:"blue",children:(0,e.jsx)("b",{children:(0,v.lb)(ue([u]))})})}},{title:"\u64CD\u4F5C",width:150,render:function(i,u,o){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(C.Z,{direction:"horizontal",children:(0,e.jsx)(A.ZP,{danger:!0,type:"link",onClick:function(){confirm("\u786E\u5B9A\u5220\u9664\uFF1F")&&t(n.filter(function(d,g){return g!==o}))},children:"\u5220\u9664"})})})}}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(C.Z,{direction:"vertical",style:{width:"100%"},children:(0,e.jsx)(se.Z,{title:function(){return(0,e.jsx)("b",{children:"\u5546\u54C1\u5217\u8868"})},style:{border:"1px solid orange"},size:"small",bordered:!0,columns:h,dataSource:n,pagination:!1,footer:function(){return(0,e.jsx)("div",{children:(0,e.jsx)(A.ZP,{size:"small",type:"link",onClick:function(){t([].concat(S()(n),[{Quantity:1,UnitPrice:0}]))},children:"\u6DFB\u52A0\u5546\u54C1"})})}})})})},pe=r(34041),_e=function(c){var n=c.bills,t=c.items,l=c.onChange;if(!n||!l)return(0,e.jsx)("h1",{children:"error"});var h=function(u,o){var m=S()(n);m[u]=o,l(m)},s=[{render:function(u,o,m){return(0,e.jsx)(G.Z,{color:"blue",children:m+1})}},{title:"\u652F\u4ED8\u6E20\u9053",render:function(u,o,m){return(0,e.jsx)(pe.Z,{style:{minWidth:150},size:"large",allowClear:!0,value:o.PaymentChannel,options:D.rz.map(function(d){return{value:d.id,label:d.name}}),onChange:function(g){h(m,a()(a()({},o),{},{PaymentChannel:g}))}})}},{title:"\u91D1\u989D",render:function(u,o,m){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ae.Z,{size:"large",addonAfter:"\u5143",min:0,status:(o.Price||0)<=0?"error":void 0,value:o.Price,onChange:function(g){h(m,a()(a()({},o),{},{Price:g||0}))}})})}},{render:function(u,o,m){return(0,e.jsx)(G.Z,{color:"blue",children:(0,e.jsx)("b",{children:(0,v.lb)(o.Price||0)})})}},{title:"\u64CD\u4F5C",width:150,render:function(u,o,m){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(C.Z,{direction:"horizontal",children:(0,e.jsx)(A.ZP,{danger:!0,type:"link",onClick:function(){confirm("\u786E\u5B9A\u5220\u9664\uFF1F")&&l(n.filter(function(g,p){return p!==m}))},children:"\u5220\u9664"})})})}}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(C.Z,{direction:"vertical",style:{width:"100%"},children:(0,e.jsx)(se.Z,{title:function(){return(0,e.jsx)("b",{children:"\u8D26\u5355\u5217\u8868"})},style:{border:"1px solid green"},size:"small",bordered:!0,columns:s,dataSource:n,pagination:!1,footer:function(){return(0,e.jsx)("div",{children:(0,e.jsx)(A.ZP,{size:"small",type:"link",onClick:function(){l([].concat(S()(n),[{PaymentChannel:D.$s.Balance,Price:void 0}]))},children:"\u6DFB\u52A0\u8D26\u5355"})})}})})})},Ee=function(c){var n=c.order,t=c.onChange;if(!n||!t)return(0,e.jsx)("h1",{children:"error"});var l=function(){return(0,e.jsxs)("div",{children:[(0,e.jsxs)(C.Z,{direction:"horizontal",children:[(0,e.jsx)(me.Z,{checked:n.SpecificSender,onChange:function(i){t(a()(a()({},n),{},{SpecificSender:i.target.checked}))}}),(0,e.jsx)("b",{children:"\u4F7F\u7528\u5355\u72EC\u53D1\u4EF6\u4EBA"})]}),n.SpecificSender&&(0,e.jsx)(te,{nameLabel:"\u53D1\u4EF6\u4EBA",address:n.Sender||{},onChange:function(i){t(a()(a()({},n),{},{Sender:i}))}})]})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(C.Z,{direction:"vertical",style:{width:"100%"},children:[l(),(0,e.jsx)(te,{address:n.UserAddress||{},onChange:function(s){t(a()(a()({},n),{},{UserAddress:s}))}}),(0,e.jsx)(ge,{order:n,onChange:function(s){t(s||{})}}),(0,v.G5)(n.Items)&&(0,e.jsx)(F.Z,{message:"\u8BF7\u6DFB\u52A0\u5546\u54C1",type:"error"}),(0,e.jsx)(Ce,{items:n.Items||[],onChange:function(s){t(a()(a()({},n),{},{Items:s}))}}),(0,e.jsx)(_e,{bills:n.PaymentBills||[],items:n.Items||[],onChange:function(s){t(a()(a()({},n),{},{PaymentBills:s}))}})]})})},De=function(n,t){return"x_order_group_card_id_index_".concat(t)},ne=function(n,t){var l=["".concat(t||"\u6536\u4EF6\u4EBA","\uFF1A").concat(n.Name||"--"),"\u8054\u7CFB\u7535\u8BDD\uFF1A".concat(n.Tel||"--"),"\u90AE\u5BC4\u5730\u5740\uFF1A".concat(n.AddressDetail||"--")];return l.join(`
`)},ye=function(c){var n=c.group_data,t=c.onChange,l=(n==null?void 0:n.Orders)||[],h=(0,P.useState)([]),s=_()(h,2),i=s[0],u=s[1];(0,P.useEffect)(function(){console.log(i)},[i]);var o=function(x,b){var f,j,O=ue(x.Items||[]),I=(0,J.Z)(x.PaymentBills||[],function(re){return re.Price||0}),Q=O-I;return(0,e.jsxs)(C.Z,{direction:"horizontal",split:(0,e.jsx)(le.Z,{type:"vertical"}),children:[(0,e.jsxs)(G.Z,{color:"orange",children:["#",b+1]}),(0,e.jsx)("h3",{style:{display:"inline-block",backgroundColor:"orange",paddingLeft:3,paddingRight:3},children:(0,e.jsx)("pre",{children:((f=x.UserAddress)===null||f===void 0?void 0:f.Name)||"???"})}),(0,e.jsxs)(C.Z,{direction:"horizontal",children:[(0,e.jsx)($.Z,{title:"\u5E94\u6536",children:(0,e.jsx)(G.Z,{color:"error",children:(0,v.lb)(O)})}),(0,e.jsx)("b",{children:"-"}),(0,e.jsx)($.Z,{title:"\u5DF2\u6536",children:(0,e.jsx)(G.Z,{color:"blue",children:(0,v.lb)(I)})}),(0,e.jsx)("b",{children:"="}),(0,e.jsx)($.Z,{title:"\u5269\u4F59\u5E94\u6536",children:(0,e.jsx)(G.Z,{color:Q>0?"orange":Q<0?"error":"default",children:(0,v.lb)(Q)})})]}),x.SpecificSender&&(0,e.jsxs)("span",{style:{color:"gray"},children:["\u53D1\u4EF6\u4EBA:",((j=x.Sender)===null||j===void 0?void 0:j.Name)||"???"]}),(0,v.Wq)(x.Remark)||(0,e.jsx)($.Z,{title:(0,e.jsx)("div",{children:"\u8BA2\u5355\u5907\u6CE8\uFF1A".concat(x.Remark)}),children:(0,e.jsx)("span",{children:(0,v.zO)(x.Remark||"",30)})})]})},m=function(x,b){return(0,e.jsxs)(C.Z,{direction:"horizontal",children:[(0,e.jsx)(A.ZP,{type:"dashed",size:"small",onClick:function(){var j=(x.SpecificSender?x.Sender:n.SharedSender)||{},O=ne(j,"\u53D1\u4EF6\u4EBA");navigator.clipboard.writeText(O),ee.ZP.success({message:"\u590D\u5236\u6210\u529F",description:(0,e.jsx)("pre",{children:O})})},children:"\u590D\u5236\u53D1\u4EF6\u4EBA"}),(0,e.jsx)(A.ZP,{type:"dashed",size:"small",onClick:function(){var j=ne(x.UserAddress||{},"\u6536\u4EF6\u4EBA");navigator.clipboard.writeText(j),ee.ZP.success({message:"\u590D\u5236\u6210\u529F",description:(0,e.jsx)("pre",{children:j})})},children:"\u590D\u5236\u6536\u4EF6\u4EBA"}),(0,e.jsx)(A.ZP,{type:"dashed",size:"small",onClick:function(){var j,O=(x.SpecificSender?x.Sender:n.SharedSender)||{},I=(j=x.Items)===null||j===void 0?void 0:j.map(function(ie){var oe;return"".concat(((oe=ie.Sku)===null||oe===void 0?void 0:oe.Name)||ie.Remark||"--","---X").concat(ie.Quantity||0)}),Q=[ne(O,"\u53D1\u4EF6\u4EBA"),"-----------------------------------",ne(x.UserAddress||{},"\u6536\u4EF6\u4EBA"),"-----------------------------------"].concat(S()(I||[])),re=Q.join(`
`);navigator.clipboard.writeText(re),ee.ZP.success({message:"\u590D\u5236\u6210\u529F",description:(0,e.jsx)("pre",{children:re})})},children:"\u590D\u5236\u8BA2\u5355\u6587\u672C"}),(0,e.jsx)(A.ZP,{danger:!0,type:"text",size:"small",onClick:function(){if(confirm("\u786E\u5B9A\u5220\u9664\u8BA2\u5355\uFF1F")){var j=S()(l).filter(function(O,I){return I!==b});t(a()(a()({},n),{},{Orders:j}))}},children:"\u5220\u9664\u8BA2\u5355"})]})},d=function(x,b,f){return(0,e.jsx)("div",{style:{border:"3px dashed blue",borderColor:x?"blue":"transparent"},children:(0,e.jsx)(R.Z,{size:"small",extra:m(b,f),children:(0,e.jsx)(Ee,{order:b||{},onChange:function(O){var I=S()(l);I[f]=O,t(a()(a()({},n),{},{Orders:I}))}})})})},g=l.map(function(p,x){var b=De(p,x),f=i.indexOf(b)>=0;return{key:b,label:(0,e.jsx)("div",{id:b,children:o(p,x)}),extra:xe(p)&&(0,e.jsx)($.Z,{title:"\u4FE1\u606F\u4E0D\u5B8C\u6574",children:(0,e.jsx)("span",{style:{color:"red"},children:"\u8BF7\u8865\u5168"})}),children:(0,e.jsx)("div",{style:{minHeight:200},children:f&&d(f,p,x)}),forceRender:!1}});return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ve.Z,{size:"small",accordion:!0,bordered:!0,destroyInactivePanel:!0,items:g,activeKey:i.at(0),onChange:function(x){u(x||[])}})})},Ze=r(23806),Fe=function(c){var n,t=c.group,l=c.onChange,h=(t==null||(n=t.GroupData)===null||n===void 0?void 0:n.Orders)||[],s=h.flatMap(function(g){return g.Items||[]}),i=(0,J.Z)(s,function(g){return g.Quantity||0}),u=(0,J.Z)(h,function(g){return g.SellerPriceOffset||0}),o=ue(s)+u,m=h.flatMap(function(g){return g.PaymentBills||[]}),d=(0,J.Z)(m,function(g){return g.Price||0});return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(F.Z,{message:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(C.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)("div",{children:(0,e.jsxs)(C.Z,{direction:"horizontal",children:[(0,e.jsx)("span",{children:"\u6279\u6B21\u53F7"}),(0,e.jsx)(G.Z,{children:t.Id||"--"})]})}),(0,e.jsx)(H.Z,{addonBefore:"\u540D\u79F0",value:t.Name||"",onChange:function(p){l(a()(a()({},t),{},{Name:p.target.value}))}}),(0,e.jsx)(H.Z.TextArea,{rows:3,value:t.Description||"",placeholder:"\u8F93\u5165\u5907\u6CE8\u4FE1\u606F",onChange:function(p){l(a()(a()({},t),{},{Description:p.target.value}))}}),(0,e.jsx)("div",{children:(0,e.jsx)(Ze.Z,{model:t||{}})}),(0,e.jsx)(le.Z,{type:"horizontal"})]})}),description:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{children:[h.length,"\u4E2A\u8BA2\u5355\uFF0C",i,"\u4E2A\u5546\u54C1"]}),(0,e.jsxs)("div",{children:["\u603B\u8BA1",(0,v.lb)(o)]}),(0,e.jsxs)("div",{children:["\u6536\u6B3E",(0,v.lb)(d)]}),(0,e.jsxs)("div",{children:["\u5269\u4F59\u5E94\u6536",(0,v.lb)(o-d)]})]})})})},Ae=function(c){var n=c.group,t=c.onChange,l=c.action,h=(n==null?void 0:n.GroupData)||{},s=h.Orders||[];return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(U.Z,{gutter:[10,10],children:[(0,e.jsx)(y.Z,{span:6,children:(0,e.jsxs)(C.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(F.Z,{message:"\u540C\u4E00\u4E2A\u6279\u6B21\u8BA2\u5355\u4E0D\u652F\u6301\u591A\u4EBA\u540C\u65F6\u7F16\u8F91\uFF01",type:"error"}),(0,e.jsx)(he,{children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(C.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(Fe,{group:n||{},onChange:function(u){return t(u||{})}}),l]})})})]})}),(0,e.jsxs)(y.Z,{span:18,children:[(0,e.jsx)(R.Z,{title:"\u53D1\u4EF6\u4EBA",size:"small",bordered:!0,extra:(0,e.jsx)("span",{style:{color:"gray"},children:"\u5982\u679C\u8BA2\u5355\u672A\u6307\u5B9A\u53D1\u4EF6\u4EBA\uFF0C\u5C06\u4F7F\u7528\u6B64\u5904\u914D\u7F6E\u7684\u53D1\u4EF6\u4EBA\u4FE1\u606F"}),style:{border:"3px dashed orange",marginBottom:30},children:(0,e.jsx)(te,{nameLabel:"\u53D1\u4EF6\u4EBA",address:(h==null?void 0:h.SharedSender)||{},onChange:function(u){t(a()(a()({},n),{},{GroupData:a()(a()({},h),{},{SharedSender:u})}))}})}),(0,e.jsx)(ye,{group_data:n.GroupData||{},onChange:function(u){t(a()(a()({},n),{},{GroupData:u}))}}),(0,e.jsx)("div",{style:{padding:10},children:(0,e.jsx)(A.ZP,{type:"primary",block:!0,size:"large",icon:(0,e.jsx)(W.Z,{stroke:1}),onClick:function(){var u={SpecificSender:!1,Sender:{},UserAddress:{},Items:[{Quantity:1,UnitPrice:0}],PaymentBills:[{PaymentChannel:D.$s.Balance}]},o=a()(a()({},h),{},{Orders:[].concat(S()(s),[u])});t(a()(a()({},n),{},{GroupData:o}))},children:"\u6DFB\u52A0\u8BA2\u5355"})})]})]})})},ce=r(45360),Pe=r(85418),Se=r(50472),Be=r(98185),be=function(c){var n=c.group,t=c.ok,l=c.onSaved,h=c.onChange,s=c.loadingData,i=(0,z.Z)(M.x1.mallManager.orderGroupSave,{manual:!0,onSuccess:function(g,p){(0,v._y)(g,function(){ee.ZP.success({message:"\u4FDD\u5B58\u6210\u529F",description:"\u4F60\u53EF\u4EE5\u7EE7\u7EED\u7F16\u8F91"}),l(),t()})}}),u=(0,z.Z)(M.x1.mallManager.orderGroupExportExcel,{manual:!0,onSuccess:function(g,p){var x=k.ND.utc().add(k.Mg,"hour").format("YYYY-MM-DD-HH-mm-ss"),b=new Blob([g.data]),f=document.createElement("a");f.download="".concat(n.Name||"--",".xlsx"),f.style.display="none",f.href=URL.createObjectURL(b),document.body.appendChild(f),f.click(),URL.revokeObjectURL(f.href),document.body.removeChild(f)}}),o=function(g,p){return(0,v.Te)(g||"zzzzzzzzzzzz").localeCompare((0,v.Te)(p||"zzzzzzzzzzzzzzz"))},m=(0,z.Z)(function(){return new Promise(function(d,g){try{var p,x=((p=n.GroupData)===null||p===void 0?void 0:p.Orders)||[],b=x.sort(function(j,O){var I,Q;return o(j==null||(I=j.UserAddress)===null||I===void 0?void 0:I.Name,O==null||(Q=O.UserAddress)===null||Q===void 0?void 0:Q.Name)}),f=a()(a()({},n.GroupData),{},{Orders:b});h(a()(a()({},n),{},{GroupData:f})),setTimeout(function(){return d()},1e3)}catch(j){g(j)}})},{manual:!0});return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(C.Z,{direction:"horizontal",wrap:!0,style:{marginBottom:10},children:[(0,e.jsx)($.Z,{title:"\u4FDD\u5B58\u81F3\u670D\u52A1\u5668\uFF0C\u5F53\u524D\u7248\u672C\u53F7\uFF1A".concat(n.RowVersion),children:(0,e.jsx)(A.ZP,{type:"primary",loading:i.loading,onClick:function(){if((0,v.Wq)(n.Id)){ce.ZP.error("\u6279\u6B21id\u4E0D\u5B58\u5728");return}i.run(n||{})},children:"\u4FDD\u5B58"})}),(0,e.jsx)($.Z,{title:"\u52A0\u8F7D\u6700\u65B0\u6570\u636E\uFF0C\u672C\u5730\u672A\u4FDD\u5B58\u66F4\u6539\u5C06\u88AB\u8986\u76D6",children:(0,e.jsx)(A.ZP,{loading:s,type:"dashed",danger:!0,icon:(0,e.jsx)(Se.Z,{stroke:1}),onClick:function(){confirm("\u786E\u5B9A\u91CD\u65B0\u52A0\u8F7D\u6570\u636E\uFF1F")&&t()}})}),(0,e.jsx)($.Z,{title:"\u6309\u7167\u4E70\u5BB6\u59D3\u540D\u6392\u5E8F",children:(0,e.jsx)(A.ZP,{type:"dashed",loading:m.loading,onClick:function(){m.run()},children:"\u6392\u5E8F"})}),(0,e.jsx)($.Z,{title:"\u590D\u5236\u6570\u636E",children:(0,e.jsx)(Pe.Z.Button,{trigger:["hover"],loading:u.loading,menu:{items:[{key:"export-excel",label:"\u5BFC\u51FA\u8868\u683C",icon:(0,e.jsx)(Be.Z,{stroke:1}),danger:!0,onClick:function(){u.run(n||{},{format:"blob"})}}]},type:"dashed",onClick:function(){navigator.clipboard.writeText(JSON.stringify(n||{})),ce.ZP.success("\u590D\u5236\u6210\u529F")},children:"\u590D\u5236"})})]})})},Ie=function(c){var n;E()(c);var t=(0,w.TH)(),l=(n=(0,D.dD)(t.search))===null||n===void 0?void 0:n.id,h=(0,P.useState)(!1),s=_()(h,2),i=s[0],u=s[1],o=(0,T.Z)("order-group",{serializer:function(j){return JSON.stringify(j||{})},deserializer:function(j){return(0,v.Jp)(j)||{}}}),m=_()(o,2),d=m[0],g=m[1],p=(0,z.Z)(M.x1.mallManager.orderGroupGetById,{manual:!0,onSuccess:function(j,O){var I;g(((I=j.data)===null||I===void 0?void 0:I.Data)||{}),u(!1)}}),x=function(){return l&&p.run({Id:l})};(0,P.useEffect)(function(){return x(),function(){window.onbeforeunload=null}},[]),(0,P.useEffect)(function(){i?window.onbeforeunload=function(f){return f.preventDefault(),f.stopPropagation(),"\u6570\u636E\u672A\u4FDD\u5B58\uFF0C\u8BF7\u7559\u610F"}:window.onbeforeunload=null},[i]);var b=(0,v.Wq)(d==null?void 0:d.Id);return p.loading&&b?(0,e.jsx)("h1",{children:"loading..."}):b?(0,e.jsx)("h1",{children:"error model id"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(N.Z.BackTop,{}),(0,e.jsx)(Ae,{group:d||{},onChange:function(j){g(j),u(!0)},action:(0,e.jsxs)(C.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(be,{loadingData:p.loading,group:d||{},onChange:function(j){g(j),u(!0)},onSaved:function(){u(!1)},ok:function(){x()}}),i&&(0,e.jsx)(F.Z,{message:"\u5B58\u5728\u4FEE\u6539\uFF0C\u8BF7\u5C3D\u5FEB\u4FDD\u5B58",type:"error"})]})})]})}}}]);

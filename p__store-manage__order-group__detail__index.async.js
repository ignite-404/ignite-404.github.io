"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7482],{96256:function(ne,G,r){var W=r(97857),p=r.n(W),Z=r(19632),E=r.n(Z),z=r(5574),I=r.n(z),Q=r(85980),D=r(34041),R=r(57381),F=r(67294),x=r(85893);G.Z=function(A){var J=A.onSearch,v=A.value,w=A.onChange,P=A.style,O=A.initItem,a=A.placeholder,T=A.props,y=(0,F.useState)(!1),V=I()(y,2),S=V[0],U=V[1],ee=(0,F.useState)([]),e=I()(ee,2),re=e[0],te=e[1],L=(0,Q.Z)(function($){U(!0),J($).then(function(K){te(K||[])}).finally(function(){return U(!1)})},{wait:500});(0,F.useEffect)(function(){},[]);var k=function(){var K=E()(re);return O&&!K.find(function(Y){return Y.value===O.value})&&K.push(O),K};return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(D.Z,p()({style:p()({minWidth:300},P),loading:S,value:v,showSearch:!0,allowClear:!0,filterOption:!1,onSearch:function(K){L.run(K)},onChange:function(K){var Y=re.find(function(ie){return ie.value==K});w&&w(Y)},onClear:function(){w&&w(void 0)},placeholder:a||"\u8F93\u5165\u5173\u952E\u8BCD",notFoundContent:S&&(0,x.jsx)(R.Z,{size:"small"}),options:k()},T))})}},23806:function(ne,G,r){var W=r(1288),p=r(85893);G.Z=function(Z){var E=Z.model,z=Z.fallback;if(E==null||E==null)return null;var I=E==null?void 0:E.CreationTime,Q=E==null?void 0:E.LastModificationTime;return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{style:{},children:[(0,p.jsx)("div",{children:(0,p.jsx)(W.Z,{prefix:(0,p.jsx)("span",{children:"\u521B\u5EFA\uFF1A"}),onlyDate:!0,timeStr:I,fallback:z})}),(0,p.jsx)("div",{children:(0,p.jsx)(W.Z,{prefix:(0,p.jsx)("span",{children:"\u4FEE\u6539\uFF1A"}),onlyDate:!0,timeStr:Q,fallback:z})})]})})}},1288:function(ne,G,r){var W=r(78957),p=r(83062),Z=r(46629),E=r(85893);G.Z=function(z){var I,Q=z.timeStr,D=z.fallback,R=z.onlyDate,F=z.prefix,x=(I=(0,Z.mg)(Q))===null||I===void 0?void 0:I.add(Z.Mg,"hour");if(!x)return D||null;var A=(0,Z.ND)().utc().add(Z.Mg,"hour"),J=x.isSame(A,"year"),v=x.diff(A,"day"),w=J?x.format(Z.AK):x.format(Z.vc),P=function(){return(0,E.jsxs)("div",{children:[(0,E.jsxs)(W.Z,{direction:"horizontal",children:[(0,E.jsx)("div",{children:x.fromNow()}),(0,E.jsx)("div",{children:x.format(Z.On)})]}),(0,E.jsx)("div",{children:x.format(Z.t9)})]})};return(0,E.jsx)(p.Z,{title:P(),children:(0,E.jsxs)(W.Z,{direction:"horizontal",children:[F,(0,E.jsx)("div",{className:"inline-block cursor-pointer hover:bg-orange-500",children:R?x.format(Z.vc):x.format(Z.dq)})]})})}},48746:function(ne,G,r){var W=r(15009),p=r.n(W),Z=r(99289),E=r.n(Z),z=r(96256),I=r(35291),Q=r(30699),D=r(66419),R=r(85893);G.Z=function(F){var x=F.selectedSku,A=F.onChange,J=F.style,v=F.props,w=function(){var P=E()(p()().mark(function O(a){var T,y,V;return p()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!(0,D.Wq)(a)){U.next=2;break}return U.abrupt("return",[]);case 2:return U.next=4,Q.x1.mallAdmin.skuQuerySkuForSelection({Keywords:a,Take:20});case 4:return y=U.sent,V=y==null||(T=y.data)===null||T===void 0||(T=T.Data)===null||T===void 0?void 0:T.map(function(ee){return{label:(0,I.CQ)(ee)||"--",value:ee.Id||"--"}}),U.abrupt("return",V||[]);case 7:case"end":return U.stop()}},O)}));return function(a){return P.apply(this,arguments)}}();return(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(z.Z,{style:J,props:v,onSearch:function(){var P=E()(p()().mark(function O(a){return p()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,w(a);case 2:return y.abrupt("return",y.sent);case 3:case"end":return y.stop()}},O)}));return function(O){return P.apply(this,arguments)}}(),placeholder:"\u641C\u7D22\u5546\u54C1...",value:(x==null?void 0:x.Id)||void 0,initItem:x==null?void 0:{label:(0,I.CQ)(x)||"",value:x.Id||""},onChange:function(O){A&&A(O==null?void 0:{Id:O.value,Name:O.label})}})})}},73263:function(ne,G,r){r.r(G),r.d(G,{default:function(){return Ie}});var W=r(5574),p=r.n(W),Z=r(49677),E=r.n(Z),z=r(65885),I=r(68421),Q=r(85137),D=r(78957),R=r(40056),F=r(67294),x=r(35291),A=r(30699),J=r(47650),v=r(66419),w=r(19632),P=r.n(w),O=r(97857),a=r.n(O),T=r(71230),y=r(15746),V=r(4393),S=r(14726),U=r(97975),ee=r(30291),e=r(85893),re=function(c){var n=c.children,t=(0,F.useRef)(null),o=(0,F.useState)(0),h=p()(o,2),s=h[0],i=h[1];return(0,F.useEffect)(function(){var u=function(){var d;i(window.innerHeight-(((d=t.current)===null||d===void 0?void 0:d.getBoundingClientRect().top)||0)-10)},l=setInterval(function(){return u()},1e3);return window.onresize=function(){return u()},window.onscroll=function(){return u()},u(),function(){l&&clearInterval(l),window.onresize=null,window.onscroll=null}},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ee.Z,{offsetTop:80,children:(0,e.jsx)("div",{ref:t,style:{overflowY:"scroll",height:s},children:n})})})},te=r(96074),L=r(66309),k=r(83062),$=r(26855),K=r(47221),Y=r(66090),ie=r(84567),X=r(11346),q=r(25278),le=function(c){var n,t=c.address,o=c.onChange,h=c.nameLabel;if(!t||!o)return(0,e.jsx)("h1",{children:"error"});var s=(0,v.tq)(t.Tel||""),i=(n=(0,v.kw)(t.AddressDetail||""))===null||n===void 0?void 0:n.at(0),u=function(){return s||(0,v.Wq)(i)?null:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(D.Z,{direction:"horizontal",children:[(0,e.jsxs)("span",{children:["\u627E\u5230\u624B\u673A\u53F7\uFF1A",i]}),(0,e.jsx)(S.ZP,{size:"small",type:"link",onClick:function(){o(a()(a()({},t),{},{Tel:i}))},children:"\u4F7F\u7528\u6B64\u53F7\u7801"})]})})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(X.Z,{labelCol:{span:8},wrapperCol:{span:16},children:(0,e.jsxs)(T.Z,{gutter:[10,10],children:[(0,e.jsx)(y.Z,{span:6,children:(0,e.jsx)(X.Z.Item,{label:h||"\u6536\u4EF6\u4EBA",children:(0,e.jsx)(q.Z,{value:t.Name||"",status:(0,v.Wq)(t.Name)?"error":void 0,onChange:function(m){o(a()(a()({},t),{},{Name:m.target.value}))}})})}),(0,e.jsx)(y.Z,{span:6,children:(0,e.jsxs)(X.Z.Item,{label:"\u8054\u7CFB\u7535\u8BDD",children:[(0,e.jsx)(q.Z,{status:s?void 0:"error",value:t.Tel||"",onChange:function(m){o(a()(a()({},t),{},{Tel:m.target.value}))}}),s||(0,e.jsx)("b",{style:{color:"red"},children:"\u8BF7\u8F93\u5165\u6709\u6548\u624B\u673A\u53F7"})]})}),(0,e.jsx)(y.Z,{span:12,children:(0,e.jsxs)(X.Z.Item,{label:"\u6536\u4EF6\u5730\u5740",children:[(0,e.jsx)(q.Z.TextArea,{rows:2,status:(0,v.Wq)(t.AddressDetail)?"error":void 0,value:t.AddressDetail||"",onChange:function(m){o(a()(a()({},t),{},{AddressDetail:m.target.value}))}}),u()]})})]})})})},fe=r(96864),N=r(46629),ge=function(c){var n=c.order,t=c.onChange;if(!n||!t)return(0,e.jsx)("h1",{children:"error"});var o=N.ND.utc().add(-10,"year"),h=function(){var i=(0,N.mg)(n.CreationTime);if(i&&i.isAfter(o))return i.add(N.Mg,"hour")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(X.Z,{labelCol:{span:8},wrapperCol:{span:16},children:(0,e.jsxs)(T.Z,{gutter:[10,10],children:[(0,e.jsx)(y.Z,{span:8,children:(0,e.jsx)(X.Z.Item,{label:"\u4E0B\u5355\u65F6\u95F4",children:(0,e.jsx)(fe.default,{format:N.vc,presets:[{label:"\u4ECA\u5929",value:N.ND.utc()},{label:"\u6628\u5929",value:N.ND.utc().add(-1,"days")},{label:"\u524D\u5929",value:N.ND.utc().add(-2,"days")}],value:h(),onChange:function(i){t(a()(a()({},n),{},{CreationTime:i==null?void 0:i.add(-N.Mg,"hour").format(N.dq)}))}})})}),(0,e.jsx)(y.Z,{span:8,children:(0,e.jsx)(X.Z.Item,{label:"\u8BA2\u5355\u5907\u6CE8",children:(0,e.jsx)(q.Z.TextArea,{rows:2,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5907\u6CE8",value:n.Remark||"",onChange:function(i){t(a()(a()({},n),{},{Remark:i.target.value}))}})})})]})})})},oe=r(24435),he=r(80799),je=r(48746),se=function(n){return(0,Y.Z)(n,function(t){return(t.Quantity||0)*(t.UnitPrice||0)})},ve=function(n){return!!(!n||(0,v.Wq)(n.Name)||(0,v.Wq)(n.Tel)||(0,v.Wq)(n.AddressDetail)||!(0,v.tq)(n.Tel||""))},_e=function(n){var t;return!!(ve(n.UserAddress)||n.SpecificSender&&ve(n.Sender)||!(0,v.tq)(((t=n.UserAddress)===null||t===void 0?void 0:t.Tel)||"")||!n.PaymentBills||n.PaymentBills.length<=0||n.PaymentBills.some(function(o){return(o.Price||0)<=0})||!n.Items||n.Items.length<=0||n.Items.some(function(o){var h;return(o.Quantity||0)<=0||(o.UnitPrice||0)<=0||(0,v.Wq)(o.Remark)&&(0,v.Wq)((h=o.Sku)===null||h===void 0?void 0:h.Name)}))},xe=function(c){var n=c.items,t=c.onChange;if(!n||!t)return(0,e.jsx)("h1",{children:"error"});var o=function(i,u){var l=P()(n);l[i]=u,t(l)},h=[{render:function(i,u,l){return(0,e.jsx)(L.Z,{color:"blue",children:l+1})}},{title:"\u5546\u54C1",render:function(i,u,l){return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(D.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(je.Z,{selectedSku:u.Sku,onChange:function(d){o(l,a()(a()({},u),{},{Sku:d,SkuId:d==null?void 0:d.Id}))},style:{width:"100%"}}),(0,e.jsx)(q.Z.TextArea,{rows:1,placeholder:"\u8F93\u5165\u5546\u54C1\u5907\u6CE8",value:u.Remark||"",onChange:function(d){o(l,a()(a()({},u),{},{Remark:d.target.value}))}}),(0,v.Wq)(u.SkuId)&&(0,v.Wq)(u.Remark)&&(0,e.jsx)("b",{style:{color:"red"},children:"\u8BF7\u9009\u62E9\u5546\u54C1\u6216\u8005\u8F93\u5165\u5907\u6CE8"})]})})}},{title:"\u5355\u4EF7",render:function(i,u,l){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(oe.Z,{size:"large",addonAfter:"\u5143",min:0,status:(u.UnitPrice||0)<=0?"error":void 0,value:u.UnitPrice,onChange:function(d){o(l,a()(a()({},u),{},{UnitPrice:d||0}))}})})}},{title:"\u6570\u91CF",render:function(i,u,l){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(oe.Z,{size:"large",addonAfter:"\u4E2A",min:1,status:(u.Quantity||0)<=0?"error":void 0,value:u.Quantity,onChange:function(d){o(l,a()(a()({},u),{},{Quantity:d||0}))}})})}},{title:"\u5355\u54C1\u603B\u4EF7",render:function(i,u,l){return(0,e.jsx)(L.Z,{color:"blue",children:(0,e.jsx)("b",{children:(0,v.lb)(se([u]))})})}},{title:"\u64CD\u4F5C",width:150,render:function(i,u,l){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(D.Z,{direction:"horizontal",children:(0,e.jsx)(S.ZP,{danger:!0,type:"link",onClick:function(){confirm("\u786E\u5B9A\u5220\u9664\uFF1F")&&t(n.filter(function(d,g){return g!==l}))},children:"\u5220\u9664"})})})}}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(D.Z,{direction:"vertical",style:{width:"100%"},children:(0,e.jsx)(he.Z,{title:function(){return(0,e.jsx)("b",{children:"\u5546\u54C1\u5217\u8868"})},style:{border:"1px solid orange"},size:"small",bordered:!0,columns:h,dataSource:n,pagination:!1,footer:function(){return(0,e.jsx)("div",{children:(0,e.jsx)(S.ZP,{size:"small",type:"link",onClick:function(){t([].concat(P()(n),[{Quantity:1,UnitPrice:0}]))},children:"\u6DFB\u52A0\u5546\u54C1"})})}})})})},Ce=r(34041),pe=function(c){var n=c.bills,t=c.items,o=c.onChange;if(!n||!o)return(0,e.jsx)("h1",{children:"error"});var h=function(u,l){var m=P()(n);m[u]=l,o(m)},s=[{render:function(u,l,m){return(0,e.jsx)(L.Z,{color:"blue",children:m+1})}},{title:"\u652F\u4ED8\u6E20\u9053",render:function(u,l,m){return(0,e.jsx)(Ce.Z,{style:{minWidth:150},size:"large",allowClear:!0,value:l.PaymentChannel,options:x.rz.map(function(d){return{value:d.id,label:d.name}}),onChange:function(g){h(m,a()(a()({},l),{},{PaymentChannel:g}))}})}},{title:"\u91D1\u989D",render:function(u,l,m){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(oe.Z,{size:"large",addonAfter:"\u5143",min:0,status:(l.Price||0)<=0?"error":void 0,value:l.Price,onChange:function(g){h(m,a()(a()({},l),{},{Price:g||0}))}})})}},{render:function(u,l,m){return(0,e.jsx)(L.Z,{color:"blue",children:(0,e.jsx)("b",{children:(0,v.lb)(l.Price||0)})})}},{title:"\u64CD\u4F5C",width:150,render:function(u,l,m){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(D.Z,{direction:"horizontal",children:(0,e.jsx)(S.ZP,{danger:!0,type:"link",onClick:function(){confirm("\u786E\u5B9A\u5220\u9664\uFF1F")&&o(n.filter(function(g,C){return C!==m}))},children:"\u5220\u9664"})})})}}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(D.Z,{direction:"vertical",style:{width:"100%"},children:(0,e.jsx)(he.Z,{title:function(){return(0,e.jsx)("b",{children:"\u8D26\u5355\u5217\u8868"})},style:{border:"1px solid green"},size:"small",bordered:!0,columns:s,dataSource:n,pagination:!1,footer:function(){return(0,e.jsx)("div",{children:(0,e.jsx)(S.ZP,{size:"small",type:"link",onClick:function(){o([].concat(P()(n),[{PaymentChannel:x.$s.Balance,Price:void 0}]))},children:"\u6DFB\u52A0\u8D26\u5355"})})}})})})},Ee=function(c){var n=c.order,t=c.onChange;if(!n||!t)return(0,e.jsx)("h1",{children:"error"});var o=function(){return(0,e.jsxs)("div",{children:[(0,e.jsxs)(D.Z,{direction:"horizontal",children:[(0,e.jsx)(ie.Z,{checked:n.SpecificSender,onChange:function(i){t(a()(a()({},n),{},{SpecificSender:i.target.checked}))}}),(0,e.jsx)("b",{children:"\u4F7F\u7528\u5355\u72EC\u53D1\u4EF6\u4EBA"})]}),n.SpecificSender&&(0,e.jsx)(le,{nameLabel:"\u53D1\u4EF6\u4EBA",address:n.Sender||{},onChange:function(i){t(a()(a()({},n),{},{Sender:i}))}})]})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(D.Z,{direction:"vertical",style:{width:"100%"},children:[o(),(0,e.jsx)(le,{address:n.UserAddress||{},onChange:function(s){t(a()(a()({},n),{},{UserAddress:s}))}}),(0,e.jsx)(ge,{order:n,onChange:function(s){t(s||{})}}),(0,v.G5)(n.Items)&&(0,e.jsx)(R.Z,{message:"\u8BF7\u6DFB\u52A0\u5546\u54C1",type:"error"}),(0,e.jsx)(xe,{items:n.Items||[],onChange:function(s){t(a()(a()({},n),{},{Items:s}))}}),(0,e.jsx)(pe,{bills:n.PaymentBills||[],items:n.Items||[],onChange:function(s){t(a()(a()({},n),{},{PaymentBills:s}))}})]})})},De=function(n,t){return"x_order_group_card_id_index_".concat(t)},ae=function(n,t){var o=["".concat(t||"\u6536\u4EF6\u4EBA","\uFF1A").concat(n.Name||"--"),"\u8054\u7CFB\u7535\u8BDD\uFF1A".concat(n.Tel||"--"),"\u90AE\u5BC4\u5730\u5740\uFF1A".concat(n.AddressDetail||"--")];return o.join(`
`)},ye=function(c){var n=c.group_data,t=c.onChange,o=(n==null?void 0:n.Orders)||[],h=(0,F.useState)([]),s=p()(h,2),i=s[0],u=s[1];(0,F.useEffect)(function(){console.log(i)},[i]);var l=function(_,B){var f,j,M=se(_.Items||[]),b=(0,Y.Z)(_.PaymentBills||[],function(ue){return ue.Price||0}),H=M-b;return(0,e.jsxs)(D.Z,{direction:"horizontal",split:(0,e.jsx)(te.Z,{type:"vertical"}),children:[(0,e.jsxs)(L.Z,{color:"orange",children:["#",B+1]}),(0,e.jsx)("h3",{style:{display:"inline-block",backgroundColor:"orange",paddingLeft:3,paddingRight:3},children:(0,e.jsx)("pre",{children:((f=_.UserAddress)===null||f===void 0?void 0:f.Name)||"???"})}),(0,e.jsxs)(D.Z,{direction:"horizontal",children:[(0,e.jsx)(k.Z,{title:"\u5E94\u6536",children:(0,e.jsx)(L.Z,{color:"error",children:(0,v.lb)(M)})}),(0,e.jsx)("b",{children:"-"}),(0,e.jsx)(k.Z,{title:"\u5DF2\u6536",children:(0,e.jsx)(L.Z,{color:"blue",children:(0,v.lb)(b)})}),(0,e.jsx)("b",{children:"="}),(0,e.jsx)(k.Z,{title:"\u5269\u4F59\u5E94\u6536",children:(0,e.jsx)(L.Z,{color:H>0?"orange":H<0?"error":"default",children:(0,v.lb)(H)})})]}),_.SpecificSender&&(0,e.jsxs)("span",{style:{color:"gray"},children:["\u53D1\u4EF6\u4EBA:",((j=_.Sender)===null||j===void 0?void 0:j.Name)||"???"]}),(0,v.Wq)(_.Remark)||(0,e.jsx)(k.Z,{title:(0,e.jsx)("div",{children:"\u8BA2\u5355\u5907\u6CE8\uFF1A".concat(_.Remark)}),children:(0,e.jsx)("span",{children:(0,v.zO)(_.Remark||"",30)})})]})},m=function(_,B){return(0,e.jsxs)(D.Z,{direction:"horizontal",children:[(0,e.jsx)(S.ZP,{type:"dashed",size:"small",onClick:function(){var j=(_.SpecificSender?_.Sender:n.SharedSender)||{},M=ae(j,"\u53D1\u4EF6\u4EBA");navigator.clipboard.writeText(M),$.ZP.success({message:"\u590D\u5236\u6210\u529F",description:(0,e.jsx)("pre",{children:M})})},children:"\u590D\u5236\u53D1\u4EF6\u4EBA"}),(0,e.jsx)(S.ZP,{type:"dashed",size:"small",onClick:function(){var j=ae(_.UserAddress||{},"\u6536\u4EF6\u4EBA");navigator.clipboard.writeText(j),$.ZP.success({message:"\u590D\u5236\u6210\u529F",description:(0,e.jsx)("pre",{children:j})})},children:"\u590D\u5236\u6536\u4EF6\u4EBA"}),(0,e.jsx)(S.ZP,{type:"dashed",size:"small",onClick:function(){var j,M=(_.SpecificSender?_.Sender:n.SharedSender)||{},b=(j=_.Items)===null||j===void 0?void 0:j.map(function(de){var ce;return"".concat(((ce=de.Sku)===null||ce===void 0?void 0:ce.Name)||de.Remark||"--","---X").concat(de.Quantity||0)}),H=[ae(M,"\u53D1\u4EF6\u4EBA"),"-----------------------------------",ae(_.UserAddress||{},"\u6536\u4EF6\u4EBA"),"-----------------------------------"].concat(P()(b||[])),ue=H.join(`
`);navigator.clipboard.writeText(ue),$.ZP.success({message:"\u590D\u5236\u6210\u529F",description:(0,e.jsx)("pre",{children:ue})})},children:"\u590D\u5236\u8BA2\u5355\u6587\u672C"}),(0,e.jsx)(S.ZP,{danger:!0,type:"text",size:"small",onClick:function(){if(confirm("\u786E\u5B9A\u5220\u9664\u8BA2\u5355\uFF1F")){var j=P()(o).filter(function(M,b){return b!==B});t(a()(a()({},n),{},{Orders:j}))}},children:"\u5220\u9664\u8BA2\u5355"})]})},d=function(_,B,f){return(0,e.jsx)("div",{style:{border:"3px dashed blue",borderColor:_?"blue":"transparent"},children:(0,e.jsx)(V.Z,{size:"small",extra:m(B,f),children:(0,e.jsx)(Ee,{order:B||{},onChange:function(M){var b=P()(o);b[f]=M,t(a()(a()({},n),{},{Orders:b}))}})})})},g=o.map(function(C,_){var B=De(C,_),f=i.indexOf(B)>=0;return{key:B,label:(0,e.jsx)("div",{id:B,children:l(C,_)}),extra:_e(C)&&(0,e.jsx)(k.Z,{title:"\u4FE1\u606F\u4E0D\u5B8C\u6574",children:(0,e.jsx)("span",{style:{color:"red"},children:"\u8BF7\u8865\u5168"})}),children:(0,e.jsx)("div",{style:{minHeight:200},children:f&&d(f,C,_)}),forceRender:!1}});return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(K.Z,{size:"small",accordion:!0,bordered:!0,destroyInactivePanel:!0,items:g,activeKey:i.at(0),onChange:function(_){u(_||[])}})})},Ze=r(23806),Fe=function(c){var n,t=c.group,o=c.onChange,h=(t==null||(n=t.GroupData)===null||n===void 0?void 0:n.Orders)||[],s=h.flatMap(function(g){return g.Items||[]}),i=(0,Y.Z)(s,function(g){return g.Quantity||0}),u=(0,Y.Z)(h,function(g){return g.SellerPriceOffset||0}),l=se(s)+u,m=h.flatMap(function(g){return g.PaymentBills||[]}),d=(0,Y.Z)(m,function(g){return g.Price||0});return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(R.Z,{message:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(D.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)("div",{children:(0,e.jsxs)(D.Z,{direction:"horizontal",children:[(0,e.jsx)("span",{children:"\u6279\u6B21\u53F7"}),(0,e.jsx)(L.Z,{children:t.Id||"--"})]})}),(0,e.jsx)(q.Z,{addonBefore:"\u540D\u79F0",value:t.Name||"",onChange:function(C){o(a()(a()({},t),{},{Name:C.target.value}))}}),(0,e.jsx)(q.Z.TextArea,{rows:3,value:t.Description||"",placeholder:"\u8F93\u5165\u5907\u6CE8\u4FE1\u606F",onChange:function(C){o(a()(a()({},t),{},{Description:C.target.value}))}}),(0,e.jsx)("div",{children:(0,e.jsx)(Ze.Z,{model:t||{}})}),(0,e.jsx)(te.Z,{type:"horizontal"})]})}),description:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{children:[h.length,"\u4E2A\u8BA2\u5355\uFF0C",i,"\u4E2A\u5546\u54C1"]}),(0,e.jsxs)("div",{children:["\u603B\u8BA1",(0,v.lb)(l)]}),(0,e.jsxs)("div",{children:["\u6536\u6B3E",(0,v.lb)(d)]}),(0,e.jsxs)("div",{children:["\u5269\u4F59\u5E94\u6536",(0,v.lb)(l-d)]})]})})})},Ae=function(c){var n=c.group,t=c.onChange,o=c.action,h=(n==null?void 0:n.GroupData)||{},s=h.Orders||[];return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(T.Z,{gutter:[10,10],children:[(0,e.jsx)(y.Z,{span:6,children:(0,e.jsxs)(D.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(R.Z,{message:"\u540C\u4E00\u4E2A\u6279\u6B21\u8BA2\u5355\u4E0D\u652F\u6301\u591A\u4EBA\u540C\u65F6\u7F16\u8F91\uFF01",type:"error"}),(0,e.jsx)(re,{children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(D.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(Fe,{group:n||{},onChange:function(u){return t(u||{})}}),o]})})})]})}),(0,e.jsxs)(y.Z,{span:18,children:[(0,e.jsx)(V.Z,{title:"\u53D1\u4EF6\u4EBA",size:"small",bordered:!0,extra:(0,e.jsx)("span",{style:{color:"gray"},children:"\u5982\u679C\u8BA2\u5355\u672A\u6307\u5B9A\u53D1\u4EF6\u4EBA\uFF0C\u5C06\u4F7F\u7528\u6B64\u5904\u914D\u7F6E\u7684\u53D1\u4EF6\u4EBA\u4FE1\u606F"}),style:{border:"3px dashed orange",marginBottom:30},children:(0,e.jsx)(le,{nameLabel:"\u53D1\u4EF6\u4EBA",address:(h==null?void 0:h.SharedSender)||{},onChange:function(u){t(a()(a()({},n),{},{GroupData:a()(a()({},h),{},{SharedSender:u})}))}})}),(0,e.jsx)(ye,{group_data:n.GroupData||{},onChange:function(u){t(a()(a()({},n),{},{GroupData:u}))}}),(0,e.jsx)("div",{style:{padding:10},children:(0,e.jsx)(S.ZP,{type:"primary",block:!0,size:"large",icon:(0,e.jsx)(U.Z,{stroke:1}),onClick:function(){var u={SpecificSender:!1,Sender:{},UserAddress:{},Items:[{Quantity:1,UnitPrice:0}],PaymentBills:[{PaymentChannel:x.$s.Balance}]},l=a()(a()({},h),{},{Orders:[].concat(P()(s),[u])});t(a()(a()({},n),{},{GroupData:l}))},children:"\u6DFB\u52A0\u8BA2\u5355"})})]})]})})},me=r(45360),Pe=r(85418),Se=r(50472),Be=r(98185),be=function(c){var n=c.group,t=c.ok,o=c.onSaved,h=c.onChange,s=c.loadingData,i=(0,I.Z)(A.x1.mallManager.orderGroupSave,{manual:!0,onSuccess:function(g,C){(0,v._y)(g,function(){$.ZP.success({message:"\u4FDD\u5B58\u6210\u529F",description:"\u4F60\u53EF\u4EE5\u7EE7\u7EED\u7F16\u8F91"}),o(),t()})}}),u=(0,I.Z)(A.x1.mallManager.orderGroupExportExcel,{manual:!0,onSuccess:function(g,C){var _=N.ND.utc().add(N.Mg,"hour").format("YYYY-MM-DD-HH-mm-ss"),B=new Blob([g.data]),f=document.createElement("a");f.download="".concat(n.Name||"--",".xlsx"),f.style.display="none",f.href=URL.createObjectURL(B),document.body.appendChild(f),f.click(),URL.revokeObjectURL(f.href),document.body.removeChild(f)}}),l=function(g,C){return(0,v.Te)(g||"zzzzzzzzzzzz").localeCompare((0,v.Te)(C||"zzzzzzzzzzzzzzz"))},m=(0,I.Z)(function(){return new Promise(function(d,g){try{var C,_=((C=n.GroupData)===null||C===void 0?void 0:C.Orders)||[],B=_.sort(function(j,M){var b,H;return l(j==null||(b=j.UserAddress)===null||b===void 0?void 0:b.Name,M==null||(H=M.UserAddress)===null||H===void 0?void 0:H.Name)}),f=a()(a()({},n.GroupData),{},{Orders:B});h(a()(a()({},n),{},{GroupData:f})),setTimeout(function(){return d()},1e3)}catch(j){g(j)}})},{manual:!0});return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(D.Z,{direction:"horizontal",wrap:!0,style:{marginBottom:10},children:[(0,e.jsx)(k.Z,{title:"\u4FDD\u5B58\u81F3\u670D\u52A1\u5668\uFF0C\u5F53\u524D\u7248\u672C\u53F7\uFF1A".concat(n.RowVersion),children:(0,e.jsx)(S.ZP,{type:"primary",loading:i.loading,onClick:function(){if((0,v.Wq)(n.Id)){me.ZP.error("\u6279\u6B21id\u4E0D\u5B58\u5728");return}i.run(n||{})},children:"\u4FDD\u5B58"})}),(0,e.jsx)(k.Z,{title:"\u52A0\u8F7D\u6700\u65B0\u6570\u636E\uFF0C\u672C\u5730\u672A\u4FDD\u5B58\u66F4\u6539\u5C06\u88AB\u8986\u76D6",children:(0,e.jsx)(S.ZP,{loading:s,type:"dashed",danger:!0,icon:(0,e.jsx)(Se.Z,{stroke:1}),onClick:function(){confirm("\u786E\u5B9A\u91CD\u65B0\u52A0\u8F7D\u6570\u636E\uFF1F")&&t()}})}),(0,e.jsx)(k.Z,{title:"\u6309\u7167\u4E70\u5BB6\u59D3\u540D\u6392\u5E8F",children:(0,e.jsx)(S.ZP,{type:"dashed",loading:m.loading,onClick:function(){m.run()},children:"\u6392\u5E8F"})}),(0,e.jsx)(k.Z,{title:"\u590D\u5236\u6570\u636E",children:(0,e.jsx)(Pe.Z.Button,{trigger:["hover"],loading:u.loading,menu:{items:[{key:"export-excel",label:"\u5BFC\u51FA\u8868\u683C",icon:(0,e.jsx)(Be.Z,{stroke:1}),danger:!0,onClick:function(){u.run(n||{},{format:"blob"})}}]},type:"dashed",onClick:function(){navigator.clipboard.writeText(JSON.stringify(n||{})),me.ZP.success("\u590D\u5236\u6210\u529F")},children:"\u590D\u5236"})})]})})},Ie=function(c){var n;E()(c);var t=(0,J.TH)(),o=(n=(0,x.dD)(t.search))===null||n===void 0?void 0:n.id,h=(0,F.useState)(!1),s=p()(h,2),i=s[0],u=s[1],l=(0,z.Z)("order-group",{serializer:function(j){return JSON.stringify(j||{})},deserializer:function(j){return(0,v.Jp)(j)||{}}}),m=p()(l,2),d=m[0],g=m[1],C=(0,I.Z)(A.x1.mallManager.orderGroupGetById,{manual:!0,onSuccess:function(j,M){var b;g(((b=j.data)===null||b===void 0?void 0:b.Data)||{}),u(!1)}}),_=function(){return o&&C.run({Id:o})};(0,F.useEffect)(function(){return _(),function(){window.onbeforeunload=null}},[]),(0,F.useEffect)(function(){i?window.onbeforeunload=function(f){return f.preventDefault(),f.stopPropagation(),"\u6570\u636E\u672A\u4FDD\u5B58\uFF0C\u8BF7\u7559\u610F"}:window.onbeforeunload=null},[i]);var B=(0,v.Wq)(d==null?void 0:d.Id);return C.loading&&B?(0,e.jsx)("h1",{children:"loading..."}):B?(0,e.jsx)("h1",{children:"error model id"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Q.Z.BackTop,{}),(0,e.jsx)(Ae,{group:d||{},onChange:function(j){g(j),u(!0)},action:(0,e.jsxs)(D.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(be,{loadingData:C.loading,group:d||{},onChange:function(j){g(j),u(!0)},onSaved:function(){u(!1)},ok:function(){_()}}),i&&(0,e.jsx)(R.Z,{message:"\u5B58\u5728\u4FEE\u6539\uFF0C\u8BF7\u5C3D\u5FEB\u4FDD\u5B58",type:"error"})]})})]})}}}]);

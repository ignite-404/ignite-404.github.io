(self.webpackChunk=self.webpackChunk||[]).push([[2825],{6786:function(oe,F,c){"use strict";var Y=c(17061),C=c.n(Y),J=c(17156),k=c.n(J),x=c(42122),A=c.n(x),H=c(27424),G=c.n(H),K=c(98163),I=c(45360),L=c(14726),Z=c(78957),O=c(67294),j=c(85134),Q=c(55932),y=c(55793),b=c(42838),u=c(85893);F.Z=function(h){var v=h.data,B=h.ok,m=h.remove,R=h.loadingSave,W=h.width,_=h.defaultImage,ue=h.imageProps,ie=h.uploadButtonProps,S=h.removeButtonProps,le=(0,O.useState)(!1),se=G()(le,2),fe=se[0],$=se[1],T=(0,Q.Kk)(v,{width:W||100}),z=(0,O.useRef)(null),ce=function(){var r=T||_;return(0,b.Wq)(r)?null:(0,u.jsx)(K.Z,A()({src:r||"",alt:"",width:W||50},ue))},de=function(){var e=k()(C()().mark(function r(a){var n;return C()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(a){s.next=2;break}return s.abrupt("return");case 2:if($(!0),s.prev=3,(0,y.Or)(a.name)){s.next=7;break}return I.ZP.error("\u53EA\u652F\u6301 ".concat((0,y.MU)().join("\u3001")," \u683C\u5F0F\u7684\u56FE\u7247")),s.abrupt("return");case 7:return s.next=9,(0,y.yE)(a,j.v.upload.maxSize);case 9:if(a=s.sent,!(a.size>j.v.upload.maxSize)){s.next=13;break}return I.ZP.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC71MB"),s.abrupt("return");case 13:return s.next=15,(0,y.ku)(a);case 15:n=s.sent,n?B&&B(n):I.ZP.error("\u4E0A\u4F20\u5931\u8D25"),s.next=23;break;case 19:s.prev=19,s.t0=s.catch(3),console.log(s.t0),I.ZP.error("\u4E0A\u4F20\u9047\u5230\u9519\u8BEF");case 23:return s.prev=23,$(!1),s.finish(23);case 26:case"end":return s.stop()}},r,null,[[3,19,23,26]])}));return function(a){return e.apply(this,arguments)}}(),t=function(){return(0,b.Wq)(T)||!m?null:(0,u.jsx)(L.ZP,A()(A()({size:"small",type:"dashed",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&m&&m()}},S),{},{children:"\u79FB\u9664\u56FE\u7247"}))};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:{display:"none"},children:(0,u.jsx)("input",{ref:z,type:"file",accept:"image/*",multiple:!1,onChange:function(r){try{r.target.files&&r.target.files.length>0&&de(r.target.files.item(0))}finally{z.current&&(z.current.value="",z.current.files=null)}}})}),(0,u.jsxs)(Z.Z,{direction:"horizontal",children:[ce(),(0,u.jsxs)(Z.Z,{direction:"vertical",children:[(0,u.jsx)(L.ZP,A()(A()({size:"small",loading:fe||R,type:"dashed",onClick:function(){var r;(r=z.current)===null||r===void 0||r.click()}},ie),{},{children:"\u9009\u62E9\u56FE\u7247"})),t()]})]})]})}},55793:function(oe,F,c){"use strict";c.d(F,{MU:function(){return K},Or:function(){return I},jP:function(){return Q},ku:function(){return O},yE:function(){return Z}});var Y=c(17061),C=c.n(Y),J=c(17156),k=c.n(J),x=c(76857),A=c(42838),H=c(98005),G=c.n(H),K=function(){return["jpg","jpeg","png","gif"]},I=function(b){var u,h=((u=(0,A.mD)(b))===null||u===void 0?void 0:u.toLowerCase())||"";return K().indexOf(h)>=0},L=function(b,u,h,v){return new Promise(function(B,m){var R=new(G())(b,{maxHeight:u,maxWidth:h,quality:v,success:function(_){B(_)},error:function(_){m(_)}});console.log(R)})},Z=function(){var y=k()(C()().mark(function b(u,h){var v,B,m,R;return C()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(u.size<=h)){_.next=2;break}return _.abrupt("return",u);case 2:return _.next=4,L(u,void 0,void 0,.9);case 4:if(u=_.sent,!(u.size<=h)){_.next=7;break}return _.abrupt("return",u);case 7:v=5,B=300,m=1e3,R=0;case 11:if(!(++R<=v)){_.next=22;break}return _.next=14,L(u,m,m,1);case 14:if(u=_.sent,!(u.size<=h)){_.next=17;break}return _.abrupt("return",u);case 17:if(m-=B,!(m<=0)){_.next=20;break}return _.abrupt("break",22);case 20:_.next=11;break;case 22:return _.abrupt("return",u);case 23:case"end":return _.stop()}},b)}));return function(u,h){return y.apply(this,arguments)}}(),O=function(){var y=k()(C()().mark(function b(u){var h,v;return C()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,j([u]);case 2:if(h=m.sent,v=h.at(0),v!=null){m.next=6;break}throw new Error("response error");case 6:return m.abrupt("return",v);case 7:case"end":return m.stop()}},b)}));return function(u){return y.apply(this,arguments)}}(),j=function(){var y=k()(C()().mark(function b(u){var h,v;return C()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return h=new FormData,u.forEach(function(R,W){h.append("formFileCollection",R,R.name)}),m.next=4,x.M.post("/api/platform/storage/upload",h);case 4:if(v=m.sent,!v.data.Error){m.next=7;break}throw new Error(v.data.Error.Message||"upload error");case 7:return m.abrupt("return",v.data.Data||[]);case 8:case"end":return m.stop()}},b)}));return function(u){return y.apply(this,arguments)}}(),Q=function(b){return new Promise(function(u,h){var v=new FileReader;v.onload=function(){u(v.result)},v.onerror=function(B){h(B)},v.readAsDataURL(b)})}},98005:function(oe){(function(F,c){oe.exports=c()})(this,function(){"use strict";function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,a)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?F(Object(r),!0).forEach(function(a){k(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,H(a.key),a)}}function J(t,e,r){return e&&C(t.prototype,e),r&&C(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function k(t,e,r){return e=H(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x(){return x=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},x.apply(this,arguments)}function A(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var a=r.call(t,e||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H(t){var e=A(t,"string");return typeof e=="symbol"?e:String(e)}var G={exports:{}};(function(t){typeof window!="undefined"&&function(e){var r=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,a=e.Blob&&function(){try{return!!new Blob}catch(l){return!1}}(),n=a&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch(l){return!1}}(),i=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,s=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,d=(a||i)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(l){var f,g,p,U,E,o,M,D,V;if(f=l.match(s),!f)throw new Error("invalid data URI");for(g=f[2]?f[1]:"text/plain"+(f[3]||";charset=US-ASCII"),p=!!f[4],U=l.slice(f[0].length),p?E=atob(U):E=decodeURIComponent(U),o=new ArrayBuffer(E.length),M=new Uint8Array(o),D=0;D<E.length;D+=1)M[D]=E.charCodeAt(D);return a?new Blob([n?M:o],{type:g}):(V=new i,V.append(o),V.getBlob(g))};e.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(l,f,g){var p=this;setTimeout(function(){g&&r.toDataURL&&d?l(d(p.toDataURL(f,g))):l(p.mozGetAsFile("blob",f))})}:r.toDataURL&&d&&(r.msToBlob?r.toBlob=function(l,f,g){var p=this;setTimeout(function(){(f&&f!=="image/png"||g)&&r.toDataURL&&d?l(d(p.toDataURL(f,g))):l(p.msToBlob(f))})}:r.toBlob=function(l,f,g){var p=this;setTimeout(function(){l(d(p.toDataURL(f,g)))})})),t.exports?t.exports=d:e.dataURLtoBlob=d}(window)})(G);var K=G.exports,I=function(e){return typeof Blob=="undefined"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},L={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},Z=typeof window!="undefined"&&typeof window.document!="undefined",O=Z?window:{},j=function(e){return e>0&&e<1/0},Q=Array.prototype.slice;function y(t){return Array.from?Array.from(t):Q.call(t)}var b=/^image\/.+$/;function u(t){return b.test(t)}function h(t){var e=u(t)?t.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var v=String.fromCharCode;function B(t,e,r){var a="",n;for(r+=e,n=e;n<r;n+=1)a+=v(t.getUint8(n));return a}var m=O.btoa;function R(t,e){for(var r=[],a=8192,n=new Uint8Array(t);n.length>0;)r.push(v.apply(null,y(n.subarray(0,a)))),n=n.subarray(a);return"data:".concat(e,";base64,").concat(m(r.join("")))}function W(t){var e=new DataView(t),r;try{var a,n,i;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var s=e.byteLength,d=2;d+1<s;){if(e.getUint8(d)===255&&e.getUint8(d+1)===225){n=d;break}d+=1}if(n){var l=n+4,f=n+10;if(B(e,l,4)==="Exif"){var g=e.getUint16(f);if(a=g===18761,(a||g===19789)&&e.getUint16(f+2,a)===42){var p=e.getUint32(f+4,a);p>=8&&(i=f+p)}}}if(i){var U=e.getUint16(i,a),E,o;for(o=0;o<U;o+=1)if(E=i+o*12+2,e.getUint16(E,a)===274){E+=8,r=e.getUint16(E,a),e.setUint16(E,1,a);break}}}catch(M){r=1}return r}function _(t){var e=0,r=1,a=1;switch(t){case 2:r=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,r=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:r,scaleY:a}}var ue=/\.\d*(?:0|9){12}\d*$/;function ie(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return ue.test(t)?Math.round(t*e)/e:t}function S(t){var e=t.aspectRatio,r=t.height,a=t.width,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",i=j(a),s=j(r);if(i&&s){var d=r*e;(n==="contain"||n==="none")&&d>a||n==="cover"&&d<a?r=a/e:a=r*e}else i?r=a/e:s&&(a=r*e);return{width:a,height:r}}function le(t){for(var e=y(new Uint8Array(t)),r=e.length,a=[],n=0;n+3<r;){var i=e[n],s=e[n+1];if(i===255&&s===218)break;if(i===255&&s===216)n+=2;else{var d=e[n+2]*256+e[n+3],l=n+d+2,f=e.slice(n,l);a.push(f),n=l}}return a.reduce(function(g,p){return p[0]===255&&p[1]===225?g.concat(p):g},[])}function se(t,e){var r=y(new Uint8Array(t));if(r[2]!==255||r[3]!==224)return t;var a=r[4]*256+r[5],n=[255,216].concat(e,r.slice(4+a));return new Uint8Array(n)}var fe=O.ArrayBuffer,$=O.FileReader,T=O.URL||O.webkitURL,z=/\.\w+$/,ce=O.Compressor,de=function(){function t(e,r){Y(this,t),this.file=e,this.exif=[],this.image=new Image,this.options=c(c({},L),r),this.aborted=!1,this.result=null,this.init()}return J(t,[{key:"init",value:function(){var r=this,a=this.file,n=this.options;if(!I(a)){this.fail(new Error("The first argument must be a File or Blob object."));return}var i=a.type;if(!u(i)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!T||!$){this.fail(new Error("The current browser does not support image compression."));return}fe||(n.checkOrientation=!1,n.retainExif=!1);var s=i==="image/jpeg",d=s&&n.checkOrientation,l=s&&n.retainExif;if(T&&!d&&!l)this.load({url:T.createObjectURL(a)});else{var f=new $;this.reader=f,f.onload=function(g){var p=g.target,U=p.result,E={},o=1;d&&(o=W(U),o>1&&x(E,_(o))),l&&(r.exif=le(U)),d||l?!T||o>1?E.url=R(U,i):E.url=T.createObjectURL(a):E.url=U,r.load(E)},f.onabort=function(){r.fail(new Error("Aborted to read the image with FileReader."))},f.onerror=function(){r.fail(new Error("Failed to read the image with FileReader."))},f.onloadend=function(){r.reader=null},d||l?f.readAsArrayBuffer(a):f.readAsDataURL(a)}}},{key:"load",value:function(r){var a=this,n=this.file,i=this.image;i.onload=function(){a.draw(c(c({},r),{},{naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight}))},i.onabort=function(){a.fail(new Error("Aborted to load the image."))},i.onerror=function(){a.fail(new Error("Failed to load the image."))},O.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(O.navigator.userAgent)&&(i.crossOrigin="anonymous"),i.alt=n.name,i.src=r.url}},{key:"draw",value:function(r){var a=this,n=r.naturalWidth,i=r.naturalHeight,s=r.rotate,d=s===void 0?0:s,l=r.scaleX,f=l===void 0?1:l,g=r.scaleY,p=g===void 0?1:g,U=this.file,E=this.image,o=this.options,M=document.createElement("canvas"),D=M.getContext("2d"),V=Math.abs(d)%180===90,he=(o.resize==="contain"||o.resize==="cover")&&j(o.width)&&j(o.height),q=Math.max(o.maxWidth,0)||1/0,ee=Math.max(o.maxHeight,0)||1/0,re=Math.max(o.minWidth,0)||0,ae=Math.max(o.minHeight,0)||0,X=n/i,P=o.width,w=o.height;if(V){var pe=[ee,q];q=pe[0],ee=pe[1];var be=[ae,re];re=be[0],ae=be[1];var Ee=[w,P];P=Ee[0],w=Ee[1]}he&&(X=P/w);var ye=S({aspectRatio:X,width:q,height:ee},"contain");q=ye.width,ee=ye.height;var De=S({aspectRatio:X,width:re,height:ae},"cover");if(re=De.width,ae=De.height,he){var Pe=S({aspectRatio:X,width:P,height:w},o.resize);P=Pe.width,w=Pe.height}else{var we=S({aspectRatio:X,width:P,height:w}),Oe=we.width;P=Oe===void 0?n:Oe;var Be=we.height;w=Be===void 0?i:Be}P=Math.floor(ie(Math.min(Math.max(P,re),q))),w=Math.floor(ie(Math.min(Math.max(w,ae),ee)));var Le=-P/2,We=-w/2,Fe=P,ke=w,me=[];if(he){var Ue=0,Me=0,_e=n,ve=i,Ce=S({aspectRatio:X,width:n,height:i},{contain:"cover",cover:"contain"}[o.resize]);_e=Ce.width,ve=Ce.height,Ue=(n-_e)/2,Me=(i-ve)/2,me.push(Ue,Me,_e,ve)}if(me.push(Le,We,Fe,ke),V){var Re=[w,P];P=Re[0],w=Re[1]}M.width=P,M.height=w,u(o.mimeType)||(o.mimeType=U.type);var Te="transparent";U.size>o.convertSize&&o.convertTypes.indexOf(o.mimeType)>=0&&(o.mimeType="image/jpeg");var Ae=o.mimeType==="image/jpeg";if(Ae&&(Te="#fff"),D.fillStyle=Te,D.fillRect(0,0,P,w),o.beforeDraw&&o.beforeDraw.call(this,D,M),!this.aborted&&(D.save(),D.translate(P/2,w/2),D.rotate(d*Math.PI/180),D.scale(f,p),D.drawImage.apply(D,[E].concat(me)),D.restore(),o.drew&&o.drew.call(this,D,M),!this.aborted)){var je=function(te){if(!a.aborted){var xe=function(ne){return a.done({naturalWidth:n,naturalHeight:i,result:ne})};if(te&&Ae&&o.retainExif&&a.exif&&a.exif.length>0){var Ie=function(ne){return xe(K(R(se(ne,a.exif),o.mimeType)))};if(te.arrayBuffer)te.arrayBuffer().then(Ie).catch(function(){a.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var N=new $;a.reader=N,N.onload=function(ge){var ne=ge.target;Ie(ne.result)},N.onabort=function(){a.fail(new Error("Aborted to read the compressed image with FileReader."))},N.onerror=function(){a.fail(new Error("Failed to read the compressed image with FileReader."))},N.onloadend=function(){a.reader=null},N.readAsArrayBuffer(te)}}else xe(te)}};M.toBlob?M.toBlob(je,o.mimeType,o.quality):je(K(M.toDataURL(o.mimeType,o.quality)))}}},{key:"done",value:function(r){var a=r.naturalWidth,n=r.naturalHeight,i=r.result,s=this.file,d=this.image,l=this.options;if(T&&d.src.indexOf("blob:")===0&&T.revokeObjectURL(d.src),i)if(l.strict&&!l.retainExif&&i.size>s.size&&l.mimeType===s.type&&!(l.width>a||l.height>n||l.minWidth>a||l.minHeight>n||l.maxWidth<a||l.maxHeight<n))i=s;else{var f=new Date;i.lastModified=f.getTime(),i.lastModifiedDate=f,i.name=s.name,i.name&&i.type!==s.type&&(i.name=i.name.replace(z,h(i.type)))}else i=s;this.result=i,l.success&&l.success.call(this,i)}},{key:"fail",value:function(r){var a=this.options;if(a.error)a.error.call(this,r);else throw r}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=ce,t}},{key:"setDefaults",value:function(r){x(L,r)}}]),t}();return de})}}]);

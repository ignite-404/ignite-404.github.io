"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8698],{70025:function(F,x,t){var R=t(97857),u=t.n(R),O=t(86597),o=t(38787),U=t(94087),E=t(78967),_=t(87740),d=t(96476),j=t(77373),i=t(85893);x.Z=function(m){var h=m.open,y=m.onClose,v=m.children,M=m.title,D=m.action,B=m.pureBody,w=m.showCloseButton,N=m.bodyStyle,W=m.props,T=function(){return B?v:(0,i.jsx)(O.I,{style:N,children:(0,i.jsx)("div",{style:{minHeight:300},children:v})})},l=function(){return w?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{style:{position:"relative"},children:(0,i.jsx)("div",{style:{position:"absolute",display:"inline",right:"20px",top:"20px",zIndex:1},children:(0,i.jsx)(o.A,{isIconOnly:!0,size:"sm",radius:"full",color:"danger",onClick:function(){y&&y()},children:(0,i.jsx)(j.Z,{stroke:1})})})})}):null};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(U.R,u()(u()({className:"overflow-hidden",backdrop:"blur",isOpen:h,onClose:y,hideCloseButton:!0,isDismissable:!0,scrollBehavior:"outside"},W),{},{children:(0,i.jsx)(E.A,{children:function(){return(0,i.jsxs)(i.Fragment,{children:[l(),M==null||(0,i.jsx)(_.k,{className:"flex flex-col gap-1",children:M}),T(),D&&(0,i.jsx)(d.R,{children:D})]})}})}))})}},59716:function(F,x,t){t.r(x),t.d(x,{default:function(){return z}});var R=t(97857),u=t.n(R),O=t(5574),o=t.n(O),U=t(84179),E=t(68421),_=t(67294),d=t(47299),j=t(38295),i=t(30699),m=t(47650),h=t(66419),y=t(69047),v=t(38787),M=t(65885),D=t(80129),B=t.n(D),w=t(70025),N=t(32839),W=t(39278),T=t(39336),l=t(85893);function P(){var e,a=(0,_.useState)(!1),s=o()(a,2),r=s[0],n=s[1],g=(0,M.Z)("usewechatprofile",{serializer:function(f){return f?"1":"0"},deserializer:function(f){return f=="1"}}),b=o()(g,2),K=b[0],p=b[1],I=(0,E.Z)(i.x1.platform.wechatMpAuthGetWechatMpOption,{manual:!0}),L=(e=I.data)===null||e===void 0||(e=e.data)===null||e===void 0||(e=e.Data)===null||e===void 0?void 0:e.AppId,A=(0,h.IS)(),C=function(){var f=(0,h.C6)([window.location.origin,"/store/account/wx-callback"]);console.log(f);var G=B().stringify({appid:L,redirect_uri:f,response_type:"code",scope:"snsapi_userinfo",state:"STATE"},{addQueryPrefix:!1}),$="https://open.weixin.qq.com/connect/oauth2/authorize";$="".concat($,"?").concat(G,"#wechat_redirect"),console.log($),window.location.href=$};return(0,_.useEffect)(function(){A&&I.run({})},[]),!A||!L?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(w.Z,{open:r,onClose:function(){return n(!1)},title:"\u4F7F\u7528\u5FAE\u4FE1\u6388\u6743\u767B\u5F55",action:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(v.A,{onClick:function(){C()},children:"\u786E\u5B9A"})}),children:[(0,l.jsx)("p",{className:"text-sm text-blue-600",children:"\u5373\u5C06\u8DF3\u8F6C\u5230\u5FAE\u4FE1\u6388\u6743\u767B\u5F55\uFF01"}),(0,l.jsx)(N.K,{checked:K,onChange:function(f){p(f.target.checked)},children:"\u4F7F\u7528\u5FAE\u4FE1\u7684\u6635\u79F0\u548C\u5934\u50CF"})]}),(0,l.jsx)("div",{className:"flex flex-row items-end justify-end gap-2 py-3",children:A&&(0,l.jsx)(W.O,{content:"\u63A8\u8350",color:"danger",children:(0,l.jsx)(v.A,{onClick:function(){n(!0)},variant:"solid",startContent:(0,l.jsx)(T.Z,{stroke:1}),color:"success",children:"\u5FAE\u4FE1\u767B\u5F55"})})})]})}var c=t(35291);function z(){var e,a,s;(0,U.Z)("\u767B\u5F55\u8D26\u53F7~");var r=(0,j.o)(),n=(0,m.TH)(),g=((e=(0,c.dD)(n.search))===null||e===void 0?void 0:e.next)||"/",b=(0,_.useState)({}),K=o()(b,2),p=K[0],I=K[1];(0,_.useEffect)(function(){console.log("login page,location:",n,g),localStorage.setItem("login_next",g)},[g]);var L=(0,E.Z)(i.x1.platform.authPasswordLogin,{manual:!0,onSuccess:function(C,S){(0,h._y)(C,function(){var f;(0,h.M8)(((f=C.data.Data)===null||f===void 0?void 0:f.AccessToken)||""),(0,h.cQ)("\u767B\u5F55\u6210\u529F"),setTimeout(function(){console.log(g),window.location.href=g},1e3)})}});return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"container max-w-lg py-8",children:(0,l.jsxs)("div",{className:"flex-col-center w-full gap-2 overflow-hidden rounded-sm bg-white p-5",children:[(0,l.jsxs)("div",{className:"flex-col-center gap-2",children:[(0,l.jsx)("img",{src:d,width:200,alt:"login"}),(0,l.jsx)("h1",{className:"text-lg font-bold text-black",children:"\u767B\u5F55"})]}),(0,l.jsxs)("div",{className:"my-1 flex w-full flex-col gap-4",children:[(0,l.jsx)(y.Y,{required:!0,fullWidth:!0,variant:"bordered",label:"\u8D26\u53F7",value:p.IdentityName||"",onChange:function(C){return I(u()(u()({},p),{},{IdentityName:C.target.value}))},autoFocus:!0}),(0,l.jsx)(y.Y,{required:!0,fullWidth:!0,variant:"bordered",label:"\u5BC6\u7801",type:"password",value:p.Password||"",onChange:function(C){return I(u()(u()({},p),{},{Password:C.target.value}))}})]}),(0,l.jsxs)("div",{className:"p-3 flex w-full flex-col gap-1",children:[(0,l.jsx)(v.A,{isLoading:L.loading,fullWidth:!0,variant:"flat",color:"primary",onClick:function(){if((0,h.Wq)(p.IdentityName)||(0,h.Wq)(p.Password)){(0,h.Ti)("\u8BF7\u8F93\u5165\u5B8C\u6574\u7684\u7528\u6237\u540D\u548C\u5BC6\u7801");return}L.run(u()({},p))},children:"\u767B\u5F55"}),(0,l.jsx)(v.A,{variant:"light",size:"sm",fullWidth:!0,onClick:function(){m.m8.push({pathname:"/"})},children:"\u8FD4\u56DE"}),(0,l.jsx)(P,{})]}),(0,h.Wq)((a=r.mallSettings)===null||a===void 0?void 0:a.LoginNotice)||(0,l.jsx)("div",{className:"text-overline mt-2 uppercase",children:(s=r.mallSettings)===null||s===void 0?void 0:s.LoginNotice})]})})})}},38295:function(F,x,t){t.d(x,{o:function(){return z}});var R=t(15009),u=t.n(R),O=t(99289),o=t.n(O),U=t(19632),E=t.n(U),_=t(47650),d=t(30699),j=t(85134),i=t(66419),m=function(a){var s=c.mallSettings||{},r=[s.StoreNickName,s.StoreEnglishName];a?r=[s.StoreOfficialName,s.StoreOfficialEnglishName].concat(E()(r)):r=[].concat(E()(r),[s.StoreOfficialName,s.StoreOfficialEnglishName]);var n=r.filter(function(g){return!(0,i.Wq)(g)}).at(0);return n||j.v.app.name||j.v.app.english_name},h=function(){var e=o()(u()().mark(function a(){return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.mall.notificationUnReadCount().then(function(n){c.notificationCount=n.data.Data||0});case 2:case"end":return r.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=o()(u()().mark(function a(){var s;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.x1.mallAdmin.gradeListGrades();case 2:s=n.sent,c.grades=s.data.Data||[];case 4:case"end":return n.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),v=function(){var e=o()(u()().mark(function a(){var s;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.x1.mallAdmin.storeQueryStores();case 2:s=n.sent,c.stores=s.data.Data||[];case 4:case"end":return n.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),M=function(){var e=o()(u()().mark(function a(){var s;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.x1.mall.shoppingCartCount();case 2:s=n.sent,c.shoppingCartCount=s.data.Data||0;case 4:case"end":return n.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),D=function(){var e=o()(u()().mark(function a(){var s;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.x1.mall.storeGetCurrentStore();case 2:s=n.sent,c.currentStore=s.data.Data||{};case 4:case"end":return n.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),B=function(){var e=o()(u()().mark(function a(){var s;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.x1.mall.storeMostNearbyStore();case 2:s=n.sent,c.mostNearbyStore=s.data.Data||{};case 4:case"end":return n.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),w=function(){var e=o()(u()().mark(function a(){return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.platform.userAuth().then(function(n){c.userAuthResult=n.data||{}});case 2:case"end":return r.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),N=function(){var e=o()(u()().mark(function a(){return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.sys.adminAuth().then(function(n){c.adminAuthResult=n.data||{}});case 2:case"end":return r.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),W=function(){var e=o()(u()().mark(function a(){return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.sys.manageAdminQueryAdminPermissions().then(function(n){c.adminPermissions=n.data||{}});case 2:case"end":return r.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),T=function(){var e=o()(u()().mark(function a(){return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.mallManager.storeManagerPermissionGetMyPermission().then(function(n){c.managerPermissions=n.data||{}});case 2:case"end":return r.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),l=function(){var e=o()(u()().mark(function a(){return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.mallManager.storeManagerAuth().then(function(n){c.storeManagerAuthResult=n.data||{}});case 2:case"end":return r.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),P=function(){var e=o()(u()().mark(function a(){return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.mall.userStoreUserAuth().then(function(n){c.storeUserAuthResult=n.data||{}});case 2:case"end":return r.stop()}},a)}));return function(){return e.apply(this,arguments)}}(),c=(0,_.sj)({queryUserAuthResult:w,getAppName:m,queryAdminAuthResult:N,queryStoreManagerAuthResult:l,queryStoreUserAuthResult:P,queryAdminPermission:W,queryStoreManagerPermission:T,queryGrades:y,queryStores:v,queryNotificationCount:h,queryShoppingCartCount:M,queryCurrentStore:D,queryMostNearbyStore:B,messageHistory:[],grades:[],stores:[],notificationCount:0,headerHeight:0,bottomHeight:0,mallSettings:{},shoppingCartCount:0,currentStore:void 0,mostNearbyStore:void 0,userAuthResult:void 0,adminAuthResult:void 0,adminPermissions:void 0,storeUserAuthResult:void 0,storeManagerAuthResult:void 0,managerPermissions:void 0,get user(){var e;return(e=this.userAuthResult)===null||e===void 0?void 0:e.User},get admin(){var e;return(e=this.adminAuthResult)===null||e===void 0?void 0:e.Admin},get storeUser(){var e;return(e=this.storeUserAuthResult)===null||e===void 0?void 0:e.StoreUser},get storeManager(){var e;return(e=this.storeManagerAuthResult)===null||e===void 0?void 0:e.StoreManager}}),z=function(){return(0,_.ey)(c)}},47299:function(F,x,t){F.exports=t.p+"static/illustration_login.cfd572d9.png"}}]);

"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[363],{63087:function(I,_,s){s.r(_),s.d(_,{default:function(){return B}});var j=s(82052),u=s(67294),C=s(38295),c=s(35291),p=s(47650),f=s(66419),A=s(39278),d=s(93522),S=s(29505),E=s(17546),P=s(79923),R=s(87399),U=s(17226),D=s(15009),M=s.n(D),b=s(99289),N=s.n(b),O=s(85137),i=s(85893),w=["/x-not-found"];function T(){var m=(0,C.o)(),o=(0,p.TH)(),g=w.some(function(a){return(0,f.C7)(o.pathname,a)}),t=function(){var a=N()(M()().mark(function e(){return M()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(g){l.next=2;break}return l.abrupt("return");case 2:if((0,c.lE)(m.storeUser)){l.next=5;break}return m.shoppingCartCount=0,l.abrupt("return");case 5:return l.next=7,m.queryShoppingCartCount();case 7:case"end":return l.stop()}},e)}));return function(){return a.apply(this,arguments)}}();u.useEffect(function(){t()},[m.storeUser,o.pathname]);var n=m.shoppingCartCount||0;return n<=0||!g?null:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(O.Z,{badge:n>0?{dot:!0}:void 0,icon:(0,i.jsx)(R.Z,{stroke:1,color:"inherit"}),onClick:function(){p.m8.push({pathname:"/shoppingcart"})}})})}function B(){var m,o,g=(0,p.pC)(),t=(0,p.TH)(),n=(0,C.o)(),a=(0,u.useRef)(null),e=(0,j.Z)(a);(0,u.useEffect)(function(){(0,c.lE)(n.storeUser)&&n.queryNotificationCount()},[t.pathname]),(0,u.useEffect)(function(){n.bottomHeight=(e==null?void 0:e.height)||0},[e]);var r=(0,f.zO)((0,f.gB)([(m=n.mallSettings)===null||m===void 0?void 0:m.StoreNickName,"\u9996\u9875"])||"",3),l=[{path:"/",name:r,icon:(0,i.jsx)(E.Z,{stroke:1})},{path:"/category",name:"\u5546\u54C1",icon:(0,i.jsx)(P.Z,{stroke:1})},{path:"/shoppingcart",name:"\u8D2D\u7269\u888B",icon:(0,i.jsx)(R.Z,{stroke:1}),showBadge:(n.shoppingCartCount||0)>0,badgeContent:n.shoppingCartCount},{path:"/ucenter",name:"\u6211\u7684",icon:(0,i.jsx)(U.Z,{stroke:1}),showBadge:(n.notificationCount||0)>0,badgeContent:n.notificationCount}],$=l.find(function(v){return v.path==t.pathname||(0,f.C7)(v.path,t.pathname)}),L=function(h){return(0,i.jsx)(A.O,{shape:"circle",color:"danger",isInvisible:!h.showBadge,content:h.badgeContent,children:(0,i.jsxs)("div",{className:"flex flex-row items-center justify-center gap-1",children:[h.icon||null,(0,i.jsx)("span",{className:"text-sm",children:h.name})]})})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(T,{}),(0,i.jsx)("div",{style:{paddingBottom:"".concat(n.bottomHeight+15,"px")},children:g}),(0,i.jsx)("div",{ref:a,style:{position:"fixed",bottom:0,left:0,right:0,zIndex:1e3},children:(0,i.jsx)("div",{className:"container max-w-lg p-1",children:(0,i.jsx)(d.n,{fullWidth:!0,destroyInactiveTabPanel:!0,isVertical:!1,defaultSelectedKey:((o=l.at(0))===null||o===void 0?void 0:o.path)||void 0,selectedKey:($==null?void 0:$.path)||void 0,color:"primary",radius:"sm",variant:"solid",size:"lg",items:l,onSelectionChange:function(h){console.log("tab change",h);var y=l.find(function(x){return x.path==h||(0,f.C7)(x.path,h==null?void 0:h.toString())});y&&(y.path&&p.m8.push({pathname:y.path}),y.action&&y.action())},children:l.map(function(v,h){return(0,i.jsx)(S.r,{title:L(v)},v.path)})})})})]})}},38295:function(I,_,s){s.d(_,{o:function(){return g}});var j=s(15009),u=s.n(j),C=s(99289),c=s.n(C),p=s(19632),f=s.n(p),A=s(47650),d=s(30699),S=s(85134),E=s(66419),P=function(n){var a=o.mallSettings||{},e=[a.StoreNickName,a.StoreEnglishName];n?e=[a.StoreOfficialName,a.StoreOfficialEnglishName].concat(f()(e)):e=[].concat(f()(e),[a.StoreOfficialName,a.StoreOfficialEnglishName]);var r=e.filter(function(l){return!(0,E.Wq)(l)}).at(0);return r||S.v.app.name||S.v.app.englishName},R=function(){var t=c()(u()().mark(function n(){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.x1.mall.notificationUnReadCount().then(function(r){o.notificationCount=r.data.Data||0});case 2:case"end":return e.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),U=function(){var t=c()(u()().mark(function n(){var a;return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.mallAdmin.gradeListGrades();case 2:a=r.sent,o.grades=a.data.Data||[];case 4:case"end":return r.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),D=function(){var t=c()(u()().mark(function n(){var a;return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.mallAdmin.storeQueryStores();case 2:a=r.sent,o.stores=a.data.Data||[];case 4:case"end":return r.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),M=function(){var t=c()(u()().mark(function n(){var a;return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.mall.shoppingCartCount();case 2:a=r.sent,o.shoppingCartCount=a.data.Data||0;case 4:case"end":return r.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),b=function(){var t=c()(u()().mark(function n(){var a;return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.mall.storeGetCurrentStore();case 2:a=r.sent,o.currentStore=a.data.Data||{};case 4:case"end":return r.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),N=function(){var t=c()(u()().mark(function n(){var a;return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.x1.mall.storeMostNearbyStore();case 2:a=r.sent,o.mostNearbyStore=a.data.Data||{};case 4:case"end":return r.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),O=function(){var t=c()(u()().mark(function n(){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.x1.platform.userAuth().then(function(r){o.userAuthResult=r.data||{}});case 2:case"end":return e.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),i=function(){var t=c()(u()().mark(function n(){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.x1.sys.adminAuth().then(function(r){o.adminAuthResult=r.data||{}});case 2:case"end":return e.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),w=function(){var t=c()(u()().mark(function n(){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.x1.sys.manageAdminQueryAdminPermissions().then(function(r){o.adminPermissions=r.data||{}});case 2:case"end":return e.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),T=function(){var t=c()(u()().mark(function n(){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.x1.mallManager.storeManagerPermissionGetMyPermission().then(function(r){o.managerPermissions=r.data||{}});case 2:case"end":return e.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),B=function(){var t=c()(u()().mark(function n(){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.x1.mallManager.storeManagerAuth().then(function(r){o.storeManagerAuthResult=r.data||{}});case 2:case"end":return e.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),m=function(){var t=c()(u()().mark(function n(){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.x1.mall.userStoreUserAuth().then(function(r){o.storeUserAuthResult=r.data||{}});case 2:case"end":return e.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),o=(0,A.sj)({queryUserAuthResult:O,getAppName:P,queryAdminAuthResult:i,queryStoreManagerAuthResult:B,queryStoreUserAuthResult:m,queryAdminPermission:w,queryStoreManagerPermission:T,queryGrades:U,queryStores:D,queryNotificationCount:R,queryShoppingCartCount:M,queryCurrentStore:b,queryMostNearbyStore:N,messageHistory:[],grades:[],stores:[],notificationCount:0,headerHeight:0,bottomHeight:0,mallSettings:{},shoppingCartCount:0,currentStore:void 0,mostNearbyStore:void 0,userAuthResult:void 0,adminAuthResult:void 0,adminPermissions:void 0,storeUserAuthResult:void 0,storeManagerAuthResult:void 0,managerPermissions:void 0,get user(){var t;return(t=this.userAuthResult)===null||t===void 0?void 0:t.User},get admin(){var t;return(t=this.adminAuthResult)===null||t===void 0?void 0:t.Admin},get storeUser(){var t;return(t=this.storeUserAuthResult)===null||t===void 0?void 0:t.StoreUser},get storeManager(){var t;return(t=this.storeManagerAuthResult)===null||t===void 0?void 0:t.StoreManager}}),g=function(){return(0,A.ey)(o)}}}]);

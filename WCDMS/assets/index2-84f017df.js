import{d as oe,X as ne,a7 as O,a as S,E as A,am as ie,I as v,an as de,ao as pe,M as re,U as ve,b as ce,o as u,c as i,i as k,t as x,N as m,r as V,p as c,F as W,O as X,e as T,w as g,h as _,ah as E,ap as I,f as Y,aj as me,P as fe,a1 as Q,V as ye,Y as ge,Q as be,A as he,W as Ce}from"./index-0f1dbffa.js";const ke=Symbol("layui-tree-select"),xe=()=>Ce(ke,{}),Ve={key:0,class:"layui-tag-input-prepend"},$e={key:1},we={class:"layui-tag-input-inner"},ze={class:"layui-tag-input-collapsed-panel"},Ne=["disabled","placeholder","readonly"],Be={key:1,class:"layui-tag-input-inner-disabled-input"},Se={key:2,class:"layui-tag-input-clear"},Te={key:3,class:"layui-tag-input-suffix"},_e={key:4,class:"layui-tag-input-append"},Ee=oe({name:"LayTagInput",__name:"index",props:{modelValue:{},inputValue:{},disabled:{type:Boolean},placeholder:{default:void 0},readonly:{type:Boolean},allowClear:{type:Boolean},max:{},minCollapsedNum:{default:0},collapseTagsTooltip:{type:Boolean},size:{default:"md"},tagProps:{},disabledInput:{type:Boolean}},emits:["change","update:modelValue","update:inputValue","inputValueChange","pressEnter","remove","clear","focus","blur"],setup(U,{expose:Z,emit:q}){const s=U,t=q,D=ne(),b=O(void 0),d=O(void 0),M=S(""),$=S(""),h=S(!1),P=A({width:"15px"}),G=A(s.tagProps??{}),w=ie(G,"closable","size","disabled"),o=v({get:()=>s.inputValue,set(e){t("update:inputValue",e),t("inputValueChange",e)}}),l=v({get:()=>s.modelValue,set(e){t("update:modelValue",e),t("change",e)}}),p=v(()=>ue(l.value??[])),C=v(()=>{var e;if(p.value)return s.minCollapsedNum?(e=p.value)==null?void 0:e.slice(0,s.minCollapsedNum):p.value}),H=v(()=>{var e,a;if(p.value)return s.minCollapsedNum&&((e=p.value)==null?void 0:e.length)>s.minCollapsedNum?(a=p.value)==null?void 0:a.slice(s.minCollapsedNum):[]}),F=function(e){h.value||(o.value=e.target.value)},z=e=>{e.type==="compositionend"?(h.value=!1,$.value="",F(e)):(h.value=!0,$.value=o.value+(e.data??""))},J=e=>{var a;e.preventDefault();const r=o.value?String(o.value).trim():"";!r||!l.value||(s.max&&((a=l.value)==null?void 0:a.length)>=s.max||(l.value=l.value instanceof Array?l.value.concat(String(r)):[r],o.value=""),t("pressEnter",o.value,e))},ee=e=>{if(e.code==="Backspace"&&l.value&&l.value.length){if(!M.value){const a=p.value.length-1;N(p.value[a].value,a,e)}M.value=o.value??""}},K=e=>{var a;t("focus",e),(a=d.value)==null||a.focus()},R=e=>{var a;t("blur",e),(a=d.value)==null||a.blur()},ae=e=>{!s.disabled&&s.allowClear&&(l.value=[],t("clear",e))},N=(e,a,r)=>{if(!l.value)return;const f=[...l.value];f.splice(a,1),l.value=f,t("remove",e,r)},le=e=>{d.value&&(e.preventDefault(),d.value.focus())},j=()=>{var e;b.value&&(e=b.value.offsetWidth,P.width=e>15?`${e}px`:"15px")},se=v(()=>["layui-tag-input",`layui-tag-input-${s.size}`,{"layui-tag-input-disabled":s.disabled}]),ue=e=>e.map(a=>de(a)?a:{value:a,label:String(a),closable:!0});pe(b,()=>{j()}),re(()=>o.value,e=>{d.value&&!h.value&&ve(()=>{d.value.value=e??""})});const te=v(()=>l.value&&C.value?l.value.length-C.value.length:"");return ce(()=>{var e;j();const a=xe();(e=a==null?void 0:a.setInputEl)==null||e.call(a,d.value)}),Z({focus:K,blur:R}),(e,a)=>{var r,f,L;return u(),i("div",{class:be(se.value),onMousedown:le},[k("span",{ref_key:"mirrorRefEl",ref:b,class:"layui-tag-input-mirror"},x($.value||o.value||e.placeholder),513),m(D).prepend?(u(),i("div",Ve,[V(e.$slots,"prepend")])):c("",!0),e.$slots.prefix?(u(),i("span",$e,[V(e.$slots,"prefix")])):c("",!0),k("span",we,[(u(!0),i(W,null,X(C.value,(n,y)=>(u(),T(I,E({key:`${n}-${y}`},m(w),{closable:!e.disabled&&n.closable,size:e.size,onClose:B=>N(n.value,y,B)}),{default:g(()=>[_(x(n.label),1)]),_:2},1040,["closable","size","onClose"]))),128)),((r=C.value)==null?void 0:r.length)!=((f=l.value)==null?void 0:f.length)?(u(),T(me,{key:0,isDark:!1,trigger:"hover",popperStyle:"padding:6px",disabled:!e.collapseTagsTooltip},{content:g(()=>[k("div",ze,[(u(!0),i(W,null,X(H.value,(n,y)=>(u(),T(I,E({key:`${n}-${y}`},m(w),{closable:!e.disabled&&n.closable,size:e.size,onClose:B=>N(n.value,y+(e.minCollapsedNum??0),B)}),{default:g(()=>[_(x(n.label),1)]),_:2},1040,["closable","size","onClose"]))),128))])]),default:g(()=>[Y(I,E(m(w),{key:"more",closable:!1,size:e.size}),{default:g(()=>[_(" +"+x(te.value)+"... ",1)]),_:1},16,["size"])]),_:1},8,["disabled"])):c("",!0),k("input",{ref_key:"inputRefEl",ref:d,class:"layui-tag-input-inner-input",style:fe(P),disabled:e.disabled||e.disabledInput,placeholder:e.placeholder,readonly:e.readonly,onKeydown:Q(J,["enter"]),onKeyup:Q(ee,["delete"]),onInput:F,onFocus:K,onBlur:R,onCompositionstart:z,onCompositionupdate:z,onCompositionend:z},null,44,Ne),e.disabledInput?(u(),i("div",Be)):c("",!0)]),e.allowClear&&(L=l.value)!=null&&L.length&&!e.disabled?(u(),i("span",Se,[Y(m(ge),{type:"layui-icon-close-fill",onClick:ye(ae,["stop"])})])):c("",!0),e.$slots.suffix?(u(),i("span",Te,[V(e.$slots,"suffix")])):c("",!0),m(D).append?(u(),i("div",_e,[V(e.$slots,"append")])):c("",!0)],34)}}});he(Ee);export{Ee as T,xe as x};

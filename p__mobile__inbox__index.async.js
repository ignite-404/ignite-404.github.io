"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5900],{96911:function(L,E,e){var i=e(32983),t=e(85893);E.Z=function(){return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",paddingTop:100},children:(0,t.jsx)(i.Z,{})})})}},64080:function(L,E,e){var i=e(21274),t=e(85893);E.Z=function(D){var d=D.loading,R=D.hasMore;return d?(0,t.jsx)(i.Z,{}):R?null:(0,t.jsx)("div",{className:"flex flex-row items-center justify-center gap-2",children:(0,t.jsx)("span",{className:"text-slate-400",children:"\u6CA1\u6709\u66F4\u591A\u4E86"})})}},85685:function(L,E,e){e.d(E,{Z:function(){return U}});var i=e(38295),t=e(47650),D=e(66419),d=e(38787),R=e(48135),m=e(85893);function U(u){var o=u.children,f=u.rightButtons,h=u.leftButtons,A=(0,i.o)(),_=function(){window.history.length>1?t.m8.back():t.m8.push({pathname:"/"})},v=function(){return(0,m.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,D.G5)(h)&&(0,m.jsxs)("div",{className:"flex-row-center cursor-pointer gap-1",onClick:function(O){O.preventDefault(),O.stopPropagation(),_()},children:[(0,m.jsx)(d.A,{size:"lg",color:"default",radius:"full",variant:"light",isIconOnly:!0,onClick:function(O){O.preventDefault(),O.stopPropagation(),_()},children:(0,m.jsx)(R.Z,{stroke:1})}),(0,m.jsx)("h1",{className:"text-title m-0 p-0",children:window.document.title||A.getAppName()})]}),h==null?void 0:h.map(function(g){return g})]})};return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"container max-w-lg",children:[(0,m.jsxs)("div",{className:"flex-row-between py-1",children:[v(),(0,m.jsx)("div",{className:"flex-row-center gap-2",children:f==null?void 0:f.map(function(c){return c})})]}),(0,m.jsx)("div",{children:o})]})})}},70566:function(L,E,e){e.r(E),e.d(E,{default:function(){return s}});var i=e(19632),t=e.n(i),D=e(15009),d=e.n(D),R=e(97857),m=e.n(R),U=e(99289),u=e.n(U),o=e(5574),f=e.n(o),h=e(68770),A=e(7134),_=e(74911),v=e(35195),c=e(67294),g=e(96911),O=e(64080),T=e(85685),w=e(30699),b=e(46629),N=e(66419),Z=e(38787),G=e(79818),M=e(35301),H=e(18266),a=e(54666),n=e(85893),l=function(j){var B=(0,_.Z)(j,function(I){var y;return((y=(0,b.mg)(I.CreationTime))===null||y===void 0||(y=y.add(b.Mg,"hour"))===null||y===void 0?void 0:y.format(b.vc))||"--"}),S=(0,v.Z)(Object.keys(B),function(I){var y;return((y=(0,b.mg)(I))===null||y===void 0?void 0:y.valueOf())||0});return S.map(function(I){return{key:I,items:B[I]||[]}})};function s(){var r=(0,c.useState)({Page:1}),j=f()(r,2),B=j[0],S=j[1],I=(0,c.useState)(!1),y=f()(I,2),Y=y[0],k=y[1],re=(0,c.useState)(void 0),V=f()(re,2),q=V[0],ee=V[1],F=(0,h.Z)(function(){var Q=u()(d()().mark(function C(p){var W,z;return d()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,w.x1.mall.notificationPaging(m()(m()({},B),{},{Page:((p==null||(W=p.res)===null||W===void 0?void 0:W.PageIndex)||0)+1}));case 2:return z=J.sent,J.abrupt("return",{list:z.data.Items||[],res:z.data});case 4:case"end":return J.stop()}},C)}));return function(C){return Q.apply(this,arguments)}}(),{target:window.document,isNoMore:function(C){var p;return(C==null||(p=C.res)===null||p===void 0?void 0:p.IsEmpty)||!1},reloadDeps:[B]}),X=F.data,P=F.loading,x=F.loadingMore,K=F.noMore,$=F.mutate,ne=function(C){C.Read||(ee(C.Id),w.x1.mall.notificationUpdateStatus({Id:C.Id,Read:!0}).then(function(p){(0,N._y)(p,function(){var W=[].concat(t()(te.filter(function(z){return z.Id!=C.Id})),[m()(m()({},C),{},{Read:!0})]);$(m()(m()({},X),{},{list:W}))})}).finally(function(){ee(void 0)}))};(0,c.useEffect)(function(){$(void 0)},[B]);var te=(X==null?void 0:X.list)||[],ae=function(){return(0,n.jsx)(Z.A,{isLoading:Y,variant:"light",onClick:function(){confirm("\u6E05\u7A7A\u6240\u6709\u6D88\u606F\uFF1F")&&(k(!0),w.x1.mall.notificationDeleteAll({}).then(function(p){(0,N._y)(p,function(){var W=m()(m()({},B),{},{Page:1});S(W)})}).finally(function(){k(!1)}))},children:"\u6E05\u7A7A"})},se=l(te);return(0,N.G5)(se)?(0,n.jsx)(g.Z,{}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(T.Z,{children:(0,n.jsxs)("div",{className:"container max-w-lg",children:[(0,n.jsx)("div",{className:"mb-1 flex flex-row items-center justify-end",children:ae()}),(0,n.jsx)(G.X,{variant:"light",disabledKeys:q?[q]:void 0,children:se.map(function(Q,C){return(0,n.jsx)(M.y,{title:Q.key,showDivider:!0,children:Q.items.map(function(p,W){return(0,n.jsxs)(H.R,{startContent:(0,n.jsx)(A.C,{icon:(0,n.jsx)(a.Z,{stroke:1}),style:{backgroundColor:"green"}}),description:p.Content,endContent:(0,b.Gl)(p.CreationTime),onClick:function(){ne(p)},children:[p.Read&&(0,n.jsx)("span",{children:p.Title}),p.Read||(0,n.jsx)("b",{children:p.Title})]},p.Id||W)})},C)})}),(0,n.jsx)(O.Z,{loading:P||x,hasMore:!K})]})})})}},38295:function(L,E,e){e.d(E,{o:function(){return H}});var i=e(15009),t=e.n(i),D=e(99289),d=e.n(D),R=e(19632),m=e.n(R),U=e(47650),u=e(30699),o=e(85134),f=e(66419),h=function(n){var l=M.mallSettings||{},s=[l.StoreNickName,l.StoreEnglishName];n?s=[l.StoreOfficialName,l.StoreOfficialEnglishName].concat(m()(s)):s=[].concat(m()(s),[l.StoreOfficialName,l.StoreOfficialEnglishName]);var r=s.filter(function(j){return!(0,f.Wq)(j)}).at(0);return r||o.v.app.name||o.v.app.englishName},A=function(){var a=d()(t()().mark(function n(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.x1.mall.notificationUnReadCount().then(function(r){M.notificationCount=r.data.Data||0});case 2:case"end":return s.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),_=function(){var a=d()(t()().mark(function n(){var l;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.x1.mallAdmin.gradeListGrades();case 2:l=r.sent,M.grades=l.data.Data||[];case 4:case"end":return r.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),v=function(){var a=d()(t()().mark(function n(){var l;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.x1.mallAdmin.storeQueryStores();case 2:l=r.sent,M.stores=l.data.Data||[];case 4:case"end":return r.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),c=function(){var a=d()(t()().mark(function n(){var l;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.x1.mall.shoppingCartCount();case 2:l=r.sent,M.shoppingCartCount=l.data.Data||0;case 4:case"end":return r.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),g=function(){var a=d()(t()().mark(function n(){var l;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.x1.mall.storeGetCurrentStore();case 2:l=r.sent,M.currentStore=l.data.Data||{};case 4:case"end":return r.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),O=function(){var a=d()(t()().mark(function n(){var l;return t()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.x1.mall.storeMostNearbyStore();case 2:l=r.sent,M.mostNearbyStore=l.data.Data||{};case 4:case"end":return r.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),T=function(){var a=d()(t()().mark(function n(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.x1.platform.userAuth().then(function(r){M.userAuthResult=r.data||{}});case 2:case"end":return s.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),w=function(){var a=d()(t()().mark(function n(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.x1.sys.adminAuth().then(function(r){M.adminAuthResult=r.data||{}});case 2:case"end":return s.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),b=function(){var a=d()(t()().mark(function n(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.x1.sys.manageAdminQueryAdminPermissions().then(function(r){M.adminPermissions=r.data||{}});case 2:case"end":return s.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),N=function(){var a=d()(t()().mark(function n(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.x1.mallManager.storeManagerPermissionGetMyPermission().then(function(r){M.managerPermissions=r.data||{}});case 2:case"end":return s.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),Z=function(){var a=d()(t()().mark(function n(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.x1.mallManager.storeManagerAuth().then(function(r){M.storeManagerAuthResult=r.data||{}});case 2:case"end":return s.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),G=function(){var a=d()(t()().mark(function n(){return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.x1.mall.userStoreUserAuth().then(function(r){M.storeUserAuthResult=r.data||{}});case 2:case"end":return s.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),M=(0,U.sj)({queryUserAuthResult:T,getAppName:h,queryAdminAuthResult:w,queryStoreManagerAuthResult:Z,queryStoreUserAuthResult:G,queryAdminPermission:b,queryStoreManagerPermission:N,queryGrades:_,queryStores:v,queryNotificationCount:A,queryShoppingCartCount:c,queryCurrentStore:g,queryMostNearbyStore:O,messageHistory:[],grades:[],stores:[],notificationCount:0,headerHeight:0,bottomHeight:0,mallSettings:{},shoppingCartCount:0,currentStore:void 0,mostNearbyStore:void 0,userAuthResult:void 0,adminAuthResult:void 0,adminPermissions:void 0,storeUserAuthResult:void 0,storeManagerAuthResult:void 0,managerPermissions:void 0,get user(){var a;return(a=this.userAuthResult)===null||a===void 0?void 0:a.User},get admin(){var a;return(a=this.adminAuthResult)===null||a===void 0?void 0:a.Admin},get storeUser(){var a;return(a=this.storeUserAuthResult)===null||a===void 0?void 0:a.StoreUser},get storeManager(){var a;return(a=this.storeManagerAuthResult)===null||a===void 0?void 0:a.StoreManager}}),H=function(){return(0,U.ey)(M)}},68770:function(L,E,e){e.d(E,{Z:function(){return A}});var i=e(97582),t=e(67294),D=e(83204),d=e(22638),R=e(68421),m=e(77598),U=e(48002),u=function(_){return _===document||_===document.documentElement||_===document.body?Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop):_.scrollTop},o=function(_){return _.scrollHeight||Math.max(document.documentElement.scrollHeight,document.body.scrollHeight)},f=function(_){return _.clientHeight||Math.max(document.documentElement.clientHeight,document.body.clientHeight)},h=function(_,v){v===void 0&&(v={});var c=v.target,g=v.isNoMore,O=v.threshold,T=O===void 0?100:O,w=v.reloadDeps,b=w===void 0?[]:w,N=v.manual,Z=v.onBefore,G=v.onSuccess,M=v.onError,H=v.onFinally,a=(0,i.CR)((0,t.useState)(),2),n=a[0],l=a[1],s=(0,i.CR)((0,t.useState)(!1),2),r=s[0],j=s[1],B=(0,t.useMemo)(function(){return g?g(n):!1},[n]),S=(0,R.Z)(function(P){return(0,i.mG)(void 0,void 0,void 0,function(){var x,K,$;return(0,i.Jh)(this,function(ne){switch(ne.label){case 0:return[4,_(P)];case 1:return x=ne.sent(),l(P?(0,i.pi)((0,i.pi)({},x),{list:(0,i.ev)((0,i.ev)([],(0,i.CR)(($=P.list)!==null&&$!==void 0?$:[]),!1),(0,i.CR)(x.list),!1)}):(0,i.pi)((0,i.pi)({},x),{list:(0,i.ev)([],(0,i.CR)((K=x.list)!==null&&K!==void 0?K:[]),!1)})),[2,x]}})})},{manual:N,onFinally:function(P,x,K){j(!1),H==null||H(x,K)},onBefore:function(){return Z==null?void 0:Z()},onSuccess:function(P){setTimeout(function(){X()}),G==null||G(P)},onError:function(P){return M==null?void 0:M(P)}}),I=S.loading,y=S.error,Y=S.run,k=S.runAsync,re=S.cancel,V=(0,d.Z)(function(){B||(j(!0),Y(n))}),q=(0,d.Z)(function(){return B?Promise.reject():(j(!0),k(n))}),ee=function(){return j(!1),Y()},F=function(){return j(!1),k()},X=function(){var P=(0,U.n)(c);if(P){P=P===document?document.documentElement:P;var x=u(P),K=o(P),$=f(P);K-x<=$+T&&V()}};return(0,D.Z)("scroll",function(){I||r||X()},{target:c}),(0,m.Z)(function(){Y()},(0,i.ev)([],(0,i.CR)(b),!1)),{data:n,loading:!r&&I,error:y,loadingMore:r,noMore:B,loadMore:V,loadMoreAsync:q,reload:(0,d.Z)(ee),reloadAsync:(0,d.Z)(F),mutate:l,cancel:re}},A=h},57838:function(L,E,e){e.d(E,{Z:function(){return t}});var i=e(67294);function t(){const[,D]=i.useReducer(d=>d+1,0);return D}},74443:function(L,E,e){e.d(E,{ZP:function(){return m},c4:function(){return D},m9:function(){return U}});var i=e(67294),t=e(29691);const D=["xxl","xl","lg","md","sm","xs"],d=u=>({xs:`(max-width: ${u.screenXSMax}px)`,sm:`(min-width: ${u.screenSM}px)`,md:`(min-width: ${u.screenMD}px)`,lg:`(min-width: ${u.screenLG}px)`,xl:`(min-width: ${u.screenXL}px)`,xxl:`(min-width: ${u.screenXXL}px)`}),R=u=>{const o=u,f=[].concat(D).reverse();return f.forEach((h,A)=>{const _=h.toUpperCase(),v=`screen${_}Min`,c=`screen${_}`;if(!(o[v]<=o[c]))throw new Error(`${v}<=${c} fails : !(${o[v]}<=${o[c]})`);if(A<f.length-1){const g=`screen${_}Max`;if(!(o[c]<=o[g]))throw new Error(`${c}<=${g} fails : !(${o[c]}<=${o[g]})`);const T=`screen${f[A+1].toUpperCase()}Min`;if(!(o[g]<=o[T]))throw new Error(`${g}<=${T} fails : !(${o[g]}<=${o[T]})`)}}),u};function m(){const[,u]=(0,t.ZP)(),o=d(R(u));return i.useMemo(()=>{const f=new Map;let h=-1,A={};return{matchHandlers:{},dispatch(_){return A=_,f.forEach(v=>v(A)),f.size>=1},subscribe(_){return f.size||this.register(),h+=1,f.set(h,_),_(A),h},unsubscribe(_){f.delete(_),f.size||this.unregister()},unregister(){Object.keys(o).forEach(_=>{const v=o[_],c=this.matchHandlers[v];c==null||c.mql.removeListener(c==null?void 0:c.listener)}),f.clear()},register(){Object.keys(o).forEach(_=>{const v=o[_],c=O=>{let{matches:T}=O;this.dispatch(Object.assign(Object.assign({},A),{[_]:T}))},g=window.matchMedia(v);g.addListener(c),this.matchHandlers[v]={mql:g,listener:c},c(g)})},responsiveMap:o}},[u])}const U=(u,o)=>{if(o&&typeof o=="object")for(let f=0;f<D.length;f++){const h=D[f];if(u[h]&&o[h]!==void 0)return o[h]}}},25378:function(L,E,e){var i=e(67294),t=e(8410),D=e(57838),d=e(74443);function R(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const U=(0,i.useRef)({}),u=(0,D.Z)(),o=(0,d.ZP)();return(0,t.Z)(()=>{const f=o.subscribe(h=>{U.current=h,m&&u()});return()=>o.unsubscribe(f)},[]),U.current}E.Z=R},54666:function(L,E,e){e.d(E,{Z:function(){return t}});var i=e(33733);var t=(0,i.Z)("outline","message","IconMessage",[["path",{d:"M8 9h8",key:"svg-0"}],["path",{d:"M8 13h6",key:"svg-1"}],["path",{d:"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z",key:"svg-2"}]])}}]);

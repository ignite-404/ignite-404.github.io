"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[181],{74590:function(ne,O,e){var I=e(17061),r=e.n(I),H=e(17156),f=e.n(H),w=e(27424),U=e.n(w),j=e(83062),g=e(14726),Z=e(67294),_=e(85893);O.Z=function(D){var B=D.action,K=D.confirmText,R=D.hide,J=(0,Z.useState)(!1),A=U()(J,2),y=A[0],P=A[1],S=K||"\u786E\u5B9A\u5220\u9664\uFF1F",C=function(){var F=f()(r()().mark(function V(){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(confirm(S)){c.next=2;break}return c.abrupt("return");case 2:return P(!0),c.prev=3,c.next=6,B();case 6:return c.prev=6,P(!1),c.finish(6);case 9:case"end":return c.stop()}},V,null,[[3,,6,9]])}));return function(){return F.apply(this,arguments)}}();return R?null:(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(j.Z,{title:S,children:(0,_.jsx)(g.ZP,{loading:y,danger:!0,type:"link",onClick:function(){C()},children:"\u5220\u9664"})})})}},48746:function(ne,O,e){var I=e(17061),r=e.n(I),H=e(17156),f=e.n(H),w=e(96256),U=e(68994),j=e(30967),g=e(42838),Z=e(85893);O.Z=function(_){var D=_.selectedSku,B=_.onChange,K=_.style,R=_.props,J=function(){var A=f()(r()().mark(function y(P){var S,C,F;return r()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(0,g.Wq)(P)){h.next=2;break}return h.abrupt("return",[]);case 2:return h.next=4,j.x1.mallAdmin.skuQuerySkuForSelection({Keywords:P,Take:20});case 4:return C=h.sent,F=C==null||(S=C.data)===null||S===void 0||(S=S.Data)===null||S===void 0?void 0:S.map(function(c){return{label:(0,U.CQ)(c)||"--",value:c.Id||"--"}}),h.abrupt("return",F||[]);case 7:case"end":return h.stop()}},y)}));return function(P){return A.apply(this,arguments)}}();return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(w.Z,{style:K,props:R,onSearch:function(){var A=f()(r()().mark(function y(P){return r()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,J(P);case 2:return C.abrupt("return",C.sent);case 3:case"end":return C.stop()}},y)}));return function(y){return A.apply(this,arguments)}}(),placeholder:"\u641C\u7D22\u5546\u54C1...",value:(D==null?void 0:D.Id)||void 0,initItem:D==null?void 0:{label:(0,U.CQ)(D)||"",value:D.Id||""},onChange:function(y){B&&B(y==null?void 0:{Id:y.value,Name:y.label})}})})}},19189:function(ne,O,e){e.r(O),e.d(O,{default:function(){return fe}});var I=e(42122),r=e.n(I),H=e(27424),f=e.n(H),w=e(66309),U=e(40411),j=e(14726),g=e(4393),Z=e(80799),_=e(67294),D=e(23806),B=e(1288),K=e(30967),R=e(42838),J=e(17061),A=e.n(J),y=e(17156),P=e.n(y),S=e(45360),C=e(85576),F=e(78957),V=e(57381),h=e(11346),c=e(25278),re=e(24435),u=e(72269),l=e(84567),m=e(96864),t=e(74590),a=e(861),ee=e.n(a),se=e(68994),ie=e(66628),oe=e(48746),n=e(85893),de=function(L){var M=L.sku_list,W=L.onChange,G=L.maxCount,X=(0,_.useState)(!1),k=f()(X,2),N=k[0],$=k[1],Y=G||1e5,Q=M.length>=Y,z=[{title:"No",dataIndex:"index",valueType:"indexBorder"},{title:"\u6392\u5E8F",dataIndex:"sort",width:60,className:"drag-visible"},{title:"\u5546\u54C1",render:function(T,p){return(0,se.CQ)(p)||"--"}},{title:"\u63CF\u8FF0",render:function(T,p){return p.Description||"--"}},{render:function(T,p){return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(j.ZP,{type:"link",danger:!0,onClick:function(){confirm("\u5220\u9664\uFF1F")&&W(ee()(M.filter(function(v){return v.Id!=p.Id})))},children:"\u5220\u9664"})})}}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.Z,{title:"\u641C\u7D22\u5546\u54C1",open:N,onCancel:function(){return $(!1)},onOk:function(){return $(!1)},children:(0,n.jsx)(oe.Z,{onChange:function(T){if(T){if(Q){var p;(p=R.iI.message)===null||p===void 0||p.error("\u6570\u91CF\u5DF2\u8FBE\u4E0A\u9650\uFF1A".concat(Y));return}if(confirm("\u6DFB\u52A0".concat((0,se.CQ)(T)||"--","\uFF1F"))){if(M.some(function(v){return v.Id==T.Id})){var i;(i=R.iI.message)===null||i===void 0||i.error("\u8BE5\u5546\u54C1\u5DF2\u5B58\u5728");return}W([].concat(ee()(M),[T])),$(!1)}}}})}),(0,n.jsx)(g.Z,{size:"small",title:"\u9009\u62E9\u5546\u54C1",extra:(0,n.jsx)(j.ZP,{disabled:Q,type:"link",size:"small",onClick:function(){$(!0)},children:"\u6DFB\u52A0\u5546\u54C1"}),children:(0,n.jsx)(ie.Z,{rowKey:"Id",columns:z,dataSource:M||[],toolBarRender:!1,pagination:!1,headerTitle:!1,search:!1,dragSortKey:"sort",onDragSortEnd:function(T,p,i){W(ee()(i))}})})]})},ce=e(38295),b=e(46629),me=function(L){var M,W,G,X=L.show,k=L.hide,N=L.data,$=L.ok,Y=(0,_.useState)(!1),Q=f()(Y,2),z=Q[0],x=Q[1],T=(0,_.useState)({}),p=f()(T,2),i=p[0],v=p[1],q=(0,ce.o)(),ae=function(s){x(!0),K.x1.mallAdmin.discountSave(r()({},s)).then(function(d){d.data.Error?S.ZP.error(d.data.Error.Message):(S.ZP.success("\u4FDD\u5B58\u6210\u529F"),$())}).finally(function(){x(!1)})};return(0,_.useEffect)(function(){v(r()({},N||{}))},[N]),(0,_.useEffect)(function(){X&&q.queryStores()},[X]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(C.Z,{width:"60%",title:"\u6298\u6263",open:X,onCancel:function(){return k()},footer:(0,n.jsxs)(F.Z,{children:[(0,n.jsx)(t.Z,{action:P()(A()().mark(function o(){var s;return A()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,K.x1.mallAdmin.discountDelete({Id:N.Id});case 2:s=E.sent,(0,R._y)(s,function(){k(),$()});case 4:case"end":return E.stop()}},o)})),hide:(0,R.Wq)(N.Id)}),(0,n.jsx)(j.ZP,{type:"primary",onClick:function(){ae(i)},children:"\u4FDD\u5B58"})]}),children:(0,n.jsx)(V.Z,{spinning:z,children:(0,n.jsxs)(h.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,n.jsx)(h.Z.Item,{label:"\u540D\u79F0",tooltip:"61\u513F\u7AE5\u8282",children:(0,n.jsx)(c.Z,{maxLength:30,required:!0,value:i.Name||"",onChange:function(s){v(r()(r()({},i),{},{Name:s.target.value}))}})}),(0,n.jsx)(h.Z.Item,{label:"\u63CF\u8FF0",children:(0,n.jsx)(c.Z.TextArea,{maxLength:30,required:!0,value:i.Description||"",onChange:function(s){v(r()(r()({},i),{},{Description:s.target.value}))}})}),(0,n.jsx)(h.Z.Item,{label:"\u6298\u6263",children:(0,n.jsx)(re.Z,{min:0,max:1,required:!0,value:i.DiscountPercentage||0,onChange:function(s){v(r()(r()({},i),{},{DiscountPercentage:s||0}))}})}),(0,n.jsx)(h.Z.Item,{label:"\u6307\u5B9A\u95E8\u5E97\u53EF\u7528",children:(0,n.jsxs)(F.Z,{direction:"horizontal",children:[(0,n.jsx)(u.Z,{checked:i.LimitedToStore,onChange:function(s){v(r()(r()({},i),{},{LimitedToStore:s}))}}),i.LimitedToStore||(0,n.jsx)("b",{children:"\u5F53\u524D\u6240\u6709\u95E8\u5E97\u53EF\u7528"})]})}),i.LimitedToStore&&(0,n.jsx)(h.Z.Item,{label:"\u9002\u7528\u95E8\u5E97",children:(0,n.jsx)(l.Z.Group,{onChange:function(s){v(r()(r()({},i),{},{Stores:q.stores.filter(function(d){return s.indexOf(d.Id||"")>=0})}))},value:((M=i.Stores)===null||M===void 0?void 0:M.map(function(o){return o.Id||""}))||[],options:q.stores.map(function(o){return{label:o.Name,value:o.Id||""}})})}),(0,n.jsx)(h.Z.Item,{label:"\u7279\u5B9A\u5546\u54C1",children:(0,n.jsx)(u.Z,{checked:i.LimitedToSku,onChange:function(s){v(r()(r()({},i),{},{LimitedToSku:s}))}})}),i.LimitedToSku&&(0,n.jsx)(h.Z.Item,{label:"\u53C2\u4E0E\u5546\u54C1",children:(0,n.jsx)(de,{sku_list:i.Skus||[],onChange:function(s){v(r()(r()({},i),{},{Skus:s||[]}))}})}),(0,n.jsx)(h.Z.Item,{label:"\u65F6\u95F4\u8303\u56F4",children:(0,n.jsx)(m.default.RangePicker,{allowClear:!0,value:[((W=(0,b.mg)(i.StartTime))===null||W===void 0?void 0:W.add(b.Mg,"hour"))||null,((G=(0,b.mg)(i.EndTime))===null||G===void 0?void 0:G.add(b.Mg,"hour"))||null],onChange:function(s){var d,E;v(r()(r()({},i),{},{StartTime:s==null||(d=s.at(0))===null||d===void 0?void 0:d.add(-b.Mg,"hours").format(b.dq),EndTime:s==null||(E=s.at(1))===null||E===void 0?void 0:E.add(-b.Mg,"hours").format(b.dq)}))}})}),(0,n.jsx)(h.Z.Item,{label:"\u72B6\u6001\u53EF\u7528",children:(0,n.jsx)(u.Z,{checked:i.IsActive,onChange:function(s){v(r()(r()({},i),{},{IsActive:s}))}})}),(0,n.jsx)(h.Z.Item,{label:"\u6392\u5E8F",children:(0,n.jsx)(re.Z,{value:i.Sort||0,onChange:function(s){v(r()(r()({},i),{},{Sort:s||0}))}})})]})})})})},fe=function(){var L=(0,_.useState)(!0),M=f()(L,2),W=M[0],G=M[1],X=(0,_.useState)({Items:[],TotalCount:0}),k=f()(X,2),N=k[0],$=k[1],Y=(0,_.useState)({Page:1}),Q=f()(Y,2),z=Q[0],x=Q[1],T=(0,_.useState)(void 0),p=f()(T,2),i=p[0],v=p[1],q=function(){G(!0),K.x1.mallAdmin.discountQueryPaging(r()({},z)).then(function(s){$(s.data||{})}).finally(function(){G(!1)})},ae=[{title:"\u540D\u79F0",render:function(s,d){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("b",{children:d.Name||"--"}),(0,R.Wq)(d.Description)||(0,n.jsx)("p",{children:d.Description})]})}},{title:"\u4F18\u60E0\u529B\u5EA6",render:function(s,d){return d.DiscountPercentage||0}},{title:"\u9002\u7528\u95E8\u5E97",render:function(s,d){var E;return d.LimitedToStore?(0,n.jsx)("span",{children:"".concat((E=d.Stores)===null||E===void 0?void 0:E.map(function(te){return te.Name||""}).join(","))}):(0,n.jsx)(w.Z,{color:"green",children:"\u5168\u90E8\u95E8\u5E97"})}},{title:"\u9002\u7528\u5546\u54C1",render:function(s,d){var E;return d.LimitedToSku?d.Skus?(E=d.Skus)===null||E===void 0?void 0:E.map(function(te,le){var ue;return(0,n.jsx)("div",{style:{marginBottom:5},children:"".concat(le+1,"-").concat((ue=te.Goods)===null||ue===void 0?void 0:ue.Name,"-").concat(te.Name)},le)}):null:(0,n.jsx)(w.Z,{color:"green",children:"\u5168\u5C40\u6709\u6548"})}},{title:"\u72B6\u6001",render:function(s,d){return d.IsActive?(0,n.jsx)(U.Z,{text:"\u53EF\u7528",status:"success"}):(0,n.jsx)(U.Z,{text:"\u4E0D\u53EF\u7528",status:"error"})}},{title:"\u65F6\u95F4\u8303\u56F4",render:function(s,d){return(0,n.jsxs)(n.Fragment,{children:[d.StartTime&&(0,n.jsxs)("div",{children:["\u5F00\u59CB\u65F6\u95F4\uFF1A",(0,n.jsx)(B.Z,{timeStr:d.StartTime})]}),d.EndTime&&(0,n.jsxs)("div",{children:["\u7ED3\u675F\u65F6\u95F4\uFF1A",(0,n.jsx)(B.Z,{timeStr:d.EndTime})]})]})}},{title:"\u65F6\u95F4",render:function(s,d){return(0,n.jsx)(D.Z,{model:d})}},{title:"\u64CD\u4F5C",width:200,render:function(s,d){return(0,n.jsx)(j.ZP.Group,{children:(0,n.jsx)(j.ZP,{type:"link",onClick:function(){v(d)},children:"\u7F16\u8F91"})})}}];return(0,_.useEffect)(function(){q()},[z]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(me,{show:i!=null,hide:function(){return v(void 0)},data:i||{},ok:function(){v(void 0),q()}}),(0,n.jsx)(g.Z,{title:"\u6298\u6263",extra:(0,n.jsx)(j.ZP,{type:"primary",onClick:function(){v({})},children:"\u65B0\u589E"}),children:(0,n.jsx)(Z.Z,{rowKey:function(s){return s.Id||""},loading:W,columns:ae,dataSource:N.Items||[],pagination:{showSizeChanger:!1,pageSize:20,current:z.Page,total:N.TotalCount,onChange:function(s){x(r()(r()({},z),{},{Page:s}))}}})})]})}},38295:function(ne,O,e){e.d(O,{o:function(){return re}});var I=e(17061),r=e.n(I),H=e(17156),f=e.n(H),w=e(861),U=e.n(w),j=e(47650),g=e(30967),Z=e(85134),_=e(42838),D=function(l){var m=c.mallSettings||{},t=[m.StoreNickName,m.StoreEnglishName];l?t=[m.StoreOfficialName,m.StoreOfficialEnglishName].concat(U()(t)):t=[].concat(U()(t),[m.StoreOfficialName,m.StoreOfficialEnglishName]);var a=t.filter(function(ee){return!(0,_.Wq)(ee)}).at(0);return a||Z.v.app.name||Z.v.app.englishName},B=function(){var u=f()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.mall.notificationUnReadCount().then(function(a){c.notificationCount=a.data.Data||0});case 2:case"end":return t.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),K=function(){var u=f()(r()().mark(function l(){var m;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g.x1.mallAdmin.gradeListGrades();case 2:m=a.sent,c.grades=m.data.Data||[];case 4:case"end":return a.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),R=function(){var u=f()(r()().mark(function l(){var m;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g.x1.mallAdmin.storeQueryStores();case 2:m=a.sent,c.stores=m.data.Data||[];case 4:case"end":return a.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),J=function(){var u=f()(r()().mark(function l(){var m;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g.x1.mall.shoppingCartCount();case 2:m=a.sent,c.shoppingCartCount=m.data.Data||0;case 4:case"end":return a.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),A=function(){var u=f()(r()().mark(function l(){var m;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g.x1.mall.storeGetCurrentStore();case 2:m=a.sent,c.currentStore=m.data.Data||{};case 4:case"end":return a.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),y=function(){var u=f()(r()().mark(function l(){var m;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g.x1.mall.storeMostNearbyStore();case 2:m=a.sent,c.mostNearbyStore=m.data.Data||{};case 4:case"end":return a.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),P=function(){var u=f()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.platform.userAuth().then(function(a){c.userAuthResult=a.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),S=function(){var u=f()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.sys.adminAuth().then(function(a){c.adminAuthResult=a.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),C=function(){var u=f()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.sys.manageAdminQueryAdminPermissions().then(function(a){c.adminPermissions=a.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),F=function(){var u=f()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.mallManager.storeManagerPermissionGetMyPermission().then(function(a){c.managerPermissions=a.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),V=function(){var u=f()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.mallManager.storeManagerAuth().then(function(a){c.storeManagerAuthResult=a.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),h=function(){var u=f()(r()().mark(function l(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.x1.mall.userStoreUserAuth().then(function(a){c.storeUserAuthResult=a.data||{}});case 2:case"end":return t.stop()}},l)}));return function(){return u.apply(this,arguments)}}(),c=(0,j.sj)({queryUserAuthResult:P,getAppName:D,queryAdminAuthResult:S,queryStoreManagerAuthResult:V,queryStoreUserAuthResult:h,queryAdminPermission:C,queryStoreManagerPermission:F,queryGrades:K,queryStores:R,queryNotificationCount:B,queryShoppingCartCount:J,queryCurrentStore:A,queryMostNearbyStore:y,messageHistory:[],grades:[],stores:[],notificationCount:0,headerHeight:0,bottomHeight:0,mallSettings:{},shoppingCartCount:0,currentStore:void 0,mostNearbyStore:void 0,userAuthResult:void 0,adminAuthResult:void 0,adminPermissions:void 0,storeUserAuthResult:void 0,storeManagerAuthResult:void 0,managerPermissions:void 0,get user(){var u;return(u=this.userAuthResult)===null||u===void 0?void 0:u.User},get admin(){var u;return(u=this.adminAuthResult)===null||u===void 0?void 0:u.Admin},get storeUser(){var u;return(u=this.storeUserAuthResult)===null||u===void 0?void 0:u.StoreUser},get storeManager(){var u;return(u=this.storeManagerAuthResult)===null||u===void 0?void 0:u.StoreManager}}),re=function(){return(0,j.ey)(c)}},935:function(ne,O){function e(I){var r=I==null?0:I.length;return r?I[r-1]:void 0}O.Z=e}}]);

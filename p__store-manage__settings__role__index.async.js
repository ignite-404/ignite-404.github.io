"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3685],{53045:function(_,L,e){e.r(L),e.d(L,{default:function(){return q}});var O=e(27424),d=e.n(O),k=e(23806),E=e(30967),F=e(14726),V=e(4393),W=e(80799),r=e(67294),$=e(17061),T=e.n($),H=e(17156),J=e.n(H),Q=e(42122),Z=e.n(Q),z=e(45360),A=e(85576),B=e(78957),U=e(57381),I=e(11346),G=e(25278),X=e(74590),M=e(42838),n=e(85893),Y=function(f){var c=f.show,g=f.hide,x=f.data,S=f.ok,P=(0,r.useState)(!1),v=d()(P,2),R=v[0],j=v[1],D=(0,r.useState)({}),y=d()(D,2),u=y[0],m=y[1],C=function(t){j(!0),E.x1.mallManager.storeManagerPermissionSaveRole(Z()({},t)).then(function(h){(0,M._y)(h,function(){z.ZP.success("\u4FDD\u5B58\u6210\u529F"),S()})}).finally(function(){j(!1)})};return(0,r.useEffect)(function(){m(Z()({},x))},[x]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(A.Z,{title:"\u89D2\u8272",open:c,onCancel:function(){return g()},footer:(0,n.jsxs)(B.Z,{children:[(0,n.jsx)(X.Z,{action:J()(T()().mark(function i(){var t;return T()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,E.x1.sys.manageRoleDelete({Id:u.Id});case 2:t=s.sent,(0,M._y)(t,function(){g(),S()});case 4:case"end":return s.stop()}},i)})),hide:(0,M.Wq)(u.Id)}),(0,n.jsx)(F.ZP,{type:"primary",onClick:function(){C(u)},children:"\u4FDD\u5B58"})]}),children:(0,n.jsx)(U.Z,{spinning:R,children:(0,n.jsxs)(I.Z,{labelCol:{flex:"110px"},labelAlign:"right",wrapperCol:{flex:1},children:[(0,n.jsx)(I.Z.Item,{label:"\u540D\u79F0",rules:[{required:!0},{max:10}],children:(0,n.jsx)(G.Z,{value:u.Name||"",onChange:function(t){m(Z()(Z()({},u),{},{Name:t.target.value}))}})}),(0,n.jsx)(I.Z.Item,{label:"\u63CF\u8FF0",rules:[{max:50}],children:(0,n.jsx)(G.Z,{value:u.Description||"",onChange:function(t){m(Z()(Z()({},u),{},{Description:t.target.value}))}})})]})})})})},N=e(35291),p=e(66309),b=e(56774),w=function(f){var c=f.model,g=f.ok,x=(0,r.useState)(!1),S=d()(x,2),P=S[0],v=S[1],R=(0,r.useState)(!1),j=d()(R,2),D=j[0],y=j[1],u=(0,r.useState)([]),m=d()(u,2),C=m[0],i=m[1];(0,r.useEffect)(function(){i(c.PermissionKeys||[])},[c]);var t=function(a){y(!0),E.x1.mallManager.storeManagerPermissionSetRolePermissions({Key:c.Id,Value:a||[]}).then(function(o){(0,M._y)(o,function(){z.ZP.success("\u4FDD\u5B58\u6210\u529F"),v(!1),g&&g()})}).finally(function(){y(!1)})},h=function(){var a=c.PermissionKeys||[],o=N.zM.filter(function(l){return a.indexOf(l.key)>=0});return(0,n.jsx)("div",{children:o.map(function(l,K){return(0,n.jsx)(p.Z,{style:{marginRight:5,marginBottom:5},children:l.name},K)})})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{children:[(0,n.jsxs)(B.Z,{direction:"horizontal",children:[h(),(0,n.jsx)(F.ZP,{type:"link",onClick:function(){v(!0)},children:"\u4FEE\u6539"})]}),(0,n.jsx)(A.Z,{title:"\u7ED1\u5B9A\u6743\u9650",confirmLoading:D,open:P,onCancel:function(){v(!1)},onOk:function(){t(C)},children:(0,n.jsx)(b.Z,{selectedKeys:C,onChange:function(a){return i(a)},permissions:N.al})})]})})},q=function(){var f=(0,r.useState)(!0),c=d()(f,2),g=c[0],x=c[1],S=(0,r.useState)([]),P=d()(S,2),v=P[0],R=P[1],j=(0,r.useState)({Page:1}),D=d()(j,2),y=D[0],u=D[1],m=(0,r.useState)(void 0),C=d()(m,2),i=C[0],t=C[1],h=function(){x(!0),E.x1.mallManager.storeManagerPermissionListRoles({}).then(function(o){(0,M._y)(o,function(){R(o.data.Data||[])})}).finally(function(){x(!1)})},s=[{title:"\u540D\u79F0",render:function(o,l){return l.Name}},{title:"\u63CF\u8FF0",render:function(o,l){return l.Description||"--"}},{title:"\u6743\u9650",render:function(o,l){return(0,n.jsx)(w,{model:l,ok:function(){h()}})}},{title:"\u65F6\u95F4",render:function(o){return(0,n.jsx)(k.Z,{model:o})}},{title:"\u64CD\u4F5C",width:200,render:function(o,l){return(0,n.jsx)(F.ZP.Group,{children:(0,n.jsx)(F.ZP,{type:"link",onClick:function(){t(l)},children:"\u7F16\u8F91"})})}}];return(0,r.useEffect)(function(){h()},[y]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Y,{show:i!=null,hide:function(){return t(void 0)},data:i||{},ok:function(){t(void 0),h()}}),(0,n.jsx)(V.Z,{title:"\u89D2\u8272",extra:(0,n.jsx)(F.ZP,{type:"primary",onClick:function(){t({})},children:"\u65B0\u589E"}),children:(0,n.jsx)(W.Z,{loading:g,columns:s,dataSource:v,pagination:!1})})]})}}}]);
